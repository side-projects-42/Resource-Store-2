#!/bin/bash
# Disable normal grub 2 cfg files
chmod -x $imagedir/etc/grub.d/*

# Install the 40_custom file, which generates a nice menu.lst
script='40_custom'
cp "$taskdir/files/$script" "$imagedir/etc/grub.d/$script"
chmod 755 "$imagedir/etc/grub.d/$script"

sed -i "s/^GRUB_TIMEOUT=1/GRUB_TIMEOUT=0\nGRUB_HIDDEN_TIMEOUT=true/" $imagedir/etc/default/grub

# Update grub.cfg using the script
chroot $imagedir update-grub

# Alias grub.cfg as menu.lst
chroot $imagedir ln -s /boot/grub/grub.cfg /boot/grub/menu.lst

chroot $imagedir ln -s . /boot/boot
