<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Mock Functions</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Mock Functions</h1>
</header>
<p>Mock functions are also known as “spies”, because they let you spy on the behavior of a function that is called indirectly by some other code, rather than just testing the output. You can create a mock function with <code>jest.fn()</code>. If no implementation is given, the mock function will return <code>undefined</code> when invoked.</p>
<h2 id="methods">Methods</h2>
<p><AUTOGENERATED_TABLE_OF_CONTENTS></p>
<hr />
<h2 id="reference">Reference</h2>
<h3 id="mockfn.getmockname"><code>mockFn.getMockName()</code></h3>
<p>Returns the mock name string set by calling <code>mockFn.mockName(value)</code>.</p>
<h3 id="mockfn.mock.calls"><code>mockFn.mock.calls</code></h3>
<p>An array containing the call arguments of all calls that have been made to this mock function. Each item in the array is an array of arguments that were passed during the call.</p>
<p>For example: A mock function <code>f</code> that has been called twice, with the arguments <code>f('arg1', 'arg2')</code>, and then with the arguments <code>f('arg3', 'arg4')</code>, would have a <code>mock.calls</code> array that looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1">[</a>
<a class="sourceLine" id="cb1-2" title="2">  [<span class="st">&#39;arg1&#39;</span><span class="op">,</span> <span class="st">&#39;arg2&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb1-3" title="3">  [<span class="st">&#39;arg3&#39;</span><span class="op">,</span> <span class="st">&#39;arg4&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4">]<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mock.results"><code>mockFn.mock.results</code></h3>
<p>An array containing the results of all calls that have been made to this mock function. Each entry in this array is an object containing a <code>type</code> property, and a <code>value</code> property. <code>type</code> will be one of the following:</p>
<ul>
<li><code>'return'</code> - Indicates that the call completed by returning normally.</li>
<li><code>'throw'</code> - Indicates that the call completed by throwing a value.</li>
<li><code>'incomplete'</code> - Indicates that the call has not yet completed. This occurs if you test the result from within the mock function itself, or from within a function that was called by the mock.</li>
</ul>
<p>The <code>value</code> property contains the value that was thrown or returned. <code>value</code> is undefined when <code>type === 'incomplete'</code>.</p>
<p>For example: A mock function <code>f</code> that has been called three times, returning <code>'result1'</code>, throwing an error, and then returning <code>'result2'</code>, would have a <code>mock.results</code> array that looks like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1">[</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;return&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="dt">value</span><span class="op">:</span> <span class="st">&#39;result1&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="op">{</span></a>
<a class="sourceLine" id="cb2-7" title="7">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;throw&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="dt">value</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-9" title="9">      <span class="co">/* Error instance */</span></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="op">},</span></a>
<a class="sourceLine" id="cb2-11" title="11">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="op">{</span></a>
<a class="sourceLine" id="cb2-13" title="13">    <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;return&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-14" title="14">    <span class="dt">value</span><span class="op">:</span> <span class="st">&#39;result2&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-15" title="15">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-16" title="16">]<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mock.instances"><code>mockFn.mock.instances</code></h3>
<p>An array that contains all the object instances that have been instantiated from this mock function using <code>new</code>.</p>
<p>For example: A mock function that has been instantiated twice would have the following <code>mock.instances</code> array:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> mockFn <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">const</span> a <span class="op">=</span> <span class="kw">new</span> <span class="at">mockFn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">const</span> b <span class="op">=</span> <span class="kw">new</span> <span class="at">mockFn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="va">mockFn</span>.<span class="va">mock</span>.<span class="at">instances</span>[<span class="dv">0</span>] <span class="op">===</span> a<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="va">mockFn</span>.<span class="va">mock</span>.<span class="at">instances</span>[<span class="dv">1</span>] <span class="op">===</span> b<span class="op">;</span> <span class="co">// true</span></a></code></pre></div>
<h3 id="mockfn.mockclear"><code>mockFn.mockClear()</code></h3>
<p>Resets all information stored in the <a href="#mockfn-mock-calls"><code>mockFn.mock.calls</code></a> and <a href="#mockfn-mock-instances"><code>mockFn.mock.instances</code></a> arrays.</p>
<p>Often this is useful when you want to clean up a mock’s usage data between two assertions.</p>
<p>Beware that <code>mockClear</code> will replace <code>mockFn.mock</code>, not just <a href="#mockfn-mock-calls"><code>mockFn.mock.calls</code></a> and <a href="#mockfn-mock-instances"><code>mockFn.mock.instances</code></a>. You should therefore avoid assigning <code>mockFn.mock</code> to other variables, temporary or not, to make sure you don’t access stale data.</p>
<p>The <a href="configuration.html#clearmocks-boolean"><code>clearMocks</code></a> configuration option is available to clear mocks automatically between tests.</p>
<h3 id="mockfn.mockreset"><code>mockFn.mockReset()</code></h3>
<p>Does everything that <a href="#mockfnmockclear"><code>mockFn.mockClear()</code></a> does, and also removes any mocked return values or implementations.</p>
<p>This is useful when you want to completely reset a <em>mock</em> back to its initial state. (Note that resetting a <em>spy</em> will result in a function with no return value).</p>
<p>Beware that <code>mockReset</code> will replace <code>mockFn.mock</code>, not just <a href="#mockfn-mock-calls"><code>mockFn.mock.calls</code></a> and <a href="#mockfn-mock-instances"><code>mockFn.mock.instances</code></a>. You should therefore avoid assigning <code>mockFn.mock</code> to other variables, temporary or not, to make sure you don’t access stale data.</p>
<h3 id="mockfn.mockrestore"><code>mockFn.mockRestore()</code></h3>
<p>Does everything that <a href="#mockfnmockreset"><code>mockFn.mockReset()</code></a> does, and also restores the original (non-mocked) implementation.</p>
<p>This is useful when you want to mock functions in certain test cases and restore the original implementation in others.</p>
<p>Beware that <code>mockFn.mockRestore</code> only works when mock was created with <code>jest.spyOn</code>. Thus you have to take care of restoration yourself when manually assigning <code>jest.fn()</code>.</p>
<p>The <a href="configuration.html#restoremocks-boolean"><code>restoreMocks</code></a> configuration option is available to restore mocks automatically between tests.</p>
<h3 id="mockfn.mockimplementationfn"><code>mockFn.mockImplementation(fn)</code></h3>
<p>Accepts a function that should be used as the implementation of the mock. The mock itself will still record all calls that go into and instances that come from itself – the only difference is that the implementation will also be executed when the mock is called.</p>
<p><em>Note: <code>jest.fn(implementation)</code> is a shorthand for <code>jest.fn().mockImplementation(implementation)</code>.</em></p>
<p>For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> mockFn <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockImplementation</span>((scalar) <span class="kw">=&gt;</span> <span class="dv">42</span> <span class="op">+</span> scalar)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">// or: jest.fn(scalar =&gt; 42 + scalar);</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">const</span> a <span class="op">=</span> <span class="at">mockFn</span>(<span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw">const</span> b <span class="op">=</span> <span class="at">mockFn</span>(<span class="dv">1</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7">a <span class="op">===</span> <span class="dv">42</span><span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb4-8" title="8">b <span class="op">===</span> <span class="dv">43</span><span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="va">mockFn</span>.<span class="va">mock</span>.<span class="at">calls</span>[<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">===</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="va">mockFn</span>.<span class="va">mock</span>.<span class="at">calls</span>[<span class="dv">1</span>][<span class="dv">0</span>] <span class="op">===</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// true</span></a></code></pre></div>
<p><code>mockImplementation</code> can also be used to mock class constructors:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="co">// SomeClass.js</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="kw">class</span> SomeClass <span class="op">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="at">m</span>(a<span class="op">,</span> b) <span class="op">{}</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">// OtherModule.test.js</span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="va">jest</span>.<span class="at">mock</span>(<span class="st">&#39;./SomeClass&#39;</span>)<span class="op">;</span> <span class="co">// this happens automatically with automocking</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="kw">const</span> SomeClass <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./SomeClass&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9"><span class="kw">const</span> mMock <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="va">SomeClass</span>.<span class="at">mockImplementation</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-11" title="11">  <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-12" title="12">    <span class="dt">m</span><span class="op">:</span> mMock<span class="op">,</span></a>
<a class="sourceLine" id="cb5-13" title="13">  <span class="op">};</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-15" title="15"></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="kw">const</span> some <span class="op">=</span> <span class="kw">new</span> <span class="at">SomeClass</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="va">some</span>.<span class="at">m</span>(<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Calls to m: &#39;</span><span class="op">,</span> <span class="va">mMock</span>.<span class="va">mock</span>.<span class="at">calls</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockimplementationoncefn"><code>mockFn.mockImplementationOnce(fn)</code></h3>
<p>Accepts a function that will be used as an implementation of the mock for one call to the mocked function. Can be chained so that multiple function calls produce different results.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> myMockFn <span class="op">=</span> jest</a>
<a class="sourceLine" id="cb6-2" title="2">  .<span class="at">fn</span>()</a>
<a class="sourceLine" id="cb6-3" title="3">  .<span class="at">mockImplementationOnce</span>((cb) <span class="kw">=&gt;</span> <span class="at">cb</span>(<span class="kw">null</span><span class="op">,</span> <span class="kw">true</span>))</a>
<a class="sourceLine" id="cb6-4" title="4">  .<span class="at">mockImplementationOnce</span>((cb) <span class="kw">=&gt;</span> <span class="at">cb</span>(<span class="kw">null</span><span class="op">,</span> <span class="kw">false</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="at">myMockFn</span>((err<span class="op">,</span> val) <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(val))<span class="op">;</span> <span class="co">// true</span></a>
<a class="sourceLine" id="cb6-7" title="7"></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="at">myMockFn</span>((err<span class="op">,</span> val) <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(val))<span class="op">;</span> <span class="co">// false</span></a></code></pre></div>
<p>When the mocked function runs out of implementations defined with mockImplementationOnce, it will execute the default implementation set with <code>jest.fn(() =&gt; defaultValue)</code> or <code>.mockImplementation(() =&gt; defaultValue)</code> if they were called:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> myMockFn <span class="op">=</span> jest</a>
<a class="sourceLine" id="cb7-2" title="2">  .<span class="at">fn</span>(() <span class="kw">=&gt;</span> <span class="st">&#39;default&#39;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3">  .<span class="at">mockImplementationOnce</span>(() <span class="kw">=&gt;</span> <span class="st">&#39;first call&#39;</span>)</a>
<a class="sourceLine" id="cb7-4" title="4">  .<span class="at">mockImplementationOnce</span>(() <span class="kw">=&gt;</span> <span class="st">&#39;second call&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">// &#39;first call&#39;, &#39;second call&#39;, &#39;default&#39;, &#39;default&#39;</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>())<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mocknamevalue"><code>mockFn.mockName(value)</code></h3>
<p>Accepts a string to use in test result output in place of “jest.fn()” to indicate which mock function is being referenced.</p>
<p>For example:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> mockFn <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockName</span>(<span class="st">&#39;mockedFunction&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">// mockFn();</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="at">expect</span>(mockFn).<span class="at">toHaveBeenCalled</span>()<span class="op">;</span></a></code></pre></div>
<p>Will result in this error:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1">    <span class="ex">expect</span>(mockedFunction)<span class="ex">.toHaveBeenCalled</span>()</a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="ex">Expected</span> mock function to have been called.</a></code></pre></div>
<h3 id="mockfn.mockreturnthis"><code>mockFn.mockReturnThis()</code></h3>
<p>Just a simple sugar function for:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="va">jest</span>.<span class="at">fn</span>(<span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockreturnvaluevalue"><code>mockFn.mockReturnValue(value)</code></h3>
<p>Accepts a value that will be returned whenever the mock function is called.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> mock <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="va">mock</span>.<span class="at">mockReturnValue</span>(<span class="dv">42</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="at">mock</span>()<span class="op">;</span> <span class="co">// 42</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="va">mock</span>.<span class="at">mockReturnValue</span>(<span class="dv">43</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="at">mock</span>()<span class="op">;</span> <span class="co">// 43</span></a></code></pre></div>
<h3 id="mockfn.mockreturnvalueoncevalue"><code>mockFn.mockReturnValueOnce(value)</code></h3>
<p>Accepts a value that will be returned for one call to the mock function. Can be chained so that successive calls to the mock function return different values. When there are no more <code>mockReturnValueOnce</code> values to use, calls will return a value specified by <code>mockReturnValue</code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">const</span> myMockFn <span class="op">=</span> jest</a>
<a class="sourceLine" id="cb12-2" title="2">  .<span class="at">fn</span>()</a>
<a class="sourceLine" id="cb12-3" title="3">  .<span class="at">mockReturnValue</span>(<span class="st">&#39;default&#39;</span>)</a>
<a class="sourceLine" id="cb12-4" title="4">  .<span class="at">mockReturnValueOnce</span>(<span class="st">&#39;first call&#39;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5">  .<span class="at">mockReturnValueOnce</span>(<span class="st">&#39;second call&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-6" title="6"></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">// &#39;first call&#39;, &#39;second call&#39;, &#39;default&#39;, &#39;default&#39;</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="va">console</span>.<span class="at">log</span>(<span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>()<span class="op">,</span> <span class="at">myMockFn</span>())<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockresolvedvaluevalue"><code>mockFn.mockResolvedValue(value)</code></h3>
<p>Simple sugar function for:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockImplementation</span>(() <span class="kw">=&gt;</span> <span class="va">Promise</span>.<span class="at">resolve</span>(value))<span class="op">;</span></a></code></pre></div>
<p>Useful to mock async functions in async tests:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="at">test</span>(<span class="st">&#39;async test&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-2" title="2">  <span class="kw">const</span> asyncMock <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockResolvedValue</span>(<span class="dv">43</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// 43</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockresolvedvalueoncevalue"><code>mockFn.mockResolvedValueOnce(value)</code></h3>
<p>Simple sugar function for:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockImplementationOnce</span>(() <span class="kw">=&gt;</span> <span class="va">Promise</span>.<span class="at">resolve</span>(value))<span class="op">;</span></a></code></pre></div>
<p>Useful to resolve different values over multiple async calls:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="at">test</span>(<span class="st">&#39;async test&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">  <span class="kw">const</span> asyncMock <span class="op">=</span> jest</a>
<a class="sourceLine" id="cb16-3" title="3">    .<span class="at">fn</span>()</a>
<a class="sourceLine" id="cb16-4" title="4">    .<span class="at">mockResolvedValue</span>(<span class="st">&#39;default&#39;</span>)</a>
<a class="sourceLine" id="cb16-5" title="5">    .<span class="at">mockResolvedValueOnce</span>(<span class="st">&#39;first call&#39;</span>)</a>
<a class="sourceLine" id="cb16-6" title="6">    .<span class="at">mockResolvedValueOnce</span>(<span class="st">&#39;second call&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// first call</span></a>
<a class="sourceLine" id="cb16-9" title="9">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// second call</span></a>
<a class="sourceLine" id="cb16-10" title="10">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// default</span></a>
<a class="sourceLine" id="cb16-11" title="11">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// default</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockrejectedvaluevalue"><code>mockFn.mockRejectedValue(value)</code></h3>
<p>Simple sugar function for:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockImplementation</span>(() <span class="kw">=&gt;</span> <span class="va">Promise</span>.<span class="at">reject</span>(value))<span class="op">;</span></a></code></pre></div>
<p>Useful to create async mock functions that will always reject:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="at">test</span>(<span class="st">&#39;async test&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="kw">const</span> asyncMock <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockRejectedValue</span>(<span class="kw">new</span> <span class="at">Error</span>(<span class="st">&#39;Async error&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// throws &quot;Async error&quot;</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="mockfn.mockrejectedvalueoncevalue"><code>mockFn.mockRejectedValueOnce(value)</code></h3>
<p>Simple sugar function for:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="va">jest</span>.<span class="at">fn</span>().<span class="at">mockImplementationOnce</span>(() <span class="kw">=&gt;</span> <span class="va">Promise</span>.<span class="at">reject</span>(value))<span class="op">;</span></a></code></pre></div>
<p>Example usage:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="at">test</span>(<span class="st">&#39;async test&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="kw">const</span> asyncMock <span class="op">=</span> jest</a>
<a class="sourceLine" id="cb20-3" title="3">    .<span class="at">fn</span>()</a>
<a class="sourceLine" id="cb20-4" title="4">    .<span class="at">mockResolvedValueOnce</span>(<span class="st">&#39;first call&#39;</span>)</a>
<a class="sourceLine" id="cb20-5" title="5">    .<span class="at">mockRejectedValueOnce</span>(<span class="kw">new</span> <span class="at">Error</span>(<span class="st">&#39;Async error&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb20-6" title="6"></a>
<a class="sourceLine" id="cb20-7" title="7">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// first call</span></a>
<a class="sourceLine" id="cb20-8" title="8">  <span class="cf">await</span> <span class="at">asyncMock</span>()<span class="op">;</span> <span class="co">// throws &quot;Async error&quot;</span></a>
<a class="sourceLine" id="cb20-9" title="9"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
</body>
</html>
