<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <meta name="author" content="Christoph Pojer" />
    <title>2016 in Jest</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
  </head>
  <body>
    <header id="title-block-header">
      <h1 class="title">2016 in Jest</h1>
      <p class="author">Christoph Pojer</p>
    </header>
    <p>
      2016 was a big year for JavaScript testing with Jest. In the first six
      months of the year we rewrote Jest and built a solid foundation to
      significantly improve performance and the developer experience of testing
      JavaScript code. We flow-typed the entire codebase, built a ton of
      integration tests for Jest itself and adopted
      <a href="https://lernajs.io/">lerna</a> to turn Jest from a framework into
      a
      <a href="https://github.com/facebook/jest/tree/master/packages"
        ><em>Painless JavaScript Testing platform</em></a
      >.
    </p>
    <p>
      The newly created
      <a href="https://yarnpkg.com/en/package/react-test-renderer"
        >react-test-renderer</a
      >
      finally enabled testing of react-native components. Through the
      jest-react-native preset (now merged directly into react-native) Jest now
      works out of the box for any React project and comes pre-configured in
      <a href="https://github.com/facebookincubator/create-react-app"
        >create-react-app</a
      >
      and
      <a href="https://github.com/facebook/react-native">react-native</a>
      projects. We integrated core pieces of Jest into
      <a
        href="https://github.com/facebook/react-native/tree/master/packager/react-packager/src"
        >react-native’s packager</a
      >
      and the completely new snapshot testing feature has since been used
      outside of Jest: It was integrated with React Storybook as “<a
        href="https://github.com/storybooks/storyshots"
        >storyshots</a
      >” and is being adopted by other test runners like
      <a href="https://github.com/avajs/ava/pull/1113">ava</a>.
    </p>
    <!--truncate-->
    <p>
      The
      <a
        href="https://github.com/facebook/jest/tree/master/packages/pretty-format"
        >pretty-format</a
      >
      project was rewritten with performance in mind to drive Jest’s snapshot
      feature, was recently merged into Jest’s monorepo and is also helpful in
      other <a href="https://github.com/avajs/ava/pull/1154">test runners</a>.
      Nowadays Jest is much more about collecting different ideas and solutions
      to testing than it is about one specific implementation of a test
      framework.
    </p>
    <p>
      I’d like to deeply thank all the people that have
      <a
        href="https://github.com/facebook/jest/graphs/contributors?from=2016-01-01&amp;to=2016-12-14&amp;type=c"
        >contributed to Jest this year</a
      >, both from the open source community and at Facebook: Dmitrii Abramov,
      Cristian Carlesso, Dan Abramov, Daniel Lo Nigro, Maxim Derbin, Evan Scott,
      Forbes Lindesay, Keyan Zhang and 60 more people. We’d also like to welcome
      <span class="citation" data-cites="thymikee"
        >[Michał Pierzchała (@thymikee)]</span
      >(https://twitter.com/thymikee) as first official external contributor to
      Jest. He’s been doing a great job managing the issues and PRs on the repo.
      If you’d like to start contributing to Jest, we have a bunch of
      <a
        href="https://github.com/facebook/jest/issues?q=is%3Aissue+is%3Aopen+label%3A%22good+first+bug%22"
        >good first tasks</a
      >
      and we are always happy to help on our
      <a href="https://jestjs.io/support.html">discord channel</a>.
    </p>
    <h2 id="repl.it-with-jest-integration">
      <a href="http://repl.it/">repl.it</a> with Jest integration
    </h2>
    <p>
      Amjad Massad
      <a href="https://repl.it/languages/jest">built a Jest container</a> so you
      can now try out Jest directly in the browser. You can use it from now on
      when creating GitHub issues which should help troubleshoot problems more
      quickly. Amjad and Haya are building
      <a href="http://repl.it/">repl.it</a> to democratize programming by
      building powerful yet simple tools and platforms for educators, learners,
      and developers. They are also
      <a href="https://repl.it/site/jobs">hiring talented engineers</a>!
    </p>
    <div class="jest-repl">
      <p><iframe src="https://repl.it/languages/jest?lite=true"></iframe></p>
    </div>
    <h2 id="community-update">Community Update</h2>
    <p>
      We feel incredibly humbled that 100+ companies
      <a href="https://twitter.com/cpojer/status/803965499407290369"
        >have adopted Jest</a
      >
      in the last six months. Companies like Twitter, Pinterest, Paypal,
      nytimes, IBM (Watson), Spotify, eBay, SoundCloud, Intuit, FormidableLabs,
      Automattic, Trivago and Microsoft have either fully or partially switched
      to Jest for their JavaScript testing needs. Thank you very much for giving
      this project a chance. We would also like to thank everyone who went to
      conferences and meetups to speak about Jest and to everyone who is writing
      blog posts about how Jest is or isn’t working for them!
    </p>
    <p>Here is what happened in the community in the last two months:</p>
    <ul>
      <li>
        Jason Bonta and Dmitrii Abramov
        <a href="https://twitter.com/abramov_dmitrii/status/805913874704674816"
          >redefined the “testing pyramid”</a
        >
        we were talking a lot about at Facebook.
      </li>
      <li>
        <a href="https://github.com/skovhus/jest-codemods#jest-codemods"
          >jest-codemods</a
        >
        now allows you to painlessly migrate from Mocha, Tape and Ava to Jest.
      </li>
      <li>
        The React team announced
        <a
          href="https://facebook.github.io/react/blog/2016/11/16/react-v15.4.0.html"
          >improvements to the react-test-renderer</a
        >
        in 15.4.0.
      </li>
      <li>
        Orta Therox build an amazing
        <a href="https://github.com/orta/vscode-jest#the-aim"
          >vscode-jest integration</a
        >
        and donated the code for editor support to Jest.
      </li>
      <li>
        Pavithra Kodmad is documenting
        <a href="http://pksjce.github.io/2016/12/08/notes-on-jest"
          >Flipkarts adoption of Jest</a
        >
        and shares some getting started tips.
      </li>
      <li>
        Kent C. Dodds wrote about
        <a
          href="https://medium.com/@kentcdodds/migrating-to-jest-881f75366e7e#.ticf0wchu"
          >migrating to Jest at Paypal</a
        >
        and Jason Brown
        <a href="http://browniefed.com/blog/migrating-ava-to-jest/"
          >wrote about migrating to Jest as well</a
        >.
      </li>
      <li>
        Ben McCormick wrote about
        <a href="http://benmccormick.org/2016/12/10/saving-time-with-jest/"
          >saving time with Jest</a
        >.
      </li>
      <li>
        Eric Clemmons wrote about
        <a
          href="https://medium.com/@ericclemmons/jest-snapshots-for-storybook-5bf36b5e5a3a"
          >snapshots and storybook integration</a
        >.
      </li>
      <li>
        Edvin Erikson wrote about
        <a
          href="https://medium.com/@edvinerikson/getting-jest-output-in-tap-format-6e07dc2c484c#.1l4edixhl"
          >getting Tap output in Jest</a
        >.
      </li>
      <li>
        <a href="https://github.com/guigrpa/jest-html#jest-html--">jest-html</a>
        can bring snapshot diffing to your browser.
      </li>
      <li>
        There were a few
        <a href="https://news.ycombinator.com/item?id=13128146"
          >great conversations on hackernews</a
        >
        about Jest.
      </li>
      <li>
        The community started a great discussion about the
        <a href="https://github.com/airbnb/enzyme/issues/715"
          >future of enzyme</a
        >.
      </li>
      <li>
        Ruben Oostinga wrote about
        <a
          href="https://medium.com/@RubenOostinga/combining-chai-and-jest-matchers-d12d1ffd0303#.87si0ra2h"
          >combining chai and Jest matchers</a
        >.
      </li>
      <li>
        Emil Ong wrote about why
        <a
          href="https://engineering.haus.com/why-tdding-your-frontend-feels-pointless-5f710fea7325#.pql79knnm"
          >“TDD’ing your frontend seems pointless”</a
        >.
      </li>
      <li>
        Nate Hunzaker wrote about
        <a
          href="https://www.viget.com/articles/acceptance-testing-react-apps-with-jest-and-nightmare"
          >end-to-end testing with Jest and Nightmare</a
        >.
      </li>
      <li>
        <a
          href="https://medium.com/aya-experience/testing-an-angularjs-app-with-jest-3029a613251#.h9badqevy"
          >Using Jest with Angular just works</a
        >
        according to Matthieu Lux.
      </li>
      <li>
        A fantastic conversation about the
        <a href="https://github.com/facebook/jest/issues/2197"
          >purpose of snapshot testing</a
        >
        is happening right now.
      </li>
      <li>
        Dmitrii made a new
        <a href="https://twitter.com/abramov_dmitrii/status/806613542447157248"
          >music video with his metal band</a
        >.
      </li>
      <li>
        <a href="https://yarnpkg.com/en/package/lazyspec">lazyspec</a> can help
        you create smoke tests quickly if you are introducing tests to an
        existing codebase.
      </li>
      <li>
        Patrick Stapfer did a lightning talk about
        <a href="https://twitter.com/ryyppy/status/803871975995277312"
          >vim and Jest</a
        >.
      </li>
      <li>
        Mark Dalgleish was
        <a href="https://twitter.com/markdalgleish/status/806608159527747584"
          >commenting on the value of snapshot testing</a
        >.
      </li>
    </ul>
    <h2 id="new-features-changes-and-fixes-in-jest-17-18">
      New features, changes and fixes in Jest 17 &amp; 18
    </h2>
    <p>
      Jest was initially created more than five years ago and as such an old
      framework it has accumulated some technical debt. This is why we tend to
      make breaking changes more often than may seem necessary: We believe it is
      important to incrementally reduce technical debt to ensure that Jest as a
      project stays maintainable long-term. We didn’t announce Jest 17 in a blog
      post and if you haven’t upgraded to it in the last month you may find the
      <a href="https://github.com/facebook/jest/blob/master/CHANGELOG.md"
        >changelog</a
      >
      useful.
    </p>
    <ul>
      <li>
        <strong>Breaking:</strong> Removed <code>pit</code> in favor of
        <code>it</code> or <code>test</code> and <code>mockImpl</code> in favor
        of <code>jest.fn()</code> or <code>mockImplementation</code> .
      </li>
      <li>
        <strong>Breaking:</strong> Renamed <code>--jsonOutputFile</code> to
        <code>--outputFile</code>.
      </li>
      <li>
        <strong>Breaking:</strong> Updated <code>testRegex</code> to include
        <code>test.js</code> and <code>spec.js</code> files.
      </li>
      <li>
        <strong>Breaking:</strong> Replaced <code>scriptPreprocessor</code> with
        the new <code>transform</code> option.
      </li>
      <li>
        <strong>Breaking:</strong> The
        <code>testResultsProcessor</code> function is now required to return the
        modified results.
      </li>
      <li>
        <strong>Potentially Breaking:</strong> Properly resolve
        <code>snapshotSerializers</code>, <code>setupFiles</code>,
        <code>transform</code>, <code>testRunner</code> and
        <code>testResultsProcessor</code> with a resolution algorithm instead of
        using <code>path.resolve</code>. This mainly means that
        <code>&lt;rootDir&gt;</code> is no longer needed for these options.
      </li>
      <li>
        <strong>Added: </strong><code>pretty-format</code> and
        <code>jest-editor-support</code> were merged into Jest.
      </li>
      <li>
        <strong>Added:</strong> <code>expect.any</code>,
        <code>expect.anything</code>, <code>expect.objectContaining</code>,
        <code>expect.arrayContaining</code>, <code>expect.stringMatching</code>.
      </li>
      <li>
        <strong>Added: </strong><code>--testResultsProcessor</code> is now
        exposed through the cli.
      </li>
      <li>
        <strong>Added:</strong> Implemented file watching in
        <code>jest-haste-map</code>.
      </li>
      <li>
        <strong>Added:</strong> Usage of Jest in watch mode can be hidden
        through <code>JEST_HIDE_USAGE</code>.
      </li>
      <li>
        <strong>Added:</strong> <code>expect.assertions(number)</code> which
        will ensure that a specified amount of assertions is made in one test.
      </li>
      <li>
        <strong>Added: </strong><code>.toMatchSnapshot(?string)</code> feature
        to give snapshots a name.
      </li>
      <li>
        <strong>Added: </strong><code>toMatchObject</code>,
        <code>toHaveProperty</code> , <code>toHaveLength</code> matchers.
      </li>
      <li><strong>Added:</strong> <code>expect.extend</code>.</li>
      <li>
        <strong>Added:</strong> Added support for custom snapshots serializers.
      </li>
      <li>
        <strong>Added:</strong> Big diffs are now collapsed by default in
        snapshots and assertions. Added <code>--expand</code> (or
        <code>-e</code>) to show the full diff.
      </li>
      <li>
        <strong>Added:</strong> <code>jest.resetAllMocks</code> which replaces
        <code>jest.clearAllMocks</code>.
      </li>
      <li>
        <strong>Added: </strong><code>--json</code> now includes information
        about individual tests inside a file.
      </li>
      <li>
        <strong>Fixed: </strong><code>test.concurrent</code> unhandled promise
        rejections.
      </li>
      <li>
        <strong>Fixed:</strong> <code>babel-plugin-jest-hoist</code> when using
        <code>jest.mock</code> with three arguments.
      </li>
      <li>
        <strong>Fixed:</strong> The <code>JSON</code> global in
        <code>jest-environment-node</code> now comes from the vm context instead
        of the parent context.
      </li>
      <li>
        <strong>Fixed:</strong> Jest does not print stack traces from babel any
        longer.
      </li>
      <li>
        <strong>Fixed:</strong> Fake timers are reset when
        <code>FakeTimers.useTimers()</code> is called.
      </li>
      <li>
        <strong>Fixed:</strong> Regular expressions are properly escaped in
        snapshots.
      </li>
      <li>
        <strong>Fixed:</strong> Improved pretty printing of large objects.
      </li>
      <li>
        <strong>Fixed:</strong> <code>NaN% Failed</code> in the OS notification
        when using <code>--notify</code>.
      </li>
      <li>
        <strong>Fixed:</strong> The first test run without cached timings will
        now use separate processes instead of running in band.
      </li>
      <li>
        <strong>Fixed:</strong> <code>Map</code>/<code>Set</code> comparisons.
      </li>
      <li>
        <strong>Fixed: </strong><code>test.concurrent</code> now works with
        <code>--testNamePattern</code>.
      </li>
      <li><strong>Fixed:</strong> Improved <code>.toContain</code> matcher.</li>
      <li>
        <strong>Fixed:</strong> Properly resolve modules with platform
        extensions on react-native.
      </li>
      <li>
        <strong>Fixed:</strong> global built in objects in
        <code>jest-environment-node</code> now work properly.
      </li>
      <li>
        <strong>Fixed:</strong> Create mock objects in the vm context instead of
        the parent context.
      </li>
      <li>
        <strong>Fixed: </strong><code>.babelrc</code> is now part of the
        transform cache key in <code>babel-jest</code>.
      </li>
      <li><strong>Fixed:</strong> docblock parsing with haste modules.</li>
      <li>
        <strong>Fixed:</strong> Exit with the proper code when the coverage
        threshold is not reached.
      </li>
      <li>
        <strong>Fixed: </strong>Jest now clears the entire scrollback in watch
        mode.
      </li>
      <li>
        <strong>Deprecated: </strong><code>jest-react-native</code> was
        deprecated and now forwards <code>react-native</code>.
      </li>
    </ul>
    <h2 id="plans-for-jest-in-h1-2017">Plans for Jest in H1 2017</h2>
    <p>
      Six months ago
      <a
        href="https://jestjs.io/blog/2016/07/27/jest-14.html#what-s-next-for-jest"
        >we shared our plans for Jest</a
      >
      and we are happy that we were able to execute well on almost all of them.
      For the next six months, here is what we are planning:
    </p>
    <ul>
      <li>
        <strong>Instant feedback:</strong>
        <a href="https://nuclide.io/">Nuclide</a> integration and an improved
        and
        <a
          href="https://github.com/facebook/jest/pull/2324#issuecomment-267149669"
          >faster watch mode</a
        >.
      </li>
      <li>
        <strong>Improved developer experience:</strong> new mocking APIs and
        improved assertions.
      </li>
      <li>
        <strong>Better performance and memory usage:</strong> analyze Jest and
        be more conscious about efficiency.
      </li>
      <li>
        <strong>Snapshot Improvements: </strong>snapshot approval mode, syntax
        highlighting and improved <code>react-test-renderer</code> APIs.
      </li>
      <li>
        <strong>Website:</strong> We’ll overhaul the website and documentation
        and add a Jest cheat sheet.
      </li>
    </ul>
    <p>
      We won’t be providing timelines or estimates for these features and we may
      not actually get to all of these things. If you’d like to help make these
      things a reality, send us issues and pull requests with your ideas and
      let’s work on improving Jest together in 2017.
    </p>
  </body>
</html>
