<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>The Jest Object</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <header id="title-block-header">
      <h1 class="title">The Jest Object</h1>
    </header>
    <p>
      The <code>jest</code> object is automatically in scope within every test
      file. The methods in the <code>jest</code> object help create mocks and
      let you control Jest’s overall behavior.
    </p>
    <h2 id="mock-modules">Mock Modules</h2>
    <h3 id="jest.disableautomock"><code>jest.disableAutomock()</code></h3>
    <p>Disables automatic mocking in the module loader.</p>
    <blockquote>
      <p>
        See <code>automock</code> section of
        <a href="Configuration.md#automock-boolean">configuration</a> for more
        information
      </p>
    </blockquote>
    <p>
      After this method is called, all <code>require()</code>s will return the
      real versions of each module (rather than a mocked version).
    </p>
    <p>Jest configuration:</p>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode json"
      ><code class="sourceCode json"><a class="sourceLine" id="cb1-1" title="1"><span class="fu">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="dt">&quot;automock&quot;</span><span class="fu">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="fu">}</span></a></code></pre>
    </div>
    <p>Example:</p>
    <div class="sourceCode" id="cb2">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// utils.js</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">authorize</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="cf">return</span> <span class="st">&#39;token&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="op">};</span></a></code></pre>
    </div>
    <div class="sourceCode" id="cb3">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// __tests__/disableAutomocking.js</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="im">import</span> utils <span class="im">from</span> <span class="st">&#39;../utils&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">jest</span>.<span class="at">disableAutomock</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="at">test</span>(<span class="st">&#39;original implementation&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="co">// now we have the original implementation,</span></a>
<a class="sourceLine" id="cb3-8" title="8">  <span class="co">// even if we set the automocking in a jest configuration</span></a>
<a class="sourceLine" id="cb3-9" title="9">  <span class="at">expect</span>(<span class="va">utils</span>.<span class="at">authorize</span>()).<span class="at">toBe</span>(<span class="st">&#39;token&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>
      This is usually useful when you have a scenario where the number of
      dependencies you want to mock is far less than the number of dependencies
      that you don’t. For example, if you’re writing a test for a module that
      uses a large number of dependencies that can be reasonably classified as
      “implementation details” of the module, then you likely do not want to
      mock them.
    </p>
    <p>
      Examples of dependencies that might be considered “implementation details”
      are things ranging from language built-ins (e.g. Array.prototype methods)
      to highly common utility methods (e.g. underscore/lo-dash, array utilities
      etc) and entire libraries like React.js.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <p>
      <em
        >Note: this method was previously called <code>autoMockOff</code>. When
        using <code>babel-jest</code>, calls to
        <code>disableAutomock</code> will automatically be hoisted to the top of
        the code block. Use <code>autoMockOff</code> if you want to explicitly
        avoid this behavior.</em
      >
    </p>
    <h3 id="jest.enableautomock"><code>jest.enableAutomock()</code></h3>
    <p>Enables automatic mocking in the module loader.</p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <blockquote>
      <p>
        See <code>automock</code> section of
        <a href="Configuration.md#automock-boolean">configuration</a> for more
        information
      </p>
    </blockquote>
    <p>Example:</p>
    <div class="sourceCode" id="cb4">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="co">// utils.js</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">authorize</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">    <span class="cf">return</span> <span class="st">&#39;token&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="dt">isAuthorized</span><span class="op">:</span> (secret) <span class="kw">=&gt;</span> secret <span class="op">===</span> <span class="st">&#39;wizard&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="op">};</span></a></code></pre>
    </div>
    <div class="sourceCode" id="cb5">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="co">// __tests__/disableAutomocking.js</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">jest</span>.<span class="at">enableAutomock</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="im">import</span> utils <span class="im">from</span> <span class="st">&#39;../utils&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="at">test</span>(<span class="st">&#39;original implementation&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="co">// now we have the mocked implementation,</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="at">expect</span>(<span class="va">utils</span>.<span class="va">authorize</span>.<span class="at">_isMockFunction</span>).<span class="at">toBeTruthy</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="at">expect</span>(<span class="va">utils</span>.<span class="va">isAuthorized</span>.<span class="at">_isMockFunction</span>).<span class="at">toBeTruthy</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>
      <em
        >Note: this method was previously called <code>autoMockOn</code>. When
        using <code>babel-jest</code>, calls to <code>enableAutomock</code> will
        automatically be hoisted to the top of the code block. Use
        <code>autoMockOn</code> if you want to explicitly avoid this
        behavior.</em
      >
    </p>
    <h3 id="jest.genmockfrommodulemodulename">
      <code>jest.genMockFromModule(moduleName)</code>
    </h3>
    <p>
      Given the name of a module, use the automatic mocking system to generate a
      mocked version of the module for you.
    </p>
    <p>
      This is useful when you want to create a
      <a href="ManualMocks.md">manual mock</a> that extends the automatic mock’s
      behavior.
    </p>
    <p>Example:</p>
    <div class="sourceCode" id="cb6">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="co">// utils.js</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="im">export</span> <span class="im">default</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-3" title="3">  <span class="dt">authorize</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="cf">return</span> <span class="st">&#39;token&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb6-6" title="6">  <span class="dt">isAuthorized</span><span class="op">:</span> (secret) <span class="kw">=&gt;</span> secret <span class="op">===</span> <span class="st">&#39;wizard&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">};</span></a></code></pre>
    </div>
    <div class="sourceCode" id="cb7">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="co">// __tests__/genMockFromModule.test.js</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">const</span> utils <span class="op">=</span> <span class="va">jest</span>.<span class="at">genMockFromModule</span>(<span class="st">&#39;../utils&#39;</span>).<span class="at">default</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="va">utils</span>.<span class="at">isAuthorized</span> <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>((secret) <span class="kw">=&gt;</span> secret <span class="op">===</span> <span class="st">&#39;not wizard&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="at">test</span>(<span class="st">&#39;implementation created by jest.genMockFromModule&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="at">expect</span>(<span class="va">utils</span>.<span class="va">authorize</span>.<span class="at">mock</span>).<span class="at">toBeTruthy</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-7" title="7">  <span class="at">expect</span>(<span class="va">utils</span>.<span class="at">isAuthorized</span>(<span class="st">&#39;not wizard&#39;</span>)).<span class="at">toEqual</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>
      This is how <code>genMockFromModule</code> will mock the following data
      types:
    </p>
    <h4 id="function"><code>Function</code></h4>
    <p>
      Creates a new
      <a href="https://jestjs.io/docs/en/mock-functions.html">mock function</a>.
      The new function has no formal parameters and when called will return
      <code>undefined</code>. This functionality also applies to
      <code>async</code> functions.
    </p>
    <h4 id="class"><code>Class</code></h4>
    <p>
      Creates new class. The interface of the original class is maintained, all
      of the class member functions and properties will be mocked.
    </p>
    <h4 id="object"><code>Object</code></h4>
    <p>
      Creates a new deeply cloned object. The object keys are maintained and
      their values are mocked.
    </p>
    <h4 id="array"><code>Array</code></h4>
    <p>Creates a new empty array, ignoring the original.</p>
    <h4 id="primitives"><code>Primitives</code></h4>
    <p>
      Creates a new property with the same primitive value as the original
      property.
    </p>
    <p>Example:</p>
    <pre><code>// example.js
module.exports = {
  function: function square(a, b) {
    return a * b;
  },
  asyncFunction: async function asyncSquare(a, b) {
    const result = await a * b;
    return result;
  },
  class: new class Bar {
    constructor() {
      this.array = [1, 2, 3];
    }
    foo() {}
  },
  object: {
    baz: &#39;foo&#39;,
    bar: {
      fiz: 1,
      buzz: [1, 2, 3],
    },
  },
  array: [1, 2, 3],
  number: 123,
  string: &#39;baz&#39;,
  boolean: true,
  symbol: Symbol.for(&#39;a.b.c&#39;),
};</code></pre>
    <div class="sourceCode" id="cb9">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="co">// __tests__/example.test.js</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">const</span> example <span class="op">=</span> <span class="va">jest</span>.<span class="at">genMockFromModule</span>(<span class="st">&#39;./example&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="at">test</span>(<span class="st">&#39;should run example code&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-5" title="5">  <span class="co">// creates a new mocked function with no formal arguments.</span></a>
<a class="sourceLine" id="cb9-6" title="6">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">function</span>.<span class="at">name</span>).<span class="at">toEqual</span>(<span class="st">&#39;square&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">function</span>.<span class="at">length</span>).<span class="at">toEqual</span>(<span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="co">// async functions get the same treatment as standard synchronous functions.</span></a>
<a class="sourceLine" id="cb9-10" title="10">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">asyncFunction</span>.<span class="at">name</span>).<span class="at">toEqual</span>(<span class="st">&#39;asyncSquare&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-11" title="11">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">asyncFunction</span>.<span class="at">length</span>).<span class="at">toEqual</span>(<span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-12" title="12"></a>
<a class="sourceLine" id="cb9-13" title="13">  <span class="co">// creates a new class with the same interface, member functions and properties are mocked.</span></a>
<a class="sourceLine" id="cb9-14" title="14">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">class</span>.<span class="va">constructor</span>.<span class="at">name</span>).<span class="at">toEqual</span>(<span class="st">&#39;Bar&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-15" title="15">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">class</span>.<span class="va">foo</span>.<span class="at">name</span>).<span class="at">toEqual</span>(<span class="st">&#39;foo&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-16" title="16">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">class</span>.<span class="va">array</span>.<span class="at">length</span>).<span class="at">toEqual</span>(<span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-17" title="17"></a>
<a class="sourceLine" id="cb9-18" title="18">  <span class="co">// creates a deeply cloned version of the original object.</span></a>
<a class="sourceLine" id="cb9-19" title="19">  <span class="at">expect</span>(<span class="va">example</span>.<span class="at">object</span>).<span class="at">toEqual</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb9-20" title="20">    <span class="dt">baz</span><span class="op">:</span> <span class="st">&#39;foo&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-21" title="21">    <span class="dt">bar</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-22" title="22">      <span class="dt">fiz</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-23" title="23">      <span class="dt">buzz</span><span class="op">:</span> []<span class="op">,</span></a>
<a class="sourceLine" id="cb9-24" title="24">    <span class="op">},</span></a>
<a class="sourceLine" id="cb9-25" title="25">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-26" title="26"></a>
<a class="sourceLine" id="cb9-27" title="27">  <span class="co">// creates a new empty array, ignoring the original array.</span></a>
<a class="sourceLine" id="cb9-28" title="28">  <span class="at">expect</span>(<span class="va">example</span>.<span class="va">array</span>.<span class="at">length</span>).<span class="at">toEqual</span>(<span class="dv">0</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-29" title="29"></a>
<a class="sourceLine" id="cb9-30" title="30">  <span class="co">// creates a new property with the same primitive value as the original property.</span></a>
<a class="sourceLine" id="cb9-31" title="31">  <span class="at">expect</span>(<span class="va">example</span>.<span class="at">number</span>).<span class="at">toEqual</span>(<span class="dv">123</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-32" title="32">  <span class="at">expect</span>(<span class="va">example</span>.<span class="at">string</span>).<span class="at">toEqual</span>(<span class="st">&#39;baz&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-33" title="33">  <span class="at">expect</span>(<span class="va">example</span>.<span class="at">boolean</span>).<span class="at">toEqual</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-34" title="34">  <span class="at">expect</span>(<span class="va">example</span>.<span class="at">symbol</span>).<span class="at">toEqual</span>(<span class="va">Symbol</span>.<span class="at">for</span>(<span class="st">&#39;a.b.c&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb9-35" title="35"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h3 id="jest.mockmodulename-factory-options">
      <code>jest.mock(moduleName, factory, options)</code>
    </h3>
    <p>
      Mocks a module with an auto-mocked version when it is being required.
      <code>factory</code> and <code>options</code> are optional. For example:
    </p>
    <div class="sourceCode" id="cb10">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="co">// banana.js</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> () <span class="kw">=&gt;</span> <span class="st">&#39;banana&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">// __tests__/test.js</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="va">jest</span>.<span class="at">mock</span>(<span class="st">&#39;../banana&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">const</span> banana <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../banana&#39;</span>)<span class="op">;</span> <span class="co">// banana will be explicitly mocked.</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="at">banana</span>()<span class="op">;</span> <span class="co">// will return &#39;undefined&#39; because the function is auto-mocked.</span></a></code></pre>
    </div>
    <p>
      The second argument can be used to specify an explicit module factory that
      is being run instead of using Jest’s automocking feature:
    </p>
    <div class="sourceCode" id="cb11">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="va">jest</span>.<span class="at">mock</span>(<span class="st">&#39;../moduleName&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="cf">return</span> <span class="va">jest</span>.<span class="at">fn</span>(() <span class="kw">=&gt;</span> <span class="dv">42</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="co">// This runs the function specified as second argument to `jest.mock`.</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">const</span> moduleName <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../moduleName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="at">moduleName</span>()<span class="op">;</span> <span class="co">// Will return &#39;42&#39;;</span></a></code></pre>
    </div>
    <p>
      The third argument can be used to create virtual mocks – mocks of modules
      that don’t exist anywhere in the system:
    </p>
    <div class="sourceCode" id="cb12">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="va">jest</span>.<span class="at">mock</span>(</a>
<a class="sourceLine" id="cb12-2" title="2">  <span class="st">&#39;../moduleName&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb12-3" title="3">  () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-4" title="4">    <span class="co">/*</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="co">     * Custom implementation of a module that doesn&#39;t exist in JS,</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="co">     * like a generated module or a native module in react-native.</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="co">     */</span></a>
<a class="sourceLine" id="cb12-8" title="8">  <span class="op">},</span></a>
<a class="sourceLine" id="cb12-9" title="9">  <span class="op">{</span><span class="dt">virtual</span><span class="op">:</span> <span class="kw">true</span><span class="op">},</span></a>
<a class="sourceLine" id="cb12-10" title="10">)<span class="op">;</span></a></code></pre>
    </div>
    <p>
      <em
        >Warning: Importing a module in a setup file (as specified by
        <code>setupTestFrameworkScriptFile</code>) will prevent mocking for the
        module in question, as well as all the modules that it imports.</em
      >
    </p>
    <p>
      Modules that are mocked with <code>jest.mock</code> are mocked only for
      the file that calls <code>jest.mock</code>. Another file that imports the
      module will get the original implementation even if it runs after the test
      file that mocks the module.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.unmockmodulename"><code>jest.unmock(moduleName)</code></h3>
    <p>
      Indicates that the module system should never return a mocked version of
      the specified module from <code>require()</code> (e.g. that it should
      always return the real module).
    </p>
    <p>
      The most common use of this API is for specifying the module a given test
      intends to be testing (and thus doesn’t want automatically mocked).
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.domockmodulename-factory-options">
      <code>jest.doMock(moduleName, factory, options)</code>
    </h3>
    <p>
      When using <code>babel-jest</code>, calls to <code>mock</code> will
      automatically be hoisted to the top of the code block. Use this method if
      you want to explicitly avoid this behavior.
    </p>
    <p>
      One example when this is useful is when you want to mock a module
      differently within the same file:
    </p>
    <div class="sourceCode" id="cb13">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="va">jest</span>.<span class="at">resetModules</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="at">test</span>(<span class="st">&#39;moduleName 1&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-6" title="6">  <span class="va">jest</span>.<span class="at">doMock</span>(<span class="st">&#39;../moduleName&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-7" title="7">    <span class="cf">return</span> <span class="va">jest</span>.<span class="at">fn</span>(() <span class="kw">=&gt;</span> <span class="dv">1</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-8" title="8">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-9" title="9">  <span class="kw">const</span> moduleName <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../moduleName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-10" title="10">  <span class="at">expect</span>(<span class="at">moduleName</span>()).<span class="at">toEqual</span>(<span class="dv">1</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-12" title="12"></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="at">test</span>(<span class="st">&#39;moduleName 2&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-14" title="14">  <span class="va">jest</span>.<span class="at">doMock</span>(<span class="st">&#39;../moduleName&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-15" title="15">    <span class="cf">return</span> <span class="va">jest</span>.<span class="at">fn</span>(() <span class="kw">=&gt;</span> <span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-16" title="16">  <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-17" title="17">  <span class="kw">const</span> moduleName <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../moduleName&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-18" title="18">  <span class="at">expect</span>(<span class="at">moduleName</span>()).<span class="at">toEqual</span>(<span class="dv">2</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-19" title="19"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.dontmockmodulename"><code>jest.dontMock(moduleName)</code></h3>
    <p>
      When using <code>babel-jest</code>, calls to <code>unmock</code> will
      automatically be hoisted to the top of the code block. Use this method if
      you want to explicitly avoid this behavior.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.setmockmodulename-moduleexports">
      <code>jest.setMock(moduleName, moduleExports)</code>
    </h3>
    <p>
      Explicitly supplies the mock object that the module system should return
      for the specified module.
    </p>
    <p>
      On occasion there are times where the automatically generated mock the
      module system would normally provide you isn’t adequate enough for your
      testing needs. Normally under those circumstances you should write a
      <a href="ManualMocks.md">manual mock</a> that is more adequate for the
      module in question. However, on extremely rare occasions, even a manual
      mock isn’t suitable for your purposes and you need to build the mock
      yourself inside your test.
    </p>
    <p>
      In these rare scenarios you can use this API to manually fill the slot in
      the module system’s mock-module registry.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <p>
      <em
        >Note It is recommended to use
        <a href="#jestmockmodulename-factory-options"
          ><code>jest.mock()</code></a
        >
        instead. The <code>jest.mock</code> API’s second argument is a module
        factory instead of the expected exported module object.</em
      >
    </p>
    <h3 id="jest.requireactualmodulename">
      <code>jest.requireActual(moduleName)</code>
    </h3>
    <p>
      Returns the actual module instead of a mock, bypassing all checks on
      whether the module should receive a mock implementation or not.
    </p>
    <h3 id="jest.requiremockmodulename">
      <code>jest.requireMock(moduleName)</code>
    </h3>
    <p>
      Returns a mock module instead of the actual module, bypassing all checks
      on whether the module should be required normally or not.
    </p>
    <h3 id="jest.resetmodules"><code>jest.resetModules()</code></h3>
    <p>
      Resets the module registry - the cache of all required modules. This is
      useful to isolate modules where local state might conflict between tests.
    </p>
    <p>Example:</p>
    <div class="sourceCode" id="cb14">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">const</span> sum1 <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../sum&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="va">jest</span>.<span class="at">resetModules</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="kw">const</span> sum2 <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../sum&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-4" title="4">sum1 <span class="op">===</span> sum2<span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co">// &gt; false (Both sum modules are separate &quot;instances&quot; of the sum module.)</span></a></code></pre>
    </div>
    <p>Example in a test:</p>
    <div class="sourceCode" id="cb15">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="at">beforeEach</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="va">jest</span>.<span class="at">resetModules</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="at">test</span>(<span class="st">&#39;works&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-6" title="6">  <span class="kw">const</span> sum <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../sum&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="at">test</span>(<span class="st">&#39;works too&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="kw">const</span> sum <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;../sum&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-11" title="11">  <span class="co">// sum is a different copy of the sum module from the previous test.</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.isolatemodulesfn"><code>jest.isolateModules(fn)</code></h3>
    <p>
      <code>jest.isolateModules(fn)</code> goes a step further than
      <code>jest.resetModules()</code> and creates a sandbox registry for the
      modules that are loaded inside the callback function. This is useful to
      isolate specific modules for every test so that local module state doesn’t
      conflict between tests.
    </p>
    <div class="sourceCode" id="cb16">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">let</span> myModule<span class="op">;</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="va">jest</span>.<span class="at">isolateModules</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">  myModule <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;myModule&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="kw">const</span> otherCopyOfMyModule <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;myModule&#39;</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h2 id="mock-functions">Mock functions</h2>
    <h3 id="jest.fnimplementation"><code>jest.fn(implementation)</code></h3>
    <p>
      Returns a new, unused <a href="MockFunctionAPI.md">mock function</a>.
      Optionally takes a mock implementation.
    </p>
    <div class="sourceCode" id="cb17">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">const</span> mockFn <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="at">mockFn</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb17-3" title="3"><span class="at">expect</span>(mockFn).<span class="at">toHaveBeenCalled</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb17-4" title="4"></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="co">// With a mock implementation:</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="kw">const</span> returnsTrue <span class="op">=</span> <span class="va">jest</span>.<span class="at">fn</span>(() <span class="kw">=&gt;</span> <span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-7" title="7"><span class="va">console</span>.<span class="at">log</span>(<span class="at">returnsTrue</span>())<span class="op">;</span> <span class="co">// true;</span></a></code></pre>
    </div>
    <h3 id="jest.ismockfunctionfn"><code>jest.isMockFunction(fn)</code></h3>
    <p>Determines if the given function is a mocked function.</p>
    <h3 id="jest.spyonobject-methodname">
      <code>jest.spyOn(object, methodName)</code>
    </h3>
    <p>
      Creates a mock function similar to <code>jest.fn</code> but also tracks
      calls to <code>object[methodName]</code>. Returns a Jest mock function.
    </p>
    <p>
      <em
        >Note: By default, <code>jest.spyOn</code> also calls the
        <strong>spied</strong> method. This is different behavior from most
        other test libraries. If you want to overwrite the original function,
        you can use
        <code
          >jest.spyOn(object, methodName).mockImplementation(() =&gt;
          customImplementation)</code
        >
        or
        <code
          >object[methodName] = jest.fn(() =&gt; customImplementation);</code
        ></em
      >
    </p>
    <p>Example:</p>
    <div class="sourceCode" id="cb18">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">const</span> video <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="at">play</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb18-3" title="3">    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="op">},</span></a>
<a class="sourceLine" id="cb18-5" title="5"><span class="op">};</span></a>
<a class="sourceLine" id="cb18-6" title="6"></a>
<a class="sourceLine" id="cb18-7" title="7"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> video<span class="op">;</span></a></code></pre>
    </div>
    <p>Example test:</p>
    <div class="sourceCode" id="cb19">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">const</span> video <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./video&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-2" title="2"></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="at">test</span>(<span class="st">&#39;plays video&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb19-4" title="4">  <span class="kw">const</span> spy <span class="op">=</span> <span class="va">jest</span>.<span class="at">spyOn</span>(video<span class="op">,</span> <span class="st">&#39;play&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-5" title="5">  <span class="kw">const</span> isPlaying <span class="op">=</span> <span class="va">video</span>.<span class="at">play</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb19-6" title="6"></a>
<a class="sourceLine" id="cb19-7" title="7">  <span class="at">expect</span>(spy).<span class="at">toHaveBeenCalled</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb19-8" title="8">  <span class="at">expect</span>(isPlaying).<span class="at">toBe</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-9" title="9"></a>
<a class="sourceLine" id="cb19-10" title="10">  <span class="va">spy</span>.<span class="at">mockRestore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb19-11" title="11"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h3 id="jest.spyonobject-methodname-accesstype">
      <code>jest.spyOn(object, methodName, accessType?)</code>
    </h3>
    <p>
      Since Jest 22.1.0+, the <code>jest.spyOn</code> method takes an optional
      third argument of <code>accessType</code> that can be either
      <code>'get'</code> or <code>'set'</code>, which proves to be useful when
      you want to spy on a getter or a setter, respectively.
    </p>
    <p>Example:</p>
    <div class="sourceCode" id="cb20">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">const</span> video <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="co">// it&#39;s a getter!</span></a>
<a class="sourceLine" id="cb20-3" title="3">  get <span class="at">play</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb20-4" title="4">    <span class="cf">return</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="op">},</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> video<span class="op">;</span></a>
<a class="sourceLine" id="cb20-9" title="9"></a>
<a class="sourceLine" id="cb20-10" title="10"><span class="kw">const</span> audio <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-11" title="11">  <span class="dt">_volume</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb20-12" title="12">  <span class="co">// it&#39;s a setter!</span></a>
<a class="sourceLine" id="cb20-13" title="13">  set <span class="at">volume</span>(value) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-14" title="14">    <span class="kw">this</span>.<span class="at">_volume</span> <span class="op">=</span> value<span class="op">;</span></a>
<a class="sourceLine" id="cb20-15" title="15">  <span class="op">},</span></a>
<a class="sourceLine" id="cb20-16" title="16">  get <span class="at">volume</span>() <span class="op">{</span></a>
<a class="sourceLine" id="cb20-17" title="17">    <span class="cf">return</span> <span class="kw">this</span>.<span class="at">_volume</span><span class="op">;</span></a>
<a class="sourceLine" id="cb20-18" title="18">  <span class="op">},</span></a>
<a class="sourceLine" id="cb20-19" title="19"><span class="op">};</span></a>
<a class="sourceLine" id="cb20-20" title="20"></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> audio<span class="op">;</span></a></code></pre>
    </div>
    <p>Example test:</p>
    <div class="sourceCode" id="cb21">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">const</span> video <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./video&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="at">test</span>(<span class="st">&#39;plays video&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-4" title="4">  <span class="kw">const</span> spy <span class="op">=</span> <span class="va">jest</span>.<span class="at">spyOn</span>(video<span class="op">,</span> <span class="st">&#39;play&#39;</span><span class="op">,</span> <span class="st">&#39;get&#39;</span>)<span class="op">;</span> <span class="co">// we pass &#39;get&#39;</span></a>
<a class="sourceLine" id="cb21-5" title="5">  <span class="kw">const</span> isPlaying <span class="op">=</span> <span class="va">video</span>.<span class="at">play</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-6" title="6"></a>
<a class="sourceLine" id="cb21-7" title="7">  <span class="at">expect</span>(spy).<span class="at">toHaveBeenCalled</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb21-8" title="8">  <span class="at">expect</span>(isPlaying).<span class="at">toBe</span>(<span class="kw">true</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-9" title="9"></a>
<a class="sourceLine" id="cb21-10" title="10">  <span class="va">spy</span>.<span class="at">mockRestore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb21-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-12" title="12"></a>
<a class="sourceLine" id="cb21-13" title="13"><span class="kw">const</span> audio <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./audio&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-14" title="14"></a>
<a class="sourceLine" id="cb21-15" title="15"><span class="at">test</span>(<span class="st">&#39;plays audio&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-16" title="16">  <span class="kw">const</span> spy <span class="op">=</span> <span class="va">jest</span>.<span class="at">spyOn</span>(audio<span class="op">,</span> <span class="st">&#39;volume&#39;</span><span class="op">,</span> <span class="st">&#39;set&#39;</span>)<span class="op">;</span> <span class="co">// we pass &#39;set&#39;</span></a>
<a class="sourceLine" id="cb21-17" title="17">  <span class="va">audio</span>.<span class="at">volume</span> <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></a>
<a class="sourceLine" id="cb21-18" title="18"></a>
<a class="sourceLine" id="cb21-19" title="19">  <span class="at">expect</span>(spy).<span class="at">toHaveBeenCalled</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb21-20" title="20">  <span class="at">expect</span>(<span class="va">audio</span>.<span class="at">volume</span>).<span class="at">toBe</span>(<span class="dv">100</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-21" title="21"></a>
<a class="sourceLine" id="cb21-22" title="22">  <span class="va">spy</span>.<span class="at">mockRestore</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb21-23" title="23"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <h3 id="jest.clearallmocks"><code>jest.clearAllMocks()</code></h3>
    <p>
      Clears the <code>mock.calls</code> and
      <code>mock.instances</code> properties of all mocks. Equivalent to calling
      <a href="MockFunctionAPI.md#mockfnmockclear"><code>.mockClear()</code></a>
      on every mocked function.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.resetallmocks"><code>jest.resetAllMocks()</code></h3>
    <p>
      Resets the state of all mocks. Equivalent to calling
      <a href="MockFunctionAPI.md#mockfnmockreset"><code>.mockReset()</code></a>
      on every mocked function.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.restoreallmocks"><code>jest.restoreAllMocks()</code></h3>
    <p>
      Restores all mocks back to their original value. Equivalent to calling
      <a href="MockFunctionAPI.md#mockfnmockrestore"
        ><code>.mockRestore()</code></a
      >
      on every mocked function. Beware that
      <code>jest.restoreAllMocks()</code> only works when mock was created with
      <code>jest.spyOn</code>; other mocks will require you to manually restore
      them.
    </p>
    <h2 id="mock-timers">Mock timers</h2>
    <h3 id="jest.usefaketimers"><code>jest.useFakeTimers()</code></h3>
    <p>
      Instructs Jest to use fake versions of the standard timer functions
      (<code>setTimeout</code>, <code>setInterval</code>,
      <code>clearTimeout</code>, <code>clearInterval</code>,
      <code>nextTick</code>, <code>setImmediate</code> and
      <code>clearImmediate</code>).
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.userealtimers"><code>jest.useRealTimers()</code></h3>
    <p>
      Instructs Jest to use the real versions of the standard timer functions.
    </p>
    <p>Returns the <code>jest</code> object for chaining.</p>
    <h3 id="jest.runallticks"><code>jest.runAllTicks()</code></h3>
    <p>
      Exhausts the <strong>micro</strong>-task queue (usually interfaced in node
      via <code>process.nextTick</code>).
    </p>
    <p>
      When this API is called, all pending micro-tasks that have been queued via
      <code>process.nextTick</code> will be executed. Additionally, if those
      micro-tasks themselves schedule new micro-tasks, those will be continually
      exhausted until there are no more micro-tasks remaining in the queue.
    </p>
    <h3 id="jest.runalltimers"><code>jest.runAllTimers()</code></h3>
    <p>
      Exhausts both the <strong>macro</strong>-task queue (i.e., all tasks
      queued by <code>setTimeout()</code>, <code>setInterval()</code>, and
      <code>setImmediate()</code>) and the <strong>micro</strong>-task queue
      (usually interfaced in node via <code>process.nextTick</code>).
    </p>
    <p>
      When this API is called, all pending macro-tasks and micro-tasks will be
      executed. If those tasks themselves schedule new tasks, those will be
      continually exhausted until there are no more tasks remaining in the
      queue.
    </p>
    <p>
      This is often useful for synchronously executing setTimeouts during a test
      in order to synchronously assert about some behavior that would only
      happen after the <code>setTimeout()</code> or
      <code>setInterval()</code> callbacks executed. See the
      <a href="TimerMocks.md">Timer mocks</a> doc for more information.
    </p>
    <h3 id="jest.runallimmediates"><code>jest.runAllImmediates()</code></h3>
    <p>Exhausts all tasks queued by <code>setImmediate()</code>.</p>
    <h3 id="jest.advancetimersbytimemstorun">
      <code>jest.advanceTimersByTime(msToRun)</code>
    </h3>
    <h5 id="renamed-in-jest-22.0.0">
      renamed in Jest <strong>22.0.0+</strong>
    </h5>
    <p>Also under the alias: <code>.runTimersToTime()</code></p>
    <p>
      Executes only the macro task queue (i.e. all tasks queued by
      <code>setTimeout()</code> or <code>setInterval()</code> and
      <code>setImmediate()</code>).
    </p>
    <p>
      When this API is called, all timers are advanced by
      <code>msToRun</code> milliseconds. All pending “macro-tasks” that have
      been queued via <code>setTimeout()</code> or <code>setInterval()</code>,
      and would be executed within this time frame will be executed.
      Additionally if those macro-tasks schedule new macro-tasks that would be
      executed within the same time frame, those will be executed until there
      are no more macro-tasks remaining in the queue, that should be run within
      <code>msToRun</code> milliseconds.
    </p>
    <h3 id="jest.runonlypendingtimers">
      <code>jest.runOnlyPendingTimers()</code>
    </h3>
    <p>
      Executes only the macro-tasks that are currently pending (i.e., only the
      tasks that have been queued by <code>setTimeout()</code> or
      <code>setInterval()</code> up to this point). If any of the currently
      pending macro-tasks schedule new macro-tasks, those new tasks will not be
      executed by this call.
    </p>
    <p>
      This is useful for scenarios such as one where the module being tested
      schedules a <code>setTimeout()</code> whose callback schedules another
      <code>setTimeout()</code> recursively (meaning the scheduling never
      stops). In these scenarios, it’s useful to be able to run forward in time
      by a single step at a time.
    </p>
    <h3 id="jest.clearalltimers"><code>jest.clearAllTimers()</code></h3>
    <p>Removes any pending timers from the timer system.</p>
    <p>
      This means, if any timers have been scheduled (but have not yet executed),
      they will be cleared and will never have the opportunity to execute in the
      future.
    </p>
    <h3 id="jest.gettimercount"><code>jest.getTimerCount()</code></h3>
    <p>Returns the number of fake timers still left to run.</p>
    <h2 id="misc">Misc</h2>
    <h3 id="jest.settimeouttimeout"><code>jest.setTimeout(timeout)</code></h3>
    <p>
      Set the default timeout interval for tests and before/after hooks in
      milliseconds.
    </p>
    <p>
      <em
        >Note: The default timeout interval is 5 seconds if this method is not
        called.</em
      >
    </p>
    <p>
      <em
        >Note: The method must be called after the test framework is installed
        in the environment and before the test runs. A good place to do this is
        in the <code>setupTestFrameworkScriptFile</code>.</em
      >
    </p>
    <p>Example:</p>
    <div class="sourceCode" id="cb22">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="va">jest</span>.<span class="at">setTimeout</span>(<span class="dv">1000</span>)<span class="op">;</span> <span class="co">// 1 second</span></a></code></pre>
    </div>
    <h3 id="jest.retrytimes"><code>jest.retryTimes()</code></h3>
    <p>
      Runs failed tests n-times until they pass or until the max number of
      retries is exhausted. This only works with
      <a
        href="https://github.com/facebook/jest/tree/master/packages/jest-circus"
        >jest-circus</a
      >!
    </p>
    <p>Example in a test:</p>
    <div class="sourceCode" id="cb23">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="va">jest</span>.<span class="at">retryTimes</span>(<span class="dv">3</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="at">test</span>(<span class="st">&#39;will fail&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-3" title="3">  <span class="at">expect</span>(<span class="kw">true</span>).<span class="at">toBe</span>(<span class="kw">false</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-4" title="4"><span class="op">}</span>)<span class="op">;</span></a></code></pre>
    </div>
    <p>Returns the <code>jest</code> object for chaining.</p>
  </body>
</html>
