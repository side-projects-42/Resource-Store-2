<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <meta charset="utf-8" />
    <meta name="generator" content="pandoc" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=yes"
    />
    <title>README</title>
    <style type="text/css">
      code {
        white-space: pre-wrap;
      }
      span.smallcaps {
        font-variant: small-caps;
      }
      span.underline {
        text-decoration: underline;
      }
      div.column {
        display: inline-block;
        vertical-align: top;
        width: 50%;
      }
    </style>
    <style type="text/css">
      a.sourceLine {
        display: inline-block;
        line-height: 1.25;
      }
      a.sourceLine {
        pointer-events: none;
        color: inherit;
        text-decoration: inherit;
      }
      a.sourceLine:empty {
        height: 1.2em;
      }
      .sourceCode {
        overflow: visible;
      }
      code.sourceCode {
        white-space: pre;
        position: relative;
      }
      div.sourceCode {
        margin: 1em 0;
      }
      pre.sourceCode {
        margin: 0;
      }
      @media screen {
        div.sourceCode {
          overflow: auto;
        }
      }
      @media print {
        code.sourceCode {
          white-space: pre-wrap;
        }
        a.sourceLine {
          text-indent: -1em;
          padding-left: 1em;
        }
      }
      pre.numberSource a.sourceLine {
        position: relative;
        left: -4em;
      }
      pre.numberSource a.sourceLine::before {
        content: attr(title);
        position: relative;
        left: -1em;
        text-align: right;
        vertical-align: baseline;
        border: none;
        pointer-events: all;
        display: inline-block;
        -webkit-touch-callout: none;
        -webkit-user-select: none;
        -khtml-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        padding: 0 4px;
        width: 4em;
        color: #aaaaaa;
      }
      pre.numberSource {
        margin-left: 3em;
        border-left: 1px solid #aaaaaa;
        padding-left: 4px;
      }
      div.sourceCode {
      }
      @media screen {
        a.sourceLine::before {
          text-decoration: underline;
        }
      }
      code span.al {
        color: #ff0000;
        font-weight: bold;
      } /* Alert */
      code span.an {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Annotation */
      code span.at {
        color: #7d9029;
      } /* Attribute */
      code span.bn {
        color: #40a070;
      } /* BaseN */
      code span.bu {
      } /* BuiltIn */
      code span.cf {
        color: #007020;
        font-weight: bold;
      } /* ControlFlow */
      code span.ch {
        color: #4070a0;
      } /* Char */
      code span.cn {
        color: #880000;
      } /* Constant */
      code span.co {
        color: #60a0b0;
        font-style: italic;
      } /* Comment */
      code span.cv {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* CommentVar */
      code span.do {
        color: #ba2121;
        font-style: italic;
      } /* Documentation */
      code span.dt {
        color: #902000;
      } /* DataType */
      code span.dv {
        color: #40a070;
      } /* DecVal */
      code span.er {
        color: #ff0000;
        font-weight: bold;
      } /* Error */
      code span.ex {
      } /* Extension */
      code span.fl {
        color: #40a070;
      } /* Float */
      code span.fu {
        color: #06287e;
      } /* Function */
      code span.im {
      } /* Import */
      code span.in {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Information */
      code span.kw {
        color: #007020;
        font-weight: bold;
      } /* Keyword */
      code span.op {
        color: #666666;
      } /* Operator */
      code span.ot {
        color: #007020;
      } /* Other */
      code span.pp {
        color: #bc7a00;
      } /* Preprocessor */
      code span.sc {
        color: #4070a0;
      } /* SpecialChar */
      code span.ss {
        color: #bb6688;
      } /* SpecialString */
      code span.st {
        color: #4070a0;
      } /* String */
      code span.va {
        color: #19177c;
      } /* Variable */
      code span.vs {
        color: #4070a0;
      } /* VerbatimString */
      code span.wa {
        color: #60a0b0;
        font-weight: bold;
        font-style: italic;
      } /* Warning */
    </style>
  </head>
  <body>
    <p>
      <a href="https://travis-ci.org/nzakas/cssurl"
        ><img
          src="https://travis-ci.org/nzakas/cssurl.png?branch=master"
          alt="Build Status"
      /></a>
    </p>
    <h1 id="css-url-utilities">CSS URL Utilities</h1>
    <p>
      There are many reasons why you would want to systematically replace URLs
      in CSS code: to convert them into data URIs, to point them to a CDN, to
      replace a filename with an auto-generated one, and so on. This utility
      helps by parsing out the URLs in a given string of CSS code and allowing
      you to replace them with any value you choose. The resulting CSS code is
      exactly the same as the original except that the URLs have been replaced
      according to your preferences.
    </p>
    <p>
      This library contains utilities to help manipulate and change CSS URLs.
    </p>
    <h2 id="css-url-rewriter">CSS URL Rewriter</h2>
    <p>
      The CSS URL rewriter uses a CSS tokenizer to safely find all CSS URLs.
      This makes any change completely safe because there is no reliance on
      regular expressions to pull URLs out of CSS.
    </p>
    <h3 id="usage">Usage</h3>
    <div class="sourceCode" id="cb1">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">var</span> URLRewriter <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;cssurl&quot;</span>).<span class="at">URLRewriter</span><span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">var</span> rewriter <span class="op">=</span> <span class="kw">new</span> <span class="at">URLRewriter</span>(<span class="kw">function</span> (url) <span class="op">{</span></a>
<a class="sourceLine" id="cb1-4" title="4">  <span class="co">// automatically append a query string with a unique value to bust caches</span></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="cf">return</span> url <span class="op">+</span> <span class="st">&quot;?v=&quot;</span> <span class="op">+</span> <span class="va">Date</span>.<span class="at">now</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">var</span> result <span class="op">=</span> <span class="va">rewriter</span>.<span class="at">rewrite</span>(cssCode)<span class="op">;</span></a></code></pre>
    </div>
    <p>
      As the CSS URL rewriter goes through the CSS code, it will call the
      function passed to the <code>CSSURLRewriter</code> constructor and pass in
      each URL that it finds. The <code>url</code> is the URL as found in the
      CSS code with any quotes and surrounding whitespace removed (it does
      <em>not</em> contain the <code>url()</code>). You can then inspect the
      URL, modify it however you want, and return the value you want to use in
      its place.
    </p>
    <h3 id="limitations">Limitations</h3>
    <p>
      The CSS URL Rewriter will only replace URLs represented as URL tokens,
      that means it must be in the form <code>url(foo.css)</code> and not just
      <code>"foo.css"</code>, as is allowed in some parts of CSS.
    </p>
    <h2 id="css-url-rewrite-stream">CSS URL Rewrite Stream</h2>
    <p>
      The CSS URL rewrite stream uses the URL rewriter inside of a stream so you
      can easily pipe code to and from.
    </p>
    <h3 id="usage-1">Usage</h3>
    <div class="sourceCode" id="cb2">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> URLRewriteStream <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;cssurl&quot;</span>).<span class="at">URLRewriteStream</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="va">fs</span>.<span class="at">createReadStream</span>(<span class="st">&quot;my.css&quot;</span>)</a>
<a class="sourceLine" id="cb2-4" title="4">  .<span class="at">pipe</span>(</a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="kw">new</span> <span class="at">URLRewriteStream</span>(<span class="kw">function</span> (url) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">      <span class="co">// automatically append a query string with a unique value to bust caches</span></a>
<a class="sourceLine" id="cb2-7" title="7">      <span class="cf">return</span> url <span class="op">+</span> <span class="st">&quot;?v=&quot;</span> <span class="op">+</span> <span class="va">Date</span>.<span class="at">now</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb2-9" title="9">  )</a>
<a class="sourceLine" id="cb2-10" title="10">  .<span class="at">pipe</span>(<span class="va">fs</span>.<span class="at">createWriteStream</span>(<span class="st">&quot;my-new.css&quot;</span>))<span class="op">;</span></a></code></pre>
    </div>
    <h2 id="css-url-translator">CSS URL Translator</h2>
    <p>
      The CSS URL translator is a utility that can translate CSS URLs relative
      to different CSS files. Sometimes you might want to move a CSS file, for
      example from <code>css/sprites/foo.css</code> to
      <code>css/sprites.css</code>. When you do that, any relative URLs in the
      CSS file will no longer be accurate. The CSS URL translator, when used in
      conjunction with the CSS URL rewriter, makes it easy to make these changes
      by automatically calculating the new URL path. It’s also smart enough not
      to translate any non-relative URLs.
    </p>
    <h3 id="usage-2">Usage</h3>
    <div class="sourceCode" id="cb3">
      <pre
        class="sourceCode js"
      ><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> URLTranslator <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;cssurl&quot;</span>).<span class="at">URLTranslator</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">var</span> translator <span class="op">=</span> <span class="kw">new</span> <span class="at">URLTranslator</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">var</span> result <span class="op">=</span> <span class="va">translator</span>.<span class="at">translate</span>(</a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="st">&quot;../../img/foo.png&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="st">&quot;css/sprites/foo.css&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="st">&quot;css/sprites.css&quot;</span></a>
<a class="sourceLine" id="cb3-8" title="8">)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-9" title="9"></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="va">console</span>.<span class="at">log</span>(result)<span class="op">;</span> <span class="co">// &quot;../img/foo.png&quot;</span></a></code></pre>
    </div>
    <h2 id="development">Development</h2>
    <p>In order to run tests, clone this repository and then run:</p>
    <pre><code>$ npm i
$ npm test</code></pre>
    <h2 id="copyright-and-license-bsd3">Copyright and License (BSD3)</h2>
    <p>Copyright 2014 Nicholas C. Zakas. All rights reserved.</p>
    <p>
      Redistribution and use in source and binary forms, with or without
      modification, are permitted provided that the following conditions are
      met:
    </p>
    <ol type="1">
      <li>
        <p>
          Redistributions of source code must retain the above copyright notice,
          this list of conditions and the following disclaimer.
        </p>
      </li>
      <li>
        <p>
          Redistributions in binary form must reproduce the above copyright
          notice, this list of conditions and the following disclaimer in the
          documentation and/or other materials provided with the distribution.
        </p>
      </li>
      <li>
        <p>
          Neither the name of the copyright holder nor the names of its
          contributors may be used to endorse or promote products derived from
          this software without specific prior written permission.
        </p>
      </li>
    </ol>
    <p>
      THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS “AS
      IS” AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
      THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
      PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR
      CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
      EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
      PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
      PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
      LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
      NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
      SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
    </p>
  </body>
</html>
