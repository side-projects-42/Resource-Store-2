---
path: "/projects/newrelic-experimental/newrelic-webpack-plugin"
date: "06/26/2020"
title: "New Relic Webpack Plugin"
---

import { Link } from 'gatsby';

# New Relic Webpack Plugin

An experimental plugin to allow New Relic's NodeJS Agent to work with webpack compiled **server side** javascript.  This plugin does not instrument any frontend javascript frameworks -- please see [New Relic's browser agent documentation](https://docs.newrelic.com/docs/browser/new-relic-browser/installation/install-new-relic-browser-agent) for more information on monitoring frontend javascript frameworks.

## Quick Start

Add the plugin to your project

```bash
    $ npm install @newrelic/webpack-plugin
```

and then add and `externals` and `plugins` section to your webpack configuration like this.

```javascript
    /*...*/

    const nodeExternals = require('@newrelic/webpack-plugin/lib/externals')
    const NewrelicWebpackPlugin = require('@newrelic/webpack-plugin/lib/NewrelicWebpackPlugin')

    module.exports = {
      /* ... */
      externals: [nodeExternals()],
      plugins: [
        new NewrelicWebpackPlugin()
      ]
      /* ... */
    }
```

## How This Works

In order to use Newrelic's NodeJS agent with webpack, you'll need to

1. Ensure the modules New Relic instruments are listed as webpack externals.
2. Add `require('newrelic')` to the top of your generated sources.

This package allows you to do both.  The `nodeExternals` function

```javascript
    const nodeExternals = require('newrelic-webpack-plugin/lib/externals')

    /* ... */

    module.exports = {
      /* ... */
      externals: [nodeExternals()],
      /* ... */
    }
```

is borrowed from [webpack-node-externals](https://www.npmjs.com/package/webpack-node-externals), which is the de-facto standard way to use webpack with NodeJS server side projects. If [a module the agent instruments](https://github.com/newrelic/node-newrelic/blob/master/lib/instrumentations.js#L6) is **not** listed as a webpack external, the agent will not function properly.

The `NewrelicWebpackPlugin`

```javascript
    const NewrelicWebpackPlugin = require('newrelic-webpack-plugin/lib/NewrelicWebpackPlugin')

    module.exports = {
      /* ... */
      plugins: [
        new NewrelicWebpackPlugin()
      ]
      /* ... */
    }
```

ensures that a `require('newrelic')` statment is added to the top of any `.js` asset file generated by webpack.
