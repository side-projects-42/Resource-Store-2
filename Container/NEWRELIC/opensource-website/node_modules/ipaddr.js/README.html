<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="ipaddr.js-an-ipv6-and-ipv4-address-manipulation-library-build-status">ipaddr.js — an IPv6 and IPv4 address manipulation library <a href="https://travis-ci.org/whitequark/ipaddr.js"><img src="https://travis-ci.org/whitequark/ipaddr.js.svg" alt="Build Status" /></a></h1>
<p>ipaddr.js is a small (1.9K minified and gzipped) library for manipulating IP addresses in JavaScript environments. It runs on both CommonJS runtimes (e.g. <a href="http://nodejs.org">nodejs</a>) and in a web browser.</p>
<p>ipaddr.js allows you to verify and parse string representation of an IP address, match it against a CIDR range or range list, determine if it falls into some reserved ranges (examples include loopback and private ranges), and convert between IPv4 and IPv4-mapped IPv6 addresses.</p>
<h2 id="installation">Installation</h2>
<p><code>npm install ipaddr.js</code></p>
<p>or</p>
<p><code>bower install ipaddr.js</code></p>
<h2 id="api">API</h2>
<p>ipaddr.js defines one object in the global scope: <code>ipaddr</code>. In CommonJS, it is exported from the module:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">var</span> ipaddr <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;ipaddr.js&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>The API consists of several global methods and two classes: ipaddr.IPv6 and ipaddr.IPv4.</p>
<h3 id="global-methods">Global methods</h3>
<p>There are three global methods defined: <code>ipaddr.isValid</code>, <code>ipaddr.parse</code> and <code>ipaddr.process</code>. All of them receive a string as a single parameter.</p>
<p>The <code>ipaddr.isValid</code> method returns <code>true</code> if the address is a valid IPv4 or IPv6 address, and <code>false</code> otherwise. It does not throw any exceptions.</p>
<p>The <code>ipaddr.parse</code> method returns an object representing the IP address, or throws an <code>Error</code> if the passed string is not a valid representation of an IP address.</p>
<p>The <code>ipaddr.process</code> method works just like the <code>ipaddr.parse</code> one, but it automatically converts IPv4-mapped IPv6 addresses to their IPv4 counterparts before returning. It is useful when you have a Node.js instance listening on an IPv6 socket, and the <code>net.ivp6.bindv6only</code> sysctl parameter (or its equivalent on non-Linux OS) is set to 0. In this case, you can accept IPv4 connections on your IPv6-only socket, but the remote address will be mangled. Use <code>ipaddr.process</code> method to automatically demangle it.</p>
<h3 id="object-representation">Object representation</h3>
<p>Parsing methods return an object which descends from <code>ipaddr.IPv6</code> or <code>ipaddr.IPv4</code>. These objects share some properties, but most of them differ.</p>
<h4 id="shared-properties">Shared properties</h4>
<p>One can determine the type of address by calling <code>addr.kind()</code>. It will return either <code>"ipv6"</code> or <code>"ipv4"</code>.</p>
<p>An address can be converted back to its string representation with <code>addr.toString()</code>. Note that this method: * does not return the original string used to create the object (in fact, there is no way of getting that string) * returns a compact representation (when it is applicable)</p>
<p>A <code>match(range, bits)</code> method can be used to check if the address falls into a certain CIDR range. Note that an address can be (obviously) matched only against an address of the same type.</p>
<p>For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8:1234::1&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">var</span> range <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8::&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="va">addr</span>.<span class="at">match</span>(range<span class="op">,</span> <span class="dv">32</span>)<span class="op">;</span> <span class="co">// =&gt; true</span></a></code></pre></div>
<p>Alternatively, <code>match</code> can also be called as <code>match([range, bits])</code>. In this way, it can be used together with the <code>parseCIDR(string)</code> method, which parses an IP address together with a CIDR range.</p>
<p>For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8:1234::1&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">addr</span>.<span class="at">match</span>(<span class="va">ipaddr</span>.<span class="at">parseCIDR</span>(<span class="st">&quot;2001:db8::/32&quot;</span>))<span class="op">;</span> <span class="co">// =&gt; true</span></a></code></pre></div>
<p>A <code>range()</code> method returns one of predefined names for several special ranges defined by IP protocols. The exact names (and their respective CIDR ranges) can be looked up in the source: <a href="https://github.com/whitequark/ipaddr.js/blob/master/src/ipaddr.coffee#L186">IPv6 ranges</a> and <a href="https://github.com/whitequark/ipaddr.js/blob/master/src/ipaddr.coffee#L71">IPv4 ranges</a>. Some common ones include <code>"unicast"</code> (the default one) and <code>"reserved"</code>.</p>
<p>You can match against your own range list by using <code>ipaddr.subnetMatch(address, rangeList, defaultName)</code> method. It can work with a mix of IPv6 or IPv4 addresses, and accepts a name-to-subnet map as the range list. For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> rangeList <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">documentationOnly</span><span class="op">:</span> [ <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&#39;2001:db8::&#39;</span>)<span class="op">,</span> <span class="dv">32</span> ]<span class="op">,</span></a>
<a class="sourceLine" id="cb4-3" title="3">  <span class="dt">tunnelProviders</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb4-4" title="4">    [ <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&#39;2001:470::&#39;</span>)<span class="op">,</span> <span class="dv">32</span> ]<span class="op">,</span> <span class="co">// he.net</span></a>
<a class="sourceLine" id="cb4-5" title="5">    [ <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&#39;2001:5c0::&#39;</span>)<span class="op">,</span> <span class="dv">32</span> ]  <span class="co">// freenet6</span></a>
<a class="sourceLine" id="cb4-6" title="6">  ]</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="op">};</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="va">ipaddr</span>.<span class="at">subnetMatch</span>(<span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&#39;2001:470:8:66::1&#39;</span>)<span class="op">,</span> rangeList<span class="op">,</span> <span class="st">&#39;unknown&#39;</span>)<span class="op">;</span> <span class="co">// =&gt; &quot;tunnelProviders&quot;</span></a></code></pre></div>
<p>The addresses can be converted to their byte representation with <code>toByteArray()</code>. (Actually, JavaScript mostly does not know about byte buffers. They are emulated with arrays of numbers, each in range of 0..255.)</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> bytes <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&#39;2a00:1450:8007::68&#39;</span>).<span class="at">toByteArray</span>()<span class="op">;</span> <span class="co">// ipv6.google.com</span></a>
<a class="sourceLine" id="cb5-2" title="2">bytes <span class="co">// =&gt; [42, 0x00, 0x14, 0x50, 0x80, 0x07, 0x00, &lt;zeroes...&gt;, 0x00, 0x68 ]</span></a></code></pre></div>
<p>The <code>ipaddr.IPv4</code> and <code>ipaddr.IPv6</code> objects have some methods defined, too. All of them have the same interface for both protocols, and are similar to global methods.</p>
<p><code>ipaddr.IPvX.isValid(string)</code> can be used to check if the string is a valid address for particular protocol, and <code>ipaddr.IPvX.parse(string)</code> is the error-throwing parser.</p>
<p><code>ipaddr.IPvX.isValid(string)</code> uses the same format for parsing as the POSIX <code>inet_ntoa</code> function, which accepts unusual formats like <code>0xc0.168.1.1</code> or <code>0x10000000</code>. The function <code>ipaddr.IPv4.isValidFourPartDecimal(string)</code> validates the IPv4 address and also ensures that it is written in four-part decimal format.</p>
<h4 id="ipv6-properties">IPv6 properties</h4>
<p>Sometimes you will want to convert IPv6 not to a compact string representation (with the <code>::</code> substitution); the <code>toNormalizedString()</code> method will return an address where all zeroes are explicit.</p>
<p>For example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:0db8::0001&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="va">addr</span>.<span class="at">toString</span>()<span class="op">;</span> <span class="co">// =&gt; &quot;2001:db8::1&quot;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="va">addr</span>.<span class="at">toNormalizedString</span>()<span class="op">;</span> <span class="co">// =&gt; &quot;2001:db8:0:0:0:0:0:1&quot;</span></a></code></pre></div>
<p>The <code>isIPv4MappedAddress()</code> method will return <code>true</code> if this address is an IPv4-mapped one, and <code>toIPv4Address()</code> will return an IPv4 object address.</p>
<p>To access the underlying binary representation of the address, use <code>addr.parts</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8:10::1234:DEAD&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="va">addr</span>.<span class="at">parts</span> <span class="co">// =&gt; [0x2001, 0xdb8, 0x10, 0, 0, 0, 0x1234, 0xdead]</span></a></code></pre></div>
<p>A IPv6 zone index can be accessed via <code>addr.zoneId</code>:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8::%eth0&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="va">addr</span>.<span class="at">zoneId</span> <span class="co">// =&gt; &#39;eth0&#39;</span></a></code></pre></div>
<h4 id="ipv4-properties">IPv4 properties</h4>
<p><code>toIPv4MappedAddress()</code> will return a corresponding IPv4-mapped IPv6 address.</p>
<p>To access the underlying representation of the address, use <code>addr.octets</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;192.168.1.1&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="va">addr</span>.<span class="at">octets</span> <span class="co">// =&gt; [192, 168, 1, 1]</span></a></code></pre></div>
<p><code>prefixLengthFromSubnetMask()</code> will return a CIDR prefix length for a valid IPv4 netmask or null if the netmask is not valid.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">parse</span>(<span class="st">&#39;255.255.255.240&#39;</span>).<span class="at">prefixLengthFromSubnetMask</span>() <span class="op">==</span> <span class="dv">28</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">parse</span>(<span class="st">&#39;255.192.164.0&#39;</span>).<span class="at">prefixLengthFromSubnetMask</span>()  <span class="op">==</span> <span class="kw">null</span></a></code></pre></div>
<p><code>subnetMaskFromPrefixLength()</code> will return an IPv4 netmask for a valid CIDR prefix length.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">subnetMaskFromPrefixLength</span>(<span class="dv">24</span>) <span class="op">==</span> <span class="st">&quot;255.255.255.0&quot;</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">subnetMaskFromPrefixLength</span>(<span class="dv">29</span>) <span class="op">==</span> <span class="st">&quot;255.255.255.248&quot;</span></a></code></pre></div>
<p><code>broadcastAddressFromCIDR()</code> will return the broadcast address for a given IPv4 interface and netmask in CIDR notation.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">broadcastAddressFromCIDR</span>(<span class="st">&quot;172.0.0.1/24&quot;</span>) <span class="op">==</span> <span class="st">&quot;172.0.0.255&quot;</span></a></code></pre></div>
<p><code>networkAddressFromCIDR()</code> will return the network address for a given IPv4 interface and netmask in CIDR notation.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="va">ipaddr</span>.<span class="va">IPv4</span>.<span class="at">networkAddressFromCIDR</span>(<span class="st">&quot;172.0.0.1/24&quot;</span>) <span class="op">==</span> <span class="st">&quot;172.0.0.0&quot;</span></a></code></pre></div>
<h4 id="conversion">Conversion</h4>
<p>IPv4 and IPv6 can be converted bidirectionally to and from network byte order (MSB) byte arrays.</p>
<p>The <code>fromByteArray()</code> method will take an array and create an appropriate IPv4 or IPv6 object if the input satisfies the requirements. For IPv4 it has to be an array of four 8-bit values, while for IPv6 it has to be an array of sixteen 8-bit values.</p>
<p>For example:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">fromByteArray</span>([<span class="bn">0x7f</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])<span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="va">addr</span>.<span class="at">toString</span>()<span class="op">;</span> <span class="co">// =&gt; &quot;127.0.0.1&quot;</span></a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">fromByteArray</span>([<span class="bn">0x20</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="bn">0xd</span><span class="op">,</span> <span class="bn">0xb8</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">1</span>])</a>
<a class="sourceLine" id="cb15-2" title="2"><span class="va">addr</span>.<span class="at">toString</span>()<span class="op">;</span> <span class="co">// =&gt; &quot;2001:db8::1&quot;</span></a></code></pre></div>
<p>Both objects also offer a <code>toByteArray()</code> method, which returns an array in network byte order (MSB).</p>
<p>For example:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;127.0.0.1&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-2" title="2"><span class="va">addr</span>.<span class="at">toByteArray</span>()<span class="op">;</span> <span class="co">// =&gt; [0x7f, 0, 0, 1]</span></a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">var</span> addr <span class="op">=</span> <span class="va">ipaddr</span>.<span class="at">parse</span>(<span class="st">&quot;2001:db8::1&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="va">addr</span>.<span class="at">toByteArray</span>()<span class="op">;</span> <span class="co">// =&gt; [0x20, 1, 0xd, 0xb8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]</span></a></code></pre></div>
</body>
</html>
