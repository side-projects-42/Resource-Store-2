<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="gatsby-plugin-sitemap">gatsby-plugin-sitemap</h1>
<p>Create a sitemap for your Gatsby site.</p>
<p><em>NOTE: This plugin only generates output when run in <code>production</code> mode! To test your sitemap, run: <code>gatsby build &amp;&amp; gatsby serve</code></em></p>
<h2 id="install">Install</h2>
<p><code>npm install gatsby-plugin-sitemap</code></p>
<h2 id="how-to-use">How to Use</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// In your gatsby-config.js</span></a>
<a class="sourceLine" id="cb1-2" title="2">siteMetadata<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">siteUrl</span><span class="op">:</span> <span class="vs">`https://www.example.com`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="op">},</span></a>
<a class="sourceLine" id="cb1-5" title="5">plugins<span class="op">:</span> [<span class="vs">`gatsby-plugin-sitemap`</span>]</a></code></pre></div>
<p>Above is the minimal configuration required to have it work. By default, the generated sitemap will include all of your site’s pages, except the ones you exclude.</p>
<h2 id="recommended-usage">Recommended usage</h2>
<p>You probably do not want to use the defaults in this plugin. Here’s an example of the default output:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode xml"><code class="sourceCode xml"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">&lt;?xml</span> version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;<span class="kw">?&gt;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">&lt;urlset</span><span class="ot"> xmlns=</span><span class="st">&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;</span><span class="kw">&gt;</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="kw">&lt;url&gt;</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">&lt;loc&gt;</span>https://example.net/blog/<span class="kw">&lt;/loc&gt;</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="kw">&lt;changefreq&gt;</span>daily<span class="kw">&lt;/changefreq&gt;</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="kw">&lt;priority&gt;</span>0.7<span class="kw">&lt;/priority&gt;</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="kw">&lt;/url&gt;</span></a>
<a class="sourceLine" id="cb2-8" title="8">  <span class="kw">&lt;url&gt;</span></a>
<a class="sourceLine" id="cb2-9" title="9">    <span class="kw">&lt;loc&gt;</span>https://example.net/<span class="kw">&lt;/loc&gt;</span></a>
<a class="sourceLine" id="cb2-10" title="10">    <span class="kw">&lt;changefreq&gt;</span>daily<span class="kw">&lt;/changefreq&gt;</span></a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="kw">&lt;priority&gt;</span>0.7<span class="kw">&lt;/priority&gt;</span></a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="kw">&lt;/url&gt;</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="kw">&lt;/urlset&gt;</span></a></code></pre></div>
<p>See the <code>changefreq</code> and <code>priority</code> fields? Those will be the same for every page, no matter how important or how often it gets updated. They will most likely be wrong. But wait, there’s more, in their <a href="https://support.google.com/webmasters/answer/183668?hl=en">docs</a> Google says:</p>
<blockquote>
<ul>
<li>Google ignores <code>&lt;priority&gt;</code> and <code>&lt;changefreq&gt;</code> values, so don’t bother adding them.</li>
<li>Google reads the <code>&lt;lastmod&gt;</code> value, but if you misrepresent this value, we will stop reading it.</li>
</ul>
</blockquote>
<p>You really want to customize this plugin config to include an accurate <code>lastmod</code> date. Checkout the <a href="#example">example</a> for an example of how to do this.</p>
<h2 id="options">Options</h2>
<p>The <a href="https://github.com/gatsbyjs/gatsby/blob/master/packages/gatsby-plugin-sitemap/src/options-validation.js"><code>default config</code></a> can be overridden.</p>
<p>The options are as follows:</p>
<ul>
<li><code>output</code> (string = <code>/sitemap</code>) Folder path where sitemaps are stored.</li>
<li><code>createLinkInHead</code> (boolean = true) Whether to populate the <code>&lt;head&gt;</code> of your site with a link to the sitemap.</li>
<li><code>entryLimit</code> (number = 45000) Number of entries per sitemap file, a sitemap index and multiple sitemaps are created if you have more entries.</li>
<li><code>excludes</code> (string[] = []) An array of paths to exclude from the sitemap. While this is usually an array of strings it is possible to enter other data types into this array for custom filtering. Doing so will require customization of the <a href="#filterPages"><code>filterPages</code></a> function.</li>
<li><code>query</code> (GraphQL Query) The query for the data you need to generate the sitemap. It’s required to get the site’s URL, if you are not fetching it from <code>site.siteMetadata.siteUrl</code>, you will need to set a custom <a href="#resolveSiteUrl"><code>resolveSiteUrl</code></a> function. If you override the query, you may need to pass in a custom <a href="#resolvePagePath"><code>resolvePagePath</code></a>, <a href="#resolvePages"><code>resolvePages</code></a> to keep everything working. If you fetch pages without using <code>allSitePage.nodes</code> query structure you will definitely need to customize the <a href="#resolvePages"><code>resolvePages</code></a> function.</li>
<li><a href="#resolveSiteUrl"><code>resolveSiteUrl</code></a> (function) Takes the output of the data query and lets you return the site URL. Sync or async functions allowed.</li>
<li><a href="#resolvePagePath"><code>resolvePagePath</code></a> (function) Takes a page object and returns the uri of the page (no domain or protocol).</li>
<li><a href="#resolvePagePath"><code>resolvePages</code></a> (function) Takes the output of the data query and expects an array of page objects to be returned. Sync or async functions allowed.</li>
<li><a href="#filterPages"><code>filterPages</code></a> (function) Takes the current page a string (or other object) from the <code>exclude</code> array and expects a boolean to be returned. <code>true</code> excludes the path, <code>false</code> keeps it.</li>
<li><a href="#serialize"><code>serialize</code></a> (function) Takes the output of <code>filterPages</code> and lets you return a sitemap entry. Sync or async functions allowed.</li>
</ul>
<p>The following pages are <strong>always</strong> excluded: <code>/dev-404-page</code>,<code>/404</code> &amp;<code>/offline-plugin-app-shell-fallback</code>, this cannot be changed even by customizing the <a href="#filterPages"><code>filterPages</code></a> function.</p>
<h2 id="example">Example:</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> siteUrl <span class="op">=</span> <span class="va">process</span>.<span class="va">env</span>.<span class="at">URL</span> <span class="op">||</span> <span class="vs">`https://fallback.net`</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">// In your gatsby-config.js</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-5" title="5">  <span class="dt">plugins</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="op">{</span></a>
<a class="sourceLine" id="cb3-7" title="7">      <span class="dt">resolve</span><span class="op">:</span> <span class="st">&quot;gatsby-plugin-sitemap&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-8" title="8">      <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-9" title="9">        <span class="dt">query</span><span class="op">:</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="vs">        {</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="vs">          allSitePage {</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="vs">            nodes {</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="vs">              path</span></a>
<a class="sourceLine" id="cb3-14" title="14"><span class="vs">            }</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="vs">          }</span></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="vs">          allWpContentNode(filter: {nodeType: {in: [&quot;Post&quot;, &quot;Page&quot;]}}) {</span></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="vs">            nodes {</span></a>
<a class="sourceLine" id="cb3-18" title="18"><span class="vs">              ... on WpPost {</span></a>
<a class="sourceLine" id="cb3-19" title="19"><span class="vs">                uri</span></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="vs">                modifiedGmt</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="vs">              }</span></a>
<a class="sourceLine" id="cb3-22" title="22"><span class="vs">              ... on WpPage {</span></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="vs">                uri</span></a>
<a class="sourceLine" id="cb3-24" title="24"><span class="vs">                modifiedGmt</span></a>
<a class="sourceLine" id="cb3-25" title="25"><span class="vs">              }</span></a>
<a class="sourceLine" id="cb3-26" title="26"><span class="vs">            }</span></a>
<a class="sourceLine" id="cb3-27" title="27"><span class="vs">          }</span></a>
<a class="sourceLine" id="cb3-28" title="28"><span class="vs">        }</span></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="vs">      `</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-30" title="30">        <span class="dt">resolveSiteUrl</span><span class="op">:</span> () <span class="kw">=&gt;</span> siteUrl<span class="op">,</span></a>
<a class="sourceLine" id="cb3-31" title="31">        <span class="dt">resolvePages</span><span class="op">:</span> (<span class="op">{</span></a>
<a class="sourceLine" id="cb3-32" title="32">          <span class="dt">allSitePage</span><span class="op">:</span> <span class="op">{</span> <span class="dt">nodes</span><span class="op">:</span> allPages <span class="op">},</span></a>
<a class="sourceLine" id="cb3-33" title="33">          <span class="dt">allWpContentNode</span><span class="op">:</span> <span class="op">{</span> <span class="dt">nodes</span><span class="op">:</span> allWpNodes <span class="op">},</span></a>
<a class="sourceLine" id="cb3-34" title="34">        <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-35" title="35">          <span class="kw">const</span> wpNodeMap <span class="op">=</span> <span class="va">allWpNodes</span>.<span class="at">reduce</span>((acc<span class="op">,</span> node) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-36" title="36">            <span class="kw">const</span> <span class="op">{</span> uri <span class="op">}</span> <span class="op">=</span> node</a>
<a class="sourceLine" id="cb3-37" title="37">            acc[uri] <span class="op">=</span> node</a>
<a class="sourceLine" id="cb3-38" title="38"></a>
<a class="sourceLine" id="cb3-39" title="39">            <span class="cf">return</span> acc</a>
<a class="sourceLine" id="cb3-40" title="40">          <span class="op">},</span> <span class="op">{}</span>)</a>
<a class="sourceLine" id="cb3-41" title="41"></a>
<a class="sourceLine" id="cb3-42" title="42">          <span class="cf">return</span> <span class="va">allPages</span>.<span class="at">map</span>(page <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-43" title="43">            <span class="cf">return</span> <span class="op">{</span> ...<span class="at">page</span><span class="op">,</span> ...<span class="at">wpNodeMap</span>[<span class="va">page</span>.<span class="at">path</span>] <span class="op">}</span></a>
<a class="sourceLine" id="cb3-44" title="44">          <span class="op">}</span>)</a>
<a class="sourceLine" id="cb3-45" title="45">        <span class="op">},</span></a>
<a class="sourceLine" id="cb3-46" title="46">        <span class="dt">serialize</span><span class="op">:</span> (<span class="op">{</span> path<span class="op">,</span> modifiedGmt <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-47" title="47">          <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-48" title="48">            <span class="dt">url</span><span class="op">:</span> path<span class="op">,</span></a>
<a class="sourceLine" id="cb3-49" title="49">            <span class="dt">lastmod</span><span class="op">:</span> modifiedGmt<span class="op">,</span></a>
<a class="sourceLine" id="cb3-50" title="50">          <span class="op">}</span></a>
<a class="sourceLine" id="cb3-51" title="51">        <span class="op">},</span></a>
<a class="sourceLine" id="cb3-52" title="52">      <span class="op">},</span></a>
<a class="sourceLine" id="cb3-53" title="53">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-54" title="54">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="op">}</span></a></code></pre></div>
<h2 id="api-reference">API Reference</h2>
<p><a id=resolveSiteUrl></a></p>
<h2 id="resolvesiteurl-string">resolveSiteUrl ⇒ <code>string</code></h2>
<p>Sync or async functions allowed.</p>
<p><strong>Returns</strong>: <code>string</code> - - site URL, this can come from the graphql query or another scope.</p>
<table>
<thead>
<tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>data</td>
<td><code>object</code></td>
<td>Results of the GraphQL query</td>
</tr>
</tbody>
</table>
<p><a id=resolvePagePath></a></p>
<h2 id="resolvepagepath-string">resolvePagePath ⇒ <code>string</code></h2>
<p>If you don’t want to place the URI in <code>path</code> then <code>resolvePagePath</code> is needed.</p>
<p><strong>Returns</strong>: <code>string</code> - - uri of the page without domain or protocol</p>
<table>
<thead>
<tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>page</td>
<td><code>object</code></td>
<td><code>string</code></td>
</tr>
</tbody>
</table>
<p><a id=resolvePages></a></p>
<h2 id="resolvepages-array">resolvePages ⇒ <code>Array</code></h2>
<p>This allows custom resolution of the array of pages. This also where users could merge multiple sources into a single array if needed. Sync or async functions allowed.</p>
<p><strong>Returns</strong>: <code>object[]</code> - - Array of objects representing each page</p>
<table>
<thead>
<tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>data</td>
<td><code>object</code></td>
<td>results of the GraphQL query</td>
</tr>
</tbody>
</table>
<p><a id="filterPages"></a></p>
<h2 id="filterpages-boolean">filterPages ⇒ <code>boolean</code></h2>
<p>This allows filtering any data in any way.</p>
<p>This function is executed via:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="va">allPages</span>.<span class="at">filter</span>(</a>
<a class="sourceLine" id="cb4-2" title="2">  page <span class="kw">=&gt;</span> <span class="op">!</span><span class="va">excludes</span>.<span class="at">some</span>(excludedRoute <span class="kw">=&gt;</span> <span class="at">thisFunc</span>(page<span class="op">,</span> excludedRoute<span class="op">,</span> tools))</a>
<a class="sourceLine" id="cb4-3" title="3">)</a></code></pre></div>
<p><code>allPages</code> is the results of the <a href="#resolvePages"><code>resolvePages</code></a> function.</p>
<p><strong>Returns</strong>: <code>Boolean</code> - - <code>true</code> excludes the path, <code>false</code> keeps it.</p>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 16%" />
<col style="width: 72%" />
</colgroup>
<thead>
<tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>page</td>
<td><code>object</code></td>
<td></td>
</tr>
<tr class="even">
<td>excludedRoute</td>
<td><code>string</code></td>
<td>Element from <code>exclude</code> Array in plugin config.</td>
</tr>
<tr class="odd">
<td>tools</td>
<td><code>object</code></td>
<td>contains tools for filtering <code>{ minimatch, withoutTrailingSlash, resolvePagePath }</code></td>
</tr>
</tbody>
</table>
<p><a id="serialize"></a></p>
<h2 id="serialize-object">serialize ⇒ <code>object</code></h2>
<p>This function is executed by:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="va">allPages</span>.<span class="at">map</span>(page <span class="kw">=&gt;</span> <span class="at">thisFunc</span>(page<span class="op">,</span> tools))</a></code></pre></div>
<p><code>allpages</code> is the result of the <a href="#filterPages"><code>filterPages</code></a> function. Sync or async functions allowed.</p>
<p><strong>Kind</strong>: global variable</p>
<table>
<thead>
<tr class="header">
<th>Param</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>page</td>
<td><code>object</code></td>
<td>A single element from the results of the <code>resolvePages</code> function</td>
</tr>
<tr class="even">
<td>tools</td>
<td><code>object</code></td>
<td>contains tools for serializing <code>{ resolvePagePath }</code></td>
</tr>
</tbody>
</table>
</body>
</html>
