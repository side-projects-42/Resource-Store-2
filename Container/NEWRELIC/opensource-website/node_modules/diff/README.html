<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="jsdiff">jsdiff</h1>
<p><a href="http://travis-ci.org/kpdecker/jsdiff"><img src="https://secure.travis-ci.org/kpdecker/jsdiff.svg" alt="Build Status" /></a> <a href="https://saucelabs.com/u/jsdiff"><img src="https://saucelabs.com/buildstatus/jsdiff" alt="Sauce Test Status" /></a></p>
<p>A javascript text differencing implementation.</p>
<p>Based on the algorithm proposed in <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.4.6927">“An O(ND) Difference Algorithm and its Variations” (Myers, 1986)</a>.</p>
<h2 id="installation">Installation</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install diff --save</a></code></pre></div>
<h2 id="api">API</h2>
<ul>
<li><p><code>JsDiff.diffChars(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing character by character.</p>
<p>Returns a list of change objects (See below).</p>
Options
<ul>
<li><code>ignoreCase</code>: <code>true</code> to ignore casing difference. Defaults to <code>false</code>.</li>
</ul></li>
<li><p><code>JsDiff.diffWords(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing word by word, ignoring whitespace.</p>
<p>Returns a list of change objects (See below).</p>
Options
<ul>
<li><code>ignoreCase</code>: Same as in <code>diffChars</code>.</li>
</ul></li>
<li><p><code>JsDiff.diffWordsWithSpace(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing word by word, treating whitespace as significant.</p>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffLines(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing line by line.</p>
Options
<ul>
<li><code>ignoreWhitespace</code>: <code>true</code> to ignore leading and trailing whitespace. This is the same as <code>diffTrimmedLines</code></li>
<li><code>newlineIsToken</code>: <code>true</code> to treat newline characters as separate tokens. This allows for changes to the newline structure to occur independently of the line content and to be treated as such. In general this is the more human friendly form of <code>diffLines</code> and <code>diffLines</code> is better suited for patches and other computer friendly output.</li>
</ul>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffTrimmedLines(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing line by line, ignoring leading and trailing whitespace.</p>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffSentences(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing sentence by sentence.</p>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffCss(oldStr, newStr[, options])</code> - diffs two blocks of text, comparing CSS tokens.</p>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffJson(oldObj, newObj[, options])</code> - diffs two JSON objects, comparing the fields defined on each. The order of fields, etc does not matter in this comparison.</p>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.diffArrays(oldArr, newArr[, options])</code> - diffs two arrays, comparing each item for strict equality (===).</p>
Options
<ul>
<li><code>comparator</code>: <code>function(left, right)</code> for custom equality checks</li>
</ul>
<p>Returns a list of change objects (See below).</p></li>
<li><p><code>JsDiff.createTwoFilesPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader)</code> - creates a unified diff patch.</p>
Parameters:
<ul>
<li><code>oldFileName</code> : String to be output in the filename section of the patch for the removals</li>
<li><code>newFileName</code> : String to be output in the filename section of the patch for the additions</li>
<li><code>oldStr</code> : Original string value</li>
<li><code>newStr</code> : New string value</li>
<li><code>oldHeader</code> : Additional information to include in the old file header</li>
<li><code>newHeader</code> : Additional information to include in the new file header</li>
<li><code>options</code> : An object with options. Currently, only <code>context</code> is supported and describes how many lines of context should be included.</li>
</ul></li>
<li><p><code>JsDiff.createPatch(fileName, oldStr, newStr, oldHeader, newHeader)</code> - creates a unified diff patch.</p>
<p>Just like JsDiff.createTwoFilesPatch, but with oldFileName being equal to newFileName.</p></li>
<li><p><code>JsDiff.structuredPatch(oldFileName, newFileName, oldStr, newStr, oldHeader, newHeader, options)</code> - returns an object with an array of hunk objects.</p>
<p>This method is similar to createTwoFilesPatch, but returns a data structure suitable for further processing. Parameters are the same as createTwoFilesPatch. The data structure returned may look like this:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="dt">oldFileName</span><span class="op">:</span> <span class="st">&#39;oldfile&#39;</span><span class="op">,</span> <span class="dt">newFileName</span><span class="op">:</span> <span class="st">&#39;newfile&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="dt">oldHeader</span><span class="op">:</span> <span class="st">&#39;header1&#39;</span><span class="op">,</span> <span class="dt">newHeader</span><span class="op">:</span> <span class="st">&#39;header2&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">hunks</span><span class="op">:</span> [<span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="dt">oldStart</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">oldLines</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span> <span class="dt">newStart</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">newLines</span><span class="op">:</span> <span class="dv">3</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="dt">lines</span><span class="op">:</span> [<span class="st">&#39; line2&#39;</span><span class="op">,</span> <span class="st">&#39; line3&#39;</span><span class="op">,</span> <span class="st">&#39;-line4&#39;</span><span class="op">,</span> <span class="st">&#39;+line5&#39;</span><span class="op">,</span> <span class="st">&#39;</span><span class="sc">\\</span><span class="st"> No newline at end of file&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">}</span>]</a>
<a class="sourceLine" id="cb2-8" title="8"><span class="op">}</span></a></code></pre></div></li>
<li><p><code>JsDiff.applyPatch(source, patch[, options])</code> - applies a unified diff patch.</p>
<p>Return a string containing new version of provided data. <code>patch</code> may be a string diff or the output from the <code>parsePatch</code> or <code>structuredPatch</code> methods.</p>
<p>The optional <code>options</code> object may have the following keys:</p>
<ul>
<li><code>fuzzFactor</code>: Number of lines that are allowed to differ before rejecting a patch. Defaults to 0.</li>
<li><code>compareLine(lineNumber, line, operation, patchContent)</code>: Callback used to compare to given lines to determine if they should be considered equal when patching. Defaults to strict equality but may be overridden to provide fuzzier comparison. Should return false if the lines should be rejected.</li>
</ul></li>
<li><p><code>JsDiff.applyPatches(patch, options)</code> - applies one or more patches.</p>
<p>This method will iterate over the contents of the patch and apply to data provided through callbacks. The general flow for each patch index is:</p>
<ul>
<li><code>options.loadFile(index, callback)</code> is called. The caller should then load the contents of the file and then pass that to the <code>callback(err, data)</code> callback. Passing an <code>err</code> will terminate further patch execution.</li>
<li><code>options.patched(index, content, callback)</code> is called once the patch has been applied. <code>content</code> will be the return value from <code>applyPatch</code>. When it’s ready, the caller should call <code>callback(err)</code> callback. Passing an <code>err</code> will terminate further patch execution.</li>
</ul>
<p>Once all patches have been applied or an error occurs, the <code>options.complete(err)</code> callback is made.</p></li>
<li><p><code>JsDiff.parsePatch(diffStr)</code> - Parses a patch into structured data</p>
<p>Return a JSON object representation of the a patch, suitable for use with the <code>applyPatch</code> method. This parses to the same structure returned by <code>JsDiff.structuredPatch</code>.</p></li>
<li><p><code>convertChangesToXML(changes)</code> - converts a list of changes to a serialized XML format</p></li>
</ul>
<p>All methods above which accept the optional <code>callback</code> method will run in sync mode when that parameter is omitted and in async mode when supplied. This allows for larger diffs without blocking the event loop. This may be passed either directly as the final parameter or as the <code>callback</code> field in the <code>options</code> object.</p>
<h3 id="change-objects">Change Objects</h3>
<p>Many of the methods above return change objects. These objects consist of the following fields:</p>
<ul>
<li><code>value</code>: Text content</li>
<li><code>added</code>: True if the value was inserted into the new string</li>
<li><code>removed</code>: True if the value was removed from the old string</li>
</ul>
<p>Note that some cases may omit a particular flag field. Comparison on the flag fields should always be done in a truthy or falsy manner.</p>
<h2 id="examples">Examples</h2>
<p>Basic example in Node</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="at">require</span>(<span class="st">&#39;colors&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">var</span> jsdiff <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;diff&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">var</span> one <span class="op">=</span> <span class="st">&#39;beep boop&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">var</span> other <span class="op">=</span> <span class="st">&#39;beep boob blah&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">var</span> diff <span class="op">=</span> <span class="va">jsdiff</span>.<span class="at">diffChars</span>(one<span class="op">,</span> other)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8"></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="va">diff</span>.<span class="at">forEach</span>(<span class="kw">function</span>(part)<span class="op">{</span></a>
<a class="sourceLine" id="cb3-10" title="10">  <span class="co">// green for additions, red for deletions</span></a>
<a class="sourceLine" id="cb3-11" title="11">  <span class="co">// grey for common parts</span></a>
<a class="sourceLine" id="cb3-12" title="12">  <span class="kw">var</span> color <span class="op">=</span> <span class="va">part</span>.<span class="at">added</span> <span class="op">?</span> <span class="st">&#39;green&#39;</span> :</a>
<a class="sourceLine" id="cb3-13" title="13">    <span class="va">part</span>.<span class="at">removed</span> <span class="op">?</span> <span class="st">&#39;red&#39;</span> : <span class="st">&#39;grey&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="va">process</span>.<span class="va">stderr</span>.<span class="at">write</span>(<span class="va">part</span>.<span class="at">value</span>[color])<span class="op">;</span></a>
<a class="sourceLine" id="cb3-15" title="15"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-16" title="16"></a>
<a class="sourceLine" id="cb3-17" title="17"><span class="va">console</span>.<span class="at">log</span>()<span class="op">;</span></a></code></pre></div>
<p>Running the above program should yield</p>
<p><img src="images/node_example.png" alt="Node Example"></p>
<p>Basic example in a web page</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">&lt;pre</span><span class="ot"> id=</span><span class="st">&quot;display&quot;</span><span class="kw">&gt;&lt;/pre&gt;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">&lt;script</span><span class="ot"> src=</span><span class="st">&quot;diff.js&quot;</span><span class="kw">&gt;&lt;/script&gt;</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">&lt;script&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="kw">var</span> one <span class="op">=</span> <span class="st">&#39;beep boop&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb4-5" title="5">    other <span class="op">=</span> <span class="st">&#39;beep boob blah&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb4-6" title="6">    color <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb4-7" title="7">    span <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">var</span> diff <span class="op">=</span> <span class="va">JsDiff</span>.<span class="at">diffChars</span>(one<span class="op">,</span> other)<span class="op">,</span></a>
<a class="sourceLine" id="cb4-10" title="10">    display <span class="op">=</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;display&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb4-11" title="11">    fragment <span class="op">=</span> <span class="va">document</span>.<span class="at">createDocumentFragment</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="va">diff</span>.<span class="at">forEach</span>(<span class="kw">function</span>(part)<span class="op">{</span></a>
<a class="sourceLine" id="cb4-14" title="14">  <span class="co">// green for additions, red for deletions</span></a>
<a class="sourceLine" id="cb4-15" title="15">  <span class="co">// grey for common parts</span></a>
<a class="sourceLine" id="cb4-16" title="16">  color <span class="op">=</span> <span class="va">part</span>.<span class="at">added</span> <span class="op">?</span> <span class="st">&#39;green&#39;</span> :</a>
<a class="sourceLine" id="cb4-17" title="17">    <span class="va">part</span>.<span class="at">removed</span> <span class="op">?</span> <span class="st">&#39;red&#39;</span> : <span class="st">&#39;grey&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-18" title="18">  span <span class="op">=</span> <span class="va">document</span>.<span class="at">createElement</span>(<span class="st">&#39;span&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-19" title="19">  <span class="va">span</span>.<span class="va">style</span>.<span class="at">color</span> <span class="op">=</span> color<span class="op">;</span></a>
<a class="sourceLine" id="cb4-20" title="20">  <span class="va">span</span>.<span class="at">appendChild</span>(document</a>
<a class="sourceLine" id="cb4-21" title="21">    .<span class="at">createTextNode</span>(<span class="va">part</span>.<span class="at">value</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb4-22" title="22">  <span class="va">fragment</span>.<span class="at">appendChild</span>(span)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-23" title="23"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-24" title="24"></a>
<a class="sourceLine" id="cb4-25" title="25"><span class="va">display</span>.<span class="at">appendChild</span>(fragment)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-26" title="26"><span class="kw">&lt;/script&gt;</span></a></code></pre></div>
<p>Open the above .html file in a browser and you should see</p>
<p><img src="images/web_example.png" alt="Node Example"></p>
<p><strong><a href="http://kpdecker.github.com/jsdiff">Full online demo</a></strong></p>
<h2 id="compatibility">Compatibility</h2>
<p><a href="https://saucelabs.com/u/jsdiff"><img src="https://saucelabs.com/browser-matrix/jsdiff.svg" alt="Sauce Test Status" /></a></p>
<p>jsdiff supports all ES3 environments with some known issues on IE8 and below. Under these browsers some diff algorithms such as word diff and others may fail due to lack of support for capturing groups in the <code>split</code> operation.</p>
<h2 id="license">License</h2>
<p>See <a href="https://github.com/kpdecker/jsdiff/blob/master/LICENSE">LICENSE</a>.</p>
</body>
</html>
