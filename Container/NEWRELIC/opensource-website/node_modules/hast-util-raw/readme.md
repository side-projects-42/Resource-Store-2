hast-util-raw
=============

[![Build](https://img.shields.io/travis/syntax-tree/hast-util-raw.svg)](https://travis-ci.org/syntax-tree/hast-util-raw) [![Coverage](https://img.shields.io/codecov/c/github/syntax-tree/hast-util-raw.svg)](https://codecov.io/github/syntax-tree/hast-util-raw) [![Downloads](https://img.shields.io/npm/dm/hast-util-raw.svg)](https://www.npmjs.com/package/hast-util-raw) [![Size](https://img.shields.io/bundlephobia/minzip/hast-util-raw.svg)](https://bundlephobia.com/result?p=hast-util-raw) [![Sponsors](https://opencollective.com/unified/sponsors/badge.svg)](https://opencollective.com/unified) [![Backers](https://opencollective.com/unified/backers/badge.svg)](https://opencollective.com/unified) [![Chat](https://img.shields.io/badge/chat-discussions-success.svg)](https://github.com/syntax-tree/unist/discussions)

[**hast**](https://github.com/syntax-tree/hast) utility to parse the [*tree*](https://github.com/syntax-tree/unist#tree) again, now supporting embedded `raw` nodes.

One of the reasons to do this is for “malformed” syntax trees: for example, say there’s an `h1` element in a `p` element, this utility will make them siblings.

Another reason to do this is if raw HTML/XML is embedded in a syntax tree, which can occur when coming from Markdown using [`mdast-util-to-hast`](https://github.com/syntax-tree/mdast-util-to-hast).

If you’re working with [**remark**](https://github.com/remarkjs/remark) and/or [`remark-rehype`](https://github.com/remarkjs/remark-rehype), use [`rehype-raw`](https://github.com/rehypejs/rehype-raw) instead.

Install
-------

[npm](https://docs.npmjs.com/cli/install):

    npm install hast-util-raw

Use
---

    var h = require('hastscript')
    var raw = require('hast-util-raw')

    var tree = h('div', [h('h1', ['Foo ', h('h2', 'Bar'), ' Baz'])])

    var clean = raw(tree)

    console.log(clean)

Yields:

    { type: 'element',
      tagName: 'div',
      properties: {},
      children:
       [ { type: 'element',
           tagName: 'h1',
           properties: {},
           children: [Object] },
         { type: 'element',
           tagName: 'h2',
           properties: {},
           children: [Object] },
         { type: 'text', value: ' Baz' } ] }

API
---

### `raw(tree[, file])`

Given a [**hast**](https://github.com/syntax-tree/hast) [*tree*](https://github.com/syntax-tree/unist#tree) and an optional [vfile](https://github.com/vfile/vfile) (for [positional info](https://github.com/syntax-tree/unist#positional-information)), return a new parsed-again [**hast**](https://github.com/syntax-tree/hast) [*tree*](https://github.com/syntax-tree/unist#tree).

Security
--------

Use of `hast-util-raw` can open you up to a [cross-site scripting (XSS)](https://en.wikipedia.org/wiki/Cross-site_scripting) attack as `raw` nodes are unsafe. The following example shows how a raw node is used to inject a script that runs when loaded in a browser.

    raw(u('root', [u('raw', '<script>alert(1)</script>')]))

Yields:

    <script>alert(1)</script>

Do not use this utility in combination with user input or use [`hast-util-santize`](https://github.com/syntax-tree/hast-util-sanitize).

Related
-------

-   [`mdast-util-to-hast`](https://github.com/syntax-tree/mdast-util-to-hast) — transform mdast to hast
-   [`rehype-raw`](https://github.com/rehypejs/rehype-raw) — wrapper plugin for [rehype](https://github.com/rehypejs/rehype)

Contribute
----------

See [`contributing.md` in `syntax-tree/.github`](https://github.com/syntax-tree/.github/blob/HEAD/contributing.md) for ways to get started. See [`support.md`](https://github.com/syntax-tree/.github/blob/HEAD/support.md) for ways to get help.

This project has a [code of conduct](https://github.com/syntax-tree/.github/blob/HEAD/code-of-conduct.md). By interacting with this repository, organization, or community you agree to abide by its terms.

License
-------

[MIT](license) © [Titus Wormer](https://wooorm.com)
