<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>readme</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="section"><img src="media/header.png" width="1000"></h1>
<blockquote>
<p>Simple and modern async event emitter</p>
</blockquote>
<p><a href="https://travis-ci.org/sindresorhus/emittery"><img src="https://travis-ci.org/sindresorhus/emittery.svg?branch=master" alt="Build Status" /></a> <a href="https://codecov.io/gh/sindresorhus/emittery"><img src="https://codecov.io/gh/sindresorhus/emittery/branch/master/graph/badge.svg" alt="codecov" /></a> <a href="https://bundlephobia.com/result?p=emittery"><img src="https://badgen.net/bundlephobia/minzip/emittery" /></a></p>
<p>It works in Node.js and the browser (using a bundler).</p>
<p>Emitting events asynchronously is important for production code where you want the least amount of synchronous operations. Since JavaScript is single-threaded, no other code can run while doing synchronous operations. For Node.js, that means it will block other requests, defeating the strength of the platform, which is scalability through async. In the browser, a synchronous operation could potentially cause lags and block user interaction.</p>
<h2 id="install">Install</h2>
<pre><code>$ npm install emittery</code></pre>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="va">emitter</span>.<span class="at">on</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="kw">const</span> myUnicorn <span class="op">=</span> <span class="at">Symbol</span>(<span class="st">&#39;ğŸ¦„&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-10" title="10"></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="va">emitter</span>.<span class="at">on</span>(myUnicorn<span class="op">,</span> data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-12" title="12">    <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Unicorns love </span><span class="sc">${</span>data<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ&#39;</span>)<span class="op">;</span> <span class="co">// Will trigger printing &#39;ğŸŒˆ&#39;</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="va">emitter</span>.<span class="at">emit</span>(myUnicorn<span class="op">,</span> <span class="st">&#39;ğŸ¦‹&#39;</span>)<span class="op">;</span>  <span class="co">// Will trigger printing &#39;Unicorns love ğŸ¦‹&#39;</span></a></code></pre></div>
<h2 id="api">API</h2>
<h3 id="eventname">eventName</h3>
<p>Emittery accepts strings and symbols as event names.</p>
<p>Symbol event names can be used to avoid name collisions when your classes are extended, especially for internal events.</p>
<h3 id="emitter-new-emittery">emitter = new Emittery()</h3>
<h4 id="oneventname-eventname-listener">on(eventName | eventName[], listener)</h4>
<p>Subscribe to one or more events.</p>
<p>Returns an unsubscribe method.</p>
<p>Using the same listener multiple times for the same event will result in only one method call per emitted event.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="va">emitter</span>.<span class="at">on</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="va">emitter</span>.<span class="at">on</span>([<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¶&#39;</span>]<span class="op">,</span> data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ&#39;</span>)<span class="op">;</span> <span class="co">// log =&gt; &#39;ğŸŒˆ&#39; x2</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ–&#39;</span>)<span class="op">;</span> <span class="co">// log =&gt; &#39;ğŸ–&#39;</span></a></code></pre></div>
<h5 id="custom-subscribable-events">Custom subscribable events</h5>
<p>Emittery exports some symbols which represent custom events that can be passed to <code>Emitter.on</code> and similar methods.</p>
<ul>
<li><code>Emittery.listenerAdded</code> - Fires when an event listener was added.</li>
<li><code>Emittery.listenerRemoved</code> - Fires when an event listener was removed.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="va">emitter</span>.<span class="at">on</span>(<span class="va">Emittery</span>.<span class="at">listenerAdded</span><span class="op">,</span> (<span class="op">{</span>listener<span class="op">,</span> eventName<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(listener)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="co">//=&gt; data =&gt; {}</span></a>
<a class="sourceLine" id="cb4-8" title="8"></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(eventName)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-10" title="10">    <span class="co">//=&gt; &#39;ğŸ¦„&#39;</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="va">emitter</span>.<span class="at">on</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-14" title="14">    <span class="co">// Handle data</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h6 id="listener-data">Listener data</h6>
<ul>
<li><code>listener</code> - The listener that was added.</li>
<li><code>eventName</code> - The name of the event that was added or removed if <code>.on()</code> or <code>.off()</code> was used, or <code>undefined</code> if <code>.onAny()</code> or <code>.offAny()</code> was used.</li>
</ul>
<p>Only events that are not of this type are able to trigger these events.</p>
<h5 id="listenerdata">listener(data)</h5>
<h4 id="offeventname-eventname-listener">off(eventName | eventName[], listener)</h4>
<p>Remove one or more event subscriptions.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">const</span> listener <span class="op">=</span> data <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6">(<span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="va">emitter</span>.<span class="at">on</span>([<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¦Š&#39;</span>]<span class="op">,</span> listener)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-8" title="8">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;a&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-9" title="9">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦Š&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-11" title="11">    <span class="va">emitter</span>.<span class="at">off</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> listener)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-12" title="12">    <span class="va">emitter</span>.<span class="at">off</span>([<span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¦Š&#39;</span>]<span class="op">,</span> listener)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-13" title="13">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;a&#39;</span>)<span class="op">;</span> <span class="co">// nothing happens</span></a>
<a class="sourceLine" id="cb5-14" title="14">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>)<span class="op">;</span> <span class="co">// nothing happens</span></a>
<a class="sourceLine" id="cb5-15" title="15">    <span class="cf">await</span> <span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦Š&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>)<span class="op">;</span> <span class="co">// nothing happens</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="op">}</span>)()<span class="op">;</span></a></code></pre></div>
<h5 id="listenerdata-1">listener(data)</h5>
<h4 id="onceeventname-eventname">once(eventName | eventName[])</h4>
<p>Subscribe to one or more events only once. It will be unsubscribed after the first event.</p>
<p>Returns a promise for the event data when <code>eventName</code> is emitted.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="va">emitter</span>.<span class="at">once</span>(<span class="st">&#39;ğŸ¦„&#39;</span>).<span class="at">then</span>(data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="co">//=&gt; &#39;ğŸŒˆ&#39;</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="va">emitter</span>.<span class="at">once</span>([<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¶&#39;</span>]).<span class="at">then</span>(data <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="va">console</span>.<span class="at">log</span>(data)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ&#39;</span>)<span class="op">;</span> <span class="co">// log =&gt; &#39;ğŸŒˆ&#39; x2</span></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¶&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ–&#39;</span>)<span class="op">;</span> <span class="co">// nothing happens</span></a></code></pre></div>
<h4 id="eventseventname">events(eventName)</h4>
<p>Get an async iterator which buffers data each time an event is emitted.</p>
<p>Call <code>return()</code> on the iterator to remove the subscription.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">const</span> iterator <span class="op">=</span> <span class="va">emitter</span>.<span class="at">events</span>(<span class="st">&#39;ğŸ¦„&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-5" title="5"></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ1&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ2&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb7-8" title="8"></a>
<a class="sourceLine" id="cb7-9" title="9">iterator</a>
<a class="sourceLine" id="cb7-10" title="10">    .<span class="at">next</span>()</a>
<a class="sourceLine" id="cb7-11" title="11">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-12" title="12">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb7-13" title="13">        <span class="co">// value === &#39;ğŸŒˆ1&#39;</span></a>
<a class="sourceLine" id="cb7-14" title="14">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">next</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-15" title="15">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb7-16" title="16">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-17" title="17">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb7-18" title="18">        <span class="co">// value === &#39;ğŸŒˆ2&#39;</span></a>
<a class="sourceLine" id="cb7-19" title="19">        <span class="co">// Revoke subscription</span></a>
<a class="sourceLine" id="cb7-20" title="20">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">return</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-21" title="21">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb7-22" title="22">    .<span class="at">then</span>((<span class="op">{</span>done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-23" title="23">        <span class="co">// done === true</span></a>
<a class="sourceLine" id="cb7-24" title="24">    <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>In practice, you would usually consume the events using the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for-await...of">for await</a> statement. In that case, to revoke the subscription simply break the loop.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="kw">const</span> iterator <span class="op">=</span> <span class="va">emitter</span>.<span class="at">events</span>(<span class="st">&#39;ğŸ¦„&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ1&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ2&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co">// In an async context.</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="cf">for</span> <span class="cf">await</span> (<span class="kw">const</span> data <span class="kw">of</span> iterator) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-11" title="11">    <span class="cf">if</span> (data <span class="op">===</span> <span class="st">&#39;ğŸŒˆ2&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-12" title="12">        <span class="cf">break</span><span class="op">;</span> <span class="co">// Revoke the subscription when we see the value &#39;ğŸŒˆ2&#39;.</span></a>
<a class="sourceLine" id="cb8-13" title="13">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-14" title="14"><span class="op">}</span></a></code></pre></div>
<p>It accepts multiple event names.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">const</span> iterator <span class="op">=</span> <span class="va">emitter</span>.<span class="at">events</span>([<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸ¦Š&#39;</span>])<span class="op">;</span></a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ1&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦Š&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ2&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9">iterator</a>
<a class="sourceLine" id="cb9-10" title="10">    .<span class="at">next</span>()</a>
<a class="sourceLine" id="cb9-11" title="11">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-12" title="12">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb9-13" title="13">        <span class="co">// value === &#39;ğŸŒˆ1&#39;</span></a>
<a class="sourceLine" id="cb9-14" title="14">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">next</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb9-15" title="15">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb9-16" title="16">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-17" title="17">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb9-18" title="18">        <span class="co">// value === &#39;ğŸŒˆ2&#39;</span></a>
<a class="sourceLine" id="cb9-19" title="19">        <span class="co">// Revoke subscription</span></a>
<a class="sourceLine" id="cb9-20" title="20">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">return</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb9-21" title="21">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb9-22" title="22">    .<span class="at">then</span>((<span class="op">{</span>done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-23" title="23">        <span class="co">// done === true</span></a>
<a class="sourceLine" id="cb9-24" title="24">    <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h4 id="emiteventname-data">emit(eventName, data?)</h4>
<p>Trigger an event asynchronously, optionally with some data. Listeners are called in the order they were added, but executed concurrently.</p>
<p>Returns a promise that resolves when all the event listeners are done. <em>Done</em> meaning executed if synchronous or resolved when an async/promise-returning function. You usually wouldnâ€™t want to wait for this, but you could for example catch possible errors. If any of the listeners throw/reject, the returned promise will be rejected with the error, but the other listeners will not be affected.</p>
<h4 id="emitserialeventname-data">emitSerial(eventName, data?)</h4>
<p>Same as above, but it waits for each listener to resolve before triggering the next one. This can be useful if your events depend on each other. Although ideally they should not. Prefer <code>emit()</code> whenever possible.</p>
<p>If any of the listeners throw/reject, the returned promise will be rejected with the error and the remaining listeners will <em>not</em> be called.</p>
<h4 id="onanylistener">onAny(listener)</h4>
<p>Subscribe to be notified about any event.</p>
<p>Returns a method to unsubscribe.</p>
<h5 id="listenereventname-data">listener(eventName, data)</h5>
<h4 id="offanylistener">offAny(listener)</h4>
<p>Remove an <code>onAny</code> subscription.</p>
<h4 id="anyevent">anyEvent()</h4>
<p>Get an async iterator which buffers a tuple of an event name and data each time an event is emitted.</p>
<p>Call <code>return()</code> on the iterator to remove the subscription.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="at">Emittery</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="kw">const</span> iterator <span class="op">=</span> <span class="va">emitter</span>.<span class="at">anyEvent</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-5" title="5"></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ1&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸŒŸ&#39;</span><span class="op">,</span> <span class="st">&#39;ğŸŒˆ2&#39;</span>)<span class="op">;</span> <span class="co">// Buffered</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="va">iterator</span>.<span class="at">next</span>()</a>
<a class="sourceLine" id="cb10-10" title="10">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-11" title="11">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb10-12" title="12">        <span class="co">// value is [&#39;ğŸ¦„&#39;, &#39;ğŸŒˆ1&#39;]</span></a>
<a class="sourceLine" id="cb10-13" title="13">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">next</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-14" title="14">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-15" title="15">    .<span class="at">then</span>((<span class="op">{</span>value<span class="op">,</span> done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-16" title="16">        <span class="co">// done === false</span></a>
<a class="sourceLine" id="cb10-17" title="17">        <span class="co">// value is [&#39;ğŸŒŸ&#39;, &#39;ğŸŒˆ2&#39;]</span></a>
<a class="sourceLine" id="cb10-18" title="18">        <span class="co">// Revoke subscription</span></a>
<a class="sourceLine" id="cb10-19" title="19">        <span class="cf">return</span> <span class="va">iterator</span>.<span class="at">return</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-20" title="20">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-21" title="21">    .<span class="at">then</span>((<span class="op">{</span>done<span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-22" title="22">        <span class="co">// done === true</span></a>
<a class="sourceLine" id="cb10-23" title="23">    <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>In the same way as for <code>events</code>, you can subscribe by using the <code>for await</code> statement</p>
<h4 id="clearlistenerseventnames">clearListeners(eventNames?)</h4>
<p>Clear all event listeners on the instance.</p>
<p>If <code>eventNames</code> is given, only the listeners for that events are cleared.</p>
<h4 id="listenercounteventnames">listenerCount(eventNames?)</h4>
<p>The number of listeners for the <code>eventNames</code> or all events if not specified.</p>
<h4 id="bindmethodstarget-methodnames">bindMethods(target, methodNames?)</h4>
<p>Bind the given <code>methodNames</code>, or all <code>Emittery</code> methods if <code>methodNames</code> is not defined, into the <code>target</code> object.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="im">import</span> Emittery <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;emittery&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">const</span> object <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb11-4" title="4"></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="kw">new</span> <span class="at">Emittery</span>().<span class="at">bindMethods</span>(object)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="va">object</span>.<span class="at">emit</span>(<span class="st">&#39;event&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="typescript">TypeScript</h2>
<p>The default <code>Emittery</code> class does not let you type allowed event names and their associated data. However, you can use <code>Emittery.Typed</code> with generics:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb12-1" title="1"><span class="im">import</span> Emittery <span class="op">=</span><span class="kw"> require</span><span class="op">(</span><span class="st">&#39;emittery&#39;</span><span class="op">);</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">const</span> emitter <span class="op">=</span> <span class="kw">new</span> <span class="va">Emittery</span><span class="op">.</span><span class="fu">Typed</span><span class="op">&lt;{</span>value<span class="op">:</span> <span class="dt">string</span><span class="op">},</span> <span class="st">&#39;open&#39;</span> <span class="op">|</span> <span class="st">&#39;close&#39;</span><span class="op">&gt;</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="va">emitter</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;open&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="va">emitter</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;value&#39;</span><span class="op">,</span> <span class="st">&#39;foo</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="va">emitter</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;value&#39;</span><span class="op">,</span> <span class="dv">1</span>)<span class="op">;</span> <span class="co">// TS compilation error</span></a>
<a class="sourceLine" id="cb12-8" title="8"><span class="va">emitter</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;end&#39;</span>)<span class="op">;</span> <span class="co">// TS compilation error</span></a></code></pre></div>
<h3 id="emittery.mixinemitterypropertyname-methodnames">Emittery.mixin(emitteryPropertyName, methodNames?)</h3>
<p>A decorator which mixins <code>Emittery</code> as property <code>emitteryPropertyName</code> and <code>methodNames</code>, or all <code>Emittery</code> methods if <code>methodNames</code> is not defined, into the target class.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb13-1" title="1"><span class="im">import</span> Emittery <span class="op">=</span><span class="kw"> require</span><span class="op">(</span><span class="st">&#39;emittery&#39;</span><span class="op">);</span></a>
<a class="sourceLine" id="cb13-2" title="2"></a>
<a class="sourceLine" id="cb13-3" title="3">@<span class="va">Emittery</span><span class="op">.</span><span class="fu">mixin</span>(<span class="st">&#39;emittery&#39;</span>)</a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">class</span> MyClass <span class="op">{}</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw">const</span> instance <span class="op">=</span> <span class="kw">new</span> <span class="fu">MyClass</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb13-7" title="7"></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="va">instance</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;event&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="scheduling-details">Scheduling details</h2>
<p>Listeners are not invoked for events emitted <em>before</em> the listener was added. Removing a listener will prevent that listener from being invoked, even if events are in the process of being (asynchronously!) emitted. This also applies to <code>.clearListeners()</code>, which removes all listeners. Listeners will be called in the order they were added. So-called <em>any</em> listeners are called <em>after</em> event-specific listeners.</p>
<p>Note that when using <code>.emitSerial()</code>, a slow listener will delay invocation of subsequent listeners. Itâ€™s possible for newer events to overtake older ones.</p>
<h2 id="faq">FAQ</h2>
<h3 id="how-is-this-different-than-the-built-in-eventemitter-in-node.js">How is this different than the built-in <code>EventEmitter</code> in Node.js?</h3>
<p>There are many things to not like about <code>EventEmitter</code>: its huge API surface, synchronous event emitting, magic error event, flawed memory leak detection. Emittery has none of that.</p>
<h3 id="isnt-eventemitter-synchronous-for-a-reason">Isnâ€™t <code>EventEmitter</code> synchronous for a reason?</h3>
<p>Mostly backwards compatibility reasons. The Node.js team canâ€™t break the whole ecosystem.</p>
<p>It also allows silly code like this:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">let</span> unicorn <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="va">emitter</span>.<span class="at">on</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb14-4" title="4">    unicorn <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-6" title="6"></a>
<a class="sourceLine" id="cb14-7" title="7"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-8" title="8"></a>
<a class="sourceLine" id="cb14-9" title="9"><span class="va">console</span>.<span class="at">log</span>(unicorn)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-10" title="10"><span class="co">//=&gt; true</span></a></code></pre></div>
<p>But I would argue doing that shows a deeper lack of Node.js and async comprehension and is not something we should optimize for. The benefit of async emitting is much greater.</p>
<h3 id="can-you-support-multiple-arguments-for-emit">Can you support multiple arguments for <code>emit()</code>?</h3>
<p>No, just use <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment">destructuring</a>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="va">emitter</span>.<span class="at">on</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> ([foo<span class="op">,</span> bar]) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-2" title="2">    <span class="va">console</span>.<span class="at">log</span>(foo<span class="op">,</span> bar)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-3" title="3"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-4" title="4"></a>
<a class="sourceLine" id="cb15-5" title="5"><span class="va">emitter</span>.<span class="at">emit</span>(<span class="st">&#39;ğŸ¦„&#39;</span><span class="op">,</span> [foo<span class="op">,</span> bar])<span class="op">;</span></a></code></pre></div>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/sindresorhus/p-event">p-event</a> - Promisify an event by waiting for it to be emitted</li>
</ul>
</body>
</html>
