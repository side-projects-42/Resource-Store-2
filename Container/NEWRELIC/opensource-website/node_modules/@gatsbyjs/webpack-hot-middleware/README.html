<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<center>
<h1>
THIS IS A FORK TO BE COMPATIBLE WITH WEBPACK 5 &amp; FAST REFRESH
</h1>
</center>
<h1 id="webpack-hot-middleware">Webpack Hot Middleware</h1>
<p>Webpack hot reloading using only <a href="https://webpack.js.org/guides/development/#webpack-dev-middleware">webpack-dev-middleware</a>. This allows you to add hot reloading into an existing server without <a href="https://webpack.js.org/configuration/dev-server/">webpack-dev-server</a>.</p>
<p>This module is <strong>only</strong> concerned with the mechanisms to connect a browser client to a webpack server &amp; receive updates. It will subscribe to changes from the server and execute those changes using <a href="https://webpack.js.org/concepts/hot-module-replacement/">webpack’s HMR API</a>. Actually making your application capable of using hot reloading to make seamless changes is out of scope, and usually handled by another library.</p>
<p>If you’re using React then some common options are <a href="https://github.com/gaearon/react-transform-hmr/">react-transform-hmr</a> and <a href="https://github.com/gaearon/react-hot-loader">react-hot-loader</a>.</p>
<p><a href="https://www.npmjs.com/package/webpack-hot-middleware"><img src="https://img.shields.io/npm/v/webpack-hot-middleware.svg" alt="npm version" /></a> <a href="https://circleci.com/gh/webpack-contrib/webpack-hot-middleware/tree/master"><img src="https://circleci.com/gh/webpack-contrib/webpack-hot-middleware/tree/master.svg?style=svg" alt="CircleCI" /></a><a href="https://codecov.io/gh/webpack-contrib/webpack-hot-middleware"><img src="https://codecov.io/gh/webpack-contrib/webpack-hot-middleware/branch/master/graph/badge.svg" alt="codecov" /></a><img src="https://img.shields.io/npm/l/webpack-hot-middleware.svg" alt="MIT Licensed" /></p>
<h2 id="installation-usage">Installation &amp; Usage</h2>
<p>See <a href="./example/">example/</a> for an example of usage.</p>
<p>First, install the npm module.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install --save-dev webpack-hot-middleware</a></code></pre></div>
<p>Next, enable hot reloading in your webpack config:</p>
<ol type="1">
<li><p>Add the following plugins to the <code>plugins</code> array:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb2-2" title="2">    <span class="co">// OccurrenceOrderPlugin is needed for webpack 1.x only</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="kw">new</span> <span class="va">webpack</span>.<span class="va">optimize</span>.<span class="at">OccurrenceOrderPlugin</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="kw">new</span> <span class="va">webpack</span>.<span class="at">HotModuleReplacementPlugin</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb2-5" title="5">    <span class="co">// Use NoErrorsPlugin for webpack 1.x</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="kw">new</span> <span class="va">webpack</span>.<span class="at">NoEmitOnErrorsPlugin</span>()</a>
<a class="sourceLine" id="cb2-7" title="7">]</a></code></pre></div>
<p>Occurence ensures consistent build hashes, hot module replacement is somewhat self-explanatory, no errors is used to handle errors more cleanly.</p></li>
<li><p>Add <code>'webpack-hot-middleware/client'</code> into the <code>entry</code> array. This connects to the server to receive notifications when the bundle rebuilds and then updates your client bundle accordingly.</p></li>
</ol>
<p>Now add the middleware into your server:</p>
<ol type="1">
<li><p>Add <code>webpack-dev-middleware</code> the usual way</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;webpack&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">var</span> webpackConfig <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./webpack.config&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="kw">var</span> compiler <span class="op">=</span> <span class="at">webpack</span>(webpackConfig)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="va">app</span>.<span class="at">use</span>(<span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="dt">noInfo</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">publicPath</span><span class="op">:</span> <span class="va">webpackConfig</span>.<span class="va">output</span>.<span class="at">publicPath</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">}</span>))<span class="op">;</span></a></code></pre></div></li>
<li><p>Add <code>webpack-hot-middleware</code> attached to the same compiler instance</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="va">app</span>.<span class="at">use</span>(<span class="at">require</span>(<span class="st">&quot;webpack-hot-middleware&quot;</span>)(compiler))<span class="op">;</span></a></code></pre></div></li>
</ol>
<p>And you’re all set!</p>
<h2 id="changelog">Changelog</h2>
<h3 id="section">2.0.0</h3>
<p><strong>Breaking Change</strong></p>
<p>As of version 2.0.0, all client functionality has been rolled into this module. This means that you should remove any reference to <code>webpack/hot/dev-server</code> or <code>webpack/hot/only-dev-server</code> from your webpack config. Instead, use the <code>reload</code> config option to control this behaviour.</p>
<p>This was done to allow full control over the client receiving updates, which is now able to output full module names in the console when applying changes.</p>
<h2 id="documentation">Documentation</h2>
<p>More to come soon, you’ll have to mostly rely on the example for now.</p>
<h3 id="config">Config</h3>
<h4 id="client">Client</h4>
<p>Configuration options can be passed to the client by adding querystring parameters to the path in the webpack config.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="st">&#39;webpack-hot-middleware/client?path=/__what&amp;timeout=2000&amp;overlay=false&#39;</span></a></code></pre></div>
<ul>
<li><strong>path</strong> - The path which the middleware is serving the event stream on</li>
<li><strong>name</strong> - Bundle name, specifically for multi-compiler mode</li>
<li><strong>timeout</strong> - The time to wait after a disconnection before attempting to reconnect</li>
<li><strong>overlay</strong> - Set to <code>false</code> to disable the DOM-based client-side overlay.</li>
<li><strong>reload</strong> - Set to <code>true</code> to auto-reload the page when webpack gets stuck.</li>
<li><strong>noInfo</strong> - Set to <code>true</code> to disable informational console logging.</li>
<li><strong>quiet</strong> - Set to <code>true</code> to disable all console logging.</li>
<li><strong>dynamicPublicPath</strong> - Set to <code>true</code> to use webpack <code>publicPath</code> as prefix of <code>path</code>. (We can set <code>__webpack_public_path__</code> dynamically at runtime in the entry point, see note of <a href="https://webpack.js.org/configuration/output/#output-publicpath">output.publicPath</a>)</li>
<li><strong>autoConnect</strong> - Set to <code>false</code> to use to prevent a connection being automatically opened from the client to the webpack back-end - ideal if you need to modify the options using the <code>setOptionsAndConnect</code> function</li>
<li><strong>ansiColors</strong> - An object to customize the client overlay colors as mentioned in the <a href="https://github.com/Tjatse/ansi-html/blob/99ec49e431c70af6275b3c4e00c7be34be51753c/README.md#set-colors">ansi-html</a> package.</li>
<li><strong>overlayStyles</strong> - An object to let you override or add new inline styles to the client overlay div.</li>
<li><strong>overlayWarnings</strong> - Set to <code>true</code> to enable client overlay on warnings in addition to errors.</li>
</ul>
<blockquote>
<p>Note: Since the <code>ansiColors</code> and <code>overlayStyles</code> options are passed via query string, you’ll need to uri encode your stringified options like below:</p>
</blockquote>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> ansiColors <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="dt">red</span><span class="op">:</span> <span class="st">&#39;00FF00&#39;</span> <span class="co">// note the lack of &quot;#&quot;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="op">};</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">var</span> overlayStyles <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="dt">color</span><span class="op">:</span> <span class="st">&#39;#FF0000&#39;</span> <span class="co">// note the inclusion of &quot;#&quot; (these options would be the equivalent of div.style[option] = value)</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="kw">var</span> hotMiddlewareScript <span class="op">=</span> <span class="st">&#39;webpack-hot-middleware/client?path=/__webpack_hmr&amp;timeout=20000&amp;reload=true&amp;ansiColors=&#39;</span> <span class="op">+</span> <span class="at">encodeURIComponent</span>(<span class="va">JSON</span>.<span class="at">stringify</span>(ansiColors)) <span class="op">+</span> <span class="st">&#39;&amp;overlayStyles=&#39;</span> <span class="op">+</span> <span class="at">encodeURIComponent</span>(<span class="va">JSON</span>.<span class="at">stringify</span>(overlayStyles))<span class="op">;</span></a></code></pre></div>
<h4 id="middleware">Middleware</h4>
<p>Configuration options can be passed to the middleware by passing a second argument.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="va">app</span>.<span class="at">use</span>(<span class="at">require</span>(<span class="st">&quot;webpack-hot-middleware&quot;</span>)(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="dt">log</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="dt">path</span><span class="op">:</span> <span class="st">&quot;/__what&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="dt">heartbeat</span><span class="op">:</span> <span class="dv">2000</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="op">}</span>))<span class="op">;</span></a></code></pre></div>
<ul>
<li><strong>log</strong> - A function used to log lines, pass <code>false</code> to disable. Defaults to <code>console.log</code></li>
<li><strong>path</strong> - The path which the middleware will serve the event stream on, must match the client setting</li>
<li><strong>heartbeat</strong> - How often to send heartbeat updates to the client to keep the connection alive. Should be less than the client’s <code>timeout</code> setting - usually set to half its value.</li>
</ul>
<h2 id="how-it-works">How it Works</h2>
<p>The middleware installs itself as a webpack plugin, and listens for compiler events.</p>
<p>Each connected client gets a <a href="http://www.html5rocks.com/en/tutorials/eventsource/basics/">Server Sent Events</a> connection, the server will publish notifications to connected clients on compiler events.</p>
<p>When the client receives a message, it will check to see if the local code is up to date. If it isn’t up to date, it will trigger webpack hot module reloading.</p>
<h3 id="multi-compiler-mode">Multi-compiler mode</h3>
<p>If you’re using multi-compiler mode (exporting an array of config in <code>webpack.config.js</code>), set <code>name</code> parameters to make sure bundles don’t process each other’s updates. For example:</p>
<pre><code>// webpack.config.js
module.exports = [
    {
        name: &#39;mobile&#39;,
        entry: {
            vendor: &#39;vendor.js&#39;,
            main: [&#39;webpack-hot-middleware/client?name=mobile&#39;, &#39;mobile.js&#39;]
        }
    },
    {
        name: &#39;desktop&#39;,
        entry: {
            vendor: &#39;vendor.js&#39;,
            main: [&#39;webpack-hot-middleware/client?name=desktop&#39;, &#39;desktop.js&#39;]
        }
    }
]</code></pre>
<h2 id="other-frameworks">Other Frameworks</h2>
<h3 id="hapi">Hapi</h3>
<p>Use the <a href="https://www.npmjs.com/package/hapi-webpack-plugin">hapi-webpack-plugin</a>.</p>
<h3 id="koa">Koa</h3>
<p><a href="https://www.npmjs.com/package/koa-webpack-middleware">koa-webpack-middleware</a> wraps this module for use with Koa 1.x</p>
<p><a href="https://www.npmjs.com/package/koa-webpack">koa-webpack</a> can be used for Koa 2.x</p>
<h2 id="troubleshooting">Troubleshooting</h2>
<h3 id="use-on-browsers-without-eventsource">Use on browsers without EventSource</h3>
<p>If you want to use this module with browsers that don’t support eventsource, you’ll need to use a <a href="https://libraries.io/search?platforms=NPM&amp;q=eventsource+polyfill">polyfill</a>. See <a href="https://github.com/webpack-contrib/webpack-hot-middleware/issues/11">issue #11</a></p>
<h3 id="not-receiving-updates-in-client-when-using-gzip">Not receiving updates in client when using Gzip</h3>
<p>This is because gzip generally buffers the response, but the Server Sent Events event-stream expects to be able to send data to the client immediately. You should make sure gzipping isn’t being applied to the event-stream. See <a href="https://github.com/webpack-contrib/webpack-hot-middleware/issues/10">issue #10</a>.</p>
<h3 id="use-with-auto-restarting-servers">Use with auto-restarting servers</h3>
<p>This module expects to remain running while you make changes to your webpack bundle, if you use a process manager like nodemon then you will likely see very slow changes on the client side. If you want to reload the server component, either use a separate process, or find a way to reload your server routes without restarting the whole process. See https://github.com/glenjamin/ultimate-hot-reloading-example for an example of one way to do this.</p>
<h3 id="use-with-multiple-entry-points-in-webpack">Use with multiple entry points in webpack</h3>
<p>If you want to use <a href="https://webpack.js.org/concepts/output/#multiple-entry-points">multiple entry points in your webpack config</a> you need to include the hot middleware client in each entry point. This ensures that each entry point file knows how to handle hot updates. See the <a href="example/README.md">examples folder README</a> for an example.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1">entry<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">    <span class="dt">vendor</span><span class="op">:</span> [<span class="st">&#39;jquery&#39;</span><span class="op">,</span> <span class="st">&#39;webpack-hot-middleware/client&#39;</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb9-3" title="3">    <span class="dt">index</span><span class="op">:</span> [<span class="st">&#39;./src/index&#39;</span><span class="op">,</span> <span class="st">&#39;webpack-hot-middleware/client&#39;</span>]</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="op">}</span></a></code></pre></div>
<h2 id="license">License</h2>
<p>See <a href="LICENSE">LICENSE file</a>.</p>
</body>
</html>
