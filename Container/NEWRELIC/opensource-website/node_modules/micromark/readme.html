<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>readme</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 align="center">
<img src="https://raw.githubusercontent.com/micromark/micromark/9c34547/logo.svg?sanitize=true" alt="micromark" width="400" />
</h1>
<p><a href="https://github.com/micromark/micromark/actions"><img src="https://github.com/micromark/micromark/workflows/main/badge.svg" alt="Build" /></a> <a href="https://codecov.io/github/micromark/micromark"><img src="https://img.shields.io/codecov/c/github/micromark/micromark.svg" alt="Coverage" /></a> <a href="https://www.npmjs.com/package/micromark"><img src="https://img.shields.io/npm/dm/micromark.svg" alt="Downloads" /></a> <a href="https://bundlephobia.com/result?p=micromark"><img src="https://img.shields.io/bundlephobia/minzip/micromark.svg" alt="Size" /></a> <a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/sponsors/badge.svg" alt="Sponsors" /></a> <a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/backers/badge.svg" alt="Backers" /></a> <a href="https://github.com/micromark/micromark/discussions"><img src="https://img.shields.io/badge/chat-discussions-success.svg" alt="Chat" /></a></p>
<p>The smallest CommonMark compliant markdown parser with positional info and concrete tokens.</p>
<ul>
<li>[x] <strong><a href="#commonmark">compliant</a></strong> (100% to CommonMark)</li>
<li>[x] <strong><a href="#list-of-extensions">extensions</a></strong> (<a href="https://github.com/micromark/micromark-extension-gfm">GFM</a>, <a href="https://github.com/micromark/micromark-extension-directive">directives</a>, <a href="https://github.com/micromark/micromark-extension-footnote">footnotes</a>, <a href="https://github.com/micromark/micromark-extension-frontmatter">frontmatter</a>, <a href="https://github.com/micromark/micromark-extension-math">math</a>, <a href="https://github.com/micromark/micromark-extension-mdxjs">MDX.js</a>)</li>
<li>[x] <strong><a href="#security">safe</a></strong> (by default)</li>
<li>[x] <strong><a href="#size--debug">small</a></strong> (smallest CM parser that exists)</li>
<li>[x] <strong><a href="#test">robust</a></strong> (1800+ tests, 100% coverage, fuzz testing)</li>
</ul>
<h2 id="intro">Intro</h2>
<p>micromark is a long awaited markdown parser. It uses a <a href="https://github.com/micromark/common-markup-state-machine">state machine</a> to parse the entirety of markdown into concrete tokens. It’s the smallest 100% <a href="#commonmark">CommonMark</a> compliant markdown parser in JavaScript. It was made to replace the internals of <a href="https://unifiedjs.com/explore/package/remark-parse/"><code>remark-parse</code></a>, the most <a href="https://www.npmtrends.com/remark-parse-vs-marked-vs-markdown-it">popular</a> markdown parser. Its API compiles to HTML, but its parts are made to be used separately, so as to generate syntax trees (<a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a>) or compile to other output formats. It’s in open beta: up next are <a href="https://github.com/micromark/common-markup-state-machine">CMSM</a> and CSTs.</p>
<ul>
<li>for updates, see <a href="https://twitter.com/unifiedjs">Twitter</a></li>
<li>for more about us, see <a href="https://unifiedjs.com"><code>unifiedjs.com</code></a></li>
<li>for questions, see <a href="https://github.com/micromark/micromark/discussions">Discussions</a></li>
<li>to help, see <a href="#contribute">contribute</a> or <a href="#sponsor">sponsor</a> below</li>
</ul>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#use">Use</a></li>
<li><a href="#api">API</a>
<ul>
<li><a href="#micromarkdoc-encoding-options"><code>micromark(doc[, encoding][, options])</code></a></li>
<li><a href="#micromarkstreamoptions"><code>micromarkStream(options?)</code></a></li>
</ul></li>
<li><a href="#extensions">Extensions</a>
<ul>
<li><a href="#syntaxextension"><code>SyntaxExtension</code></a></li>
<li><a href="#htmlextension"><code>HtmlExtension</code></a></li>
<li><a href="#list-of-extensions">List of extensions</a></li>
</ul></li>
<li><a href="#syntax-tree">Syntax tree</a></li>
<li><a href="#commonmark">CommonMark</a></li>
<li><a href="#grammar">Grammar</a></li>
<li><a href="#test">Test</a></li>
<li><a href="#size--debug">Size &amp; debug</a></li>
<li><a href="#comparison">Comparison</a></li>
<li><a href="#version">Version</a></li>
<li><a href="#security">Security</a></li>
<li><a href="#contribute">Contribute</a></li>
<li><a href="#sponsor">Sponsor</a></li>
<li><a href="#origin-story">Origin story</a></li>
<li><a href="#license">License</a></li>
</ul>
<h2 id="install">Install</h2>
<p><a href="https://docs.npmjs.com/cli/install">npm</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install micromark</a></code></pre></div>
<h2 id="use">Use</h2>
<p>Typical use (buffering):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> micromark <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;micromark&#39;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="at">micromark</span>(<span class="st">&#39;## Hello, *world*!&#39;</span>))</a></code></pre></div>
<p>Yields:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">&lt;h2&gt;</span>Hello, <span class="kw">&lt;em&gt;</span>world<span class="kw">&lt;/em&gt;</span>!<span class="kw">&lt;/h2&gt;</span></a></code></pre></div>
<p>The same can be done with ESM (in Node 10+, browsers that support it, or with a bundler), in an <code>example.mjs</code> file, like so:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="im">import</span> micromark <span class="im">from</span> <span class="st">&#39;micromark&#39;</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="va">console</span>.<span class="at">log</span>(<span class="at">micromark</span>(<span class="st">&#39;## Hello, *world*!&#39;</span>))</a></code></pre></div>
<p>You can pass extensions (in this case <a href="https://github.com/micromark/micromark-extension-gfm"><code>micromark-extension-gfm</code></a>):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> micromark <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;micromark&#39;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">var</span> gfmSyntax <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;micromark-extension-gfm&#39;</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">var</span> gfmHtml <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;micromark-extension-gfm/html&#39;</span>)</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">var</span> doc <span class="op">=</span> <span class="st">&#39;* [x] contact@example.com ~~strikethrough~~&#39;</span></a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="kw">var</span> result <span class="op">=</span> <span class="at">micromark</span>(doc<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="dt">extensions</span><span class="op">:</span> [<span class="at">gfmSyntax</span>()]<span class="op">,</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="dt">htmlExtensions</span><span class="op">:</span> [gfmHtml]</a>
<a class="sourceLine" id="cb5-10" title="10"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="va">console</span>.<span class="at">log</span>(result)</a></code></pre></div>
<p>Yields:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode html"><code class="sourceCode html"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">&lt;ul&gt;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">&lt;li&gt;&lt;input</span><span class="ot"> checked=</span><span class="st">&quot;&quot;</span><span class="ot"> disabled=</span><span class="st">&quot;&quot;</span><span class="ot"> type=</span><span class="st">&quot;checkbox&quot;</span><span class="kw">&gt;</span> <span class="kw">&lt;a</span><span class="ot"> href=</span><span class="st">&quot;mailto:contact@example.com&quot;</span><span class="kw">&gt;</span>contact@example.com<span class="kw">&lt;/a&gt;</span> <span class="kw">&lt;del&gt;</span>strikethrough<span class="kw">&lt;/del&gt;&lt;/li&gt;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">&lt;/ul&gt;</span></a></code></pre></div>
<p>Streaming interface:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">var</span> fs <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;fs&#39;</span>)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">var</span> micromarkStream <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;micromark/stream&#39;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="va">fs</span>.<span class="at">createReadStream</span>(<span class="st">&#39;example.md&#39;</span>)</a>
<a class="sourceLine" id="cb7-5" title="5">  .<span class="at">on</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> handleError)</a>
<a class="sourceLine" id="cb7-6" title="6">  .<span class="at">pipe</span>(<span class="at">micromarkStream</span>())</a>
<a class="sourceLine" id="cb7-7" title="7">  .<span class="at">pipe</span>(<span class="va">process</span>.<span class="at">stdout</span>)</a>
<a class="sourceLine" id="cb7-8" title="8"></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw">function</span> <span class="at">handleError</span>(err) <span class="op">{</span></a>
<a class="sourceLine" id="cb7-10" title="10">  <span class="co">// Handle your error here!</span></a>
<a class="sourceLine" id="cb7-11" title="11">  <span class="cf">throw</span> err</a>
<a class="sourceLine" id="cb7-12" title="12"><span class="op">}</span></a></code></pre></div>
<h2 id="api">API</h2>
<p>This section documents the API. The parts can be used separately, but this isn’t documented yet.</p>
<h3 id="micromarkdoc-encoding-options"><code>micromark(doc[, encoding][, options])</code></h3>
<p>Compile markdown to HTML.</p>
<h5 id="parameters">Parameters</h5>
<h6 id="doc"><code>doc</code></h6>
<p>Markdown to parse (<code>string</code> or <code>Buffer</code>)</p>
<h6 id="encoding"><code>encoding</code></h6>
<p><a href="https://nodejs.org/api/buffer.html#buffer_buffers_and_character_encodings">Character encoding</a> to understand <code>doc</code> as when it’s a <a href="https://nodejs.org/api/buffer.html"><code>Buffer</code></a> (<code>string</code>, default: <code>'utf8'</code>).</p>
<h6 id="options.defaultlineending"><code>options.defaultLineEnding</code></h6>
<p>Value to use for line endings not in <code>doc</code> (<code>string</code>, default: first line ending or <code>'\n'</code>).</p>
<p>Generally, micromark copies line endings (<code>'\r'</code>, <code>'\n'</code>, <code>'\r\n'</code>) in the markdown document over to the compiled HTML. In some cases, such as <code>&gt; a</code>, CommonMark requires that extra line endings are added: <code>&lt;blockquote&gt;\n&lt;p&gt;a&lt;/p&gt;\n&lt;/blockquote&gt;</code>.</p>
<h6 id="options.allowdangeroushtml"><code>options.allowDangerousHtml</code></h6>
<p>Whether to allow embedded HTML (<code>boolean</code>, default: <code>false</code>).</p>
<h6 id="options.allowdangerousprotocol"><code>options.allowDangerousProtocol</code></h6>
<p>Whether to allow potentially dangerous protocols in links and images (<code>boolean</code>, default: <code>false</code>). URLs relative to the current protocol are always allowed (such as, <code>image.jpg</code>). For links, the allowed protocols are <code>http</code>, <code>https</code>, <code>irc</code>, <code>ircs</code>, <code>mailto</code>, and <code>xmpp</code>. For images, the allowed protocols are <code>http</code> and <code>https</code>.</p>
<h6 id="options.extensions"><code>options.extensions</code></h6>
<p>Array of syntax extensions (<a href="#syntaxextension"><code>Array.&lt;SyntaxExtension&gt;</code></a>, default: <code>[]</code>).</p>
<h6 id="options.htmlextensions"><code>options.htmlExtensions</code></h6>
<p>Array of HTML extensions (<a href="#htmlextension"><code>Array.&lt;HtmlExtension&gt;</code></a>, default: <code>[]</code>).</p>
<h5 id="returns">Returns</h5>
<p><code>string</code> — Compiled HTML.</p>
<h3 id="micromarkstreamoptions"><code>micromarkStream(options?)</code></h3>
<p>Streaming interface of micromark. Compiles markdown to HTML. <code>options</code> are the same as the buffering API above. Available at <code>require('micromark/stream')</code>. Note that some of the work to parse markdown can be done streaming, but in the end buffering is required.</p>
<p>micromark does not handle errors for you, so you must handle errors on whatever streams you pipe into it. As markdown does not know errors, <code>micromark</code> itself does not emit errors.</p>
<h2 id="extensions">Extensions</h2>
<p>There are two types of extensions for micromark: <a href="#syntaxextension"><code>SyntaxExtension</code></a> and <a href="#htmlextension"><code>HtmlExtension</code></a>. They can be passed in <a href="#optionsextensions"><code>extensions</code></a> or <a href="#optionshtmlextensions"><code>htmlExtensions</code></a>, respectively.</p>
<h3 id="syntaxextension"><code>SyntaxExtension</code></h3>
<p>A syntax extension is an object whose fields are the names of hooks, referring to where constructs “hook” into. <code>content</code> (a block of, well, content: definitions and paragraphs), <code>document</code> (containers such as block quotes and lists), <code>flow</code> (block constructs such as ATX and setext headings, HTML, indented and fenced code, thematic breaks), <code>string</code> (things that work in a few places such as destinations, fenced code info, etc: character escapes and -references), or <code>text</code> (rich inline text: autolinks, character escapes and -references, code, hard breaks, HTML, images, links, emphasis, strong).</p>
<p>The fields at such objects are character codes, mapping to constructs as values. The built in <a href="lib/constructs.mjs">constructs</a> are an extension. See it and the <a href="#list-of-extensions">existing extensions</a> for inspiration.</p>
<h3 id="htmlextension"><code>HtmlExtension</code></h3>
<p>An HTML extension is an object whose fields are either <code>enter</code> or <code>exit</code> (reflecting whether a token is entered or exited). The values at such objects are names of tokens mapping to handlers. See the <a href="#list-of-extensions">existing extensions</a> for inspiration.</p>
<h3 id="list-of-extensions">List of extensions</h3>
<ul>
<li><a href="https://github.com/micromark/micromark-extension-directive"><code>micromark/micromark-extension-directive</code></a> — support directives (generic extensions)</li>
<li><a href="https://github.com/micromark/micromark-extension-footnote"><code>micromark/micromark-extension-footnote</code></a> — support footnotes</li>
<li><a href="https://github.com/micromark/micromark-extension-frontmatter"><code>micromark/micromark-extension-frontmatter</code></a> — support frontmatter (YAML, TOML, etc)</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm"><code>micromark/micromark-extension-gfm</code></a> — support GFM (GitHub Flavored Markdown)</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-autolink-literal"><code>micromark/micromark-extension-gfm-autolink-literal</code></a> — support GFM autolink literals</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-strikethrough"><code>micromark/micromark-extension-gfm-strikethrough</code></a> — support GFM strikethrough</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-table"><code>micromark/micromark-extension-gfm-table</code></a> — support GFM tables</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-tagfilter"><code>micromark/micromark-extension-gfm-tagfilter</code></a> — support GFM tagfilter</li>
<li><a href="https://github.com/micromark/micromark-extension-gfm-task-list-item"><code>micromark/micromark-extension-gfm-task-list-item</code></a> — support GFM tasklists</li>
<li><a href="https://github.com/micromark/micromark-extension-math"><code>micromark/micromark-extension-math</code></a> — support math</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx"><code>micromark/micromark-extension-mdx</code></a> — support MDX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs"><code>micromark/micromark-extension-mdxjs</code></a> — support MDX.js</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-expression"><code>micromark/micromark-extension-mdx-expression</code></a> — support MDX (or MDX.js) expressions</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-jsx"><code>micromark/micromark-extension-mdx-jsx</code></a> — support MDX (or MDX.js) JSX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-md"><code>micromark/micromark-extension-mdx-md</code></a> — support misc MDX changes</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs-esm"><code>micromark/micromark-extension-mdxjs-esm</code></a> — support MDX.js import/exports</li>
</ul>
<h2 id="syntax-tree">Syntax tree</h2>
<p>A higher level project, <a href="https://github.com/syntax-tree/mdast-util-from-markdown"><code>mdast-util-from-markdown</code></a>, can give you an AST.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">var</span> fromMarkdown <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;mdast-util-from-markdown&#39;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">var</span> result <span class="op">=</span> <span class="at">fromMarkdown</span>(<span class="st">&#39;## Hello, *world*!&#39;</span>)</a>
<a class="sourceLine" id="cb8-4" title="4"></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="va">console</span>.<span class="at">log</span>(<span class="va">result</span>.<span class="at">children</span>[<span class="dv">0</span>])</a></code></pre></div>
<p>Yields:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb9-2" title="2">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;heading&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-3" title="3">  <span class="dt">depth</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="dt">children</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="op">{</span><span class="dt">type</span><span class="op">:</span> <span class="st">&#39;text&#39;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">&#39;Hello, &#39;</span><span class="op">,</span> <span class="dt">position</span><span class="op">:</span> [Object]<span class="op">},</span></a>
<a class="sourceLine" id="cb9-6" title="6">    <span class="op">{</span><span class="dt">type</span><span class="op">:</span> <span class="st">&#39;emphasis&#39;</span><span class="op">,</span> <span class="dt">children</span><span class="op">:</span> [Array]<span class="op">,</span> <span class="dt">position</span><span class="op">:</span> [Object]<span class="op">},</span></a>
<a class="sourceLine" id="cb9-7" title="7">    <span class="op">{</span><span class="dt">type</span><span class="op">:</span> <span class="st">&#39;text&#39;</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">&#39;!&#39;</span><span class="op">,</span> <span class="dt">position</span><span class="op">:</span> [Object]<span class="op">}</span></a>
<a class="sourceLine" id="cb9-8" title="8">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb9-9" title="9">  <span class="dt">position</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-10" title="10">    <span class="dt">start</span><span class="op">:</span> <span class="op">{</span><span class="dt">line</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">column</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">offset</span><span class="op">:</span> <span class="dv">0</span><span class="op">},</span></a>
<a class="sourceLine" id="cb9-11" title="11">    <span class="dt">end</span><span class="op">:</span> <span class="op">{</span><span class="dt">line</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">column</span><span class="op">:</span> <span class="dv">19</span><span class="op">,</span> <span class="dt">offset</span><span class="op">:</span> <span class="dv">18</span><span class="op">}</span></a>
<a class="sourceLine" id="cb9-12" title="12">  <span class="op">}</span></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="op">}</span></a></code></pre></div>
<p>Another level up is <a href="https://github.com/remarkjs/remark"><strong>remark</strong></a>, which provides a nice interface and hundreds of plugins.</p>
<h2 id="commonmark">CommonMark</h2>
<p>The first definition of “Markdown” gave several examples of how it worked, showing input Markdown and output HTML, and came with a reference implementation (<code>Markdown.pl</code>). When new implementations followed, they mostly followed the first definition, but deviated from the first implementation, and added extensions, thus making the format a family of formats.</p>
<p>Some years later, an attempt was made to standardize the differences between implementations, by specifying how several edge cases should be handled, through more input and output examples. This is known as <a href="https://commonmark.org">CommonMark</a>, and many implementations now work towards some degree of CommonMark compliancy. Still, CommonMark describes what the output in HTML should be given some input, which leaves many edge cases up for debate, and does not answer what should happen for other output formats.</p>
<p>micromark passes all tests from CommonMark and has many more tests to match the CommonMark reference parsers. Finally, it comes with <a href="https://github.com/micromark/common-markup-state-machine">CMSM</a>, which describes how to parse markup, instead of documenting input and output examples.</p>
<h2 id="grammar">Grammar</h2>
<p>The syntax of markdown can be described in Backus–Naur form (BNF) as:</p>
<pre class="bnf"><code>markdown = .*</code></pre>
<p>No, that’s not a <a href="http://trevorjim.com/a-specification-for-markdown/">typo</a>: markdown has no syntax errors; anything thrown at it renders <em>something</em>.</p>
<h2 id="test">Test</h2>
<p>micromark is tested with the ~650 CommonMark tests and more than 1.2k extra tests confirmed with CM reference parsers. These tests reach all branches in the code, thus this project has 100% coverage. Finally, we use fuzz testing to ensure micromark is stable, reliable, and secure.</p>
<p>To build, format, and test the codebase, use <code>$ npm test</code> after clone and install. The <code>$ npm run test-api</code> and <code>$ npm run test-coverage</code> scripts check the unit tests and their coverage, respectively. The <code>$ npm run test-types</code> script checks TypeScript definitions.</p>
<p>The <code>$ npm run test-fuzz</code> script does fuzz testing for 15 minutes. The timeout is provided by GNU coreutils <strong>timeout(1)</strong>, which might not be available on your system. Either install it or remove it from the script.</p>
<h2 id="size-debug">Size &amp; debug</h2>
<p>micromark is really small. A ton of time went into making sure it minifies well, by the way code is written but also through custom build scripts to pre-evaluate certain expressions. Furthermore, care went into making it compress well with GZip and Brotli.</p>
<p>Normally, you’ll use the pre-evaluated version of micromark, which is published in the <code>dist/</code> folder and has entries in the root. While developing or debugging, you can switch to use the source, which is published in the <code>lib/</code> folder, and comes instrumented with assertions and debug messages. To see debug messages, run your script with a <code>DEBUG</code> env variable, such as with <code>DEBUG="micromark" node script.js</code>.</p>
<p>To generate the codebase, use <code>$ npm run generate</code> after clone and install. The <code>$ npm run generate-dist</code> script specifically takes <code>lib/</code> and generates <code>dist/</code>. The <code>$ npm run generate-size</code> script checks the bundle size of <code>dist/</code>.</p>
<h2 id="comparison">Comparison</h2>
<p>There are many other markdown parsers out there, and maybe they’re better suited to your use case! Here is a short comparison of a couple of ’em in JavaScript. Note that this list is made by the folks who make <code>micromark</code> and <code>remark</code>, so there is some bias.</p>
<p><strong>Note</strong>: these are, in fact, not really comparable: micromark (and remark) focus on completely different things than other markdown parsers do. Sure, you can generate HTML from markdown with them, but micromark (and remark) are created for (abstract or concrete) syntax trees—to inspect, transform, and generate content, so that you can make things like <a href="https://github.com/mdx-js/mdx">MDX</a>, <a href="https://github.com/prettier/prettier">Prettier</a>, or <a href="https://github.com/gatsbyjs/gatsby">Gatsby</a>.</p>
<h6 id="micromark">micromark</h6>
<p>micromark can be used in two different ways. It can either be used, optionally with existing extensions, to get HTML pretty easily. Or, it can give tremendous power, such as access to all tokens with positional info, at the cost of being hard to get into. It’s super small, pretty fast, and has 100% CommonMark compliance. It has syntax extensions, such as supporting 100% GFM compliance (with <code>micromark-extension-gfm</code>), but they’re rather complex to write. It’s the newest parser on the block.</p>
<p>If you’re looking for fine grained control, use micromark.</p>
<h6 id="remark">remark</h6>
<p><a href="https://github.com/remarkjs/remark">remark</a> is the most popular markdown parser. It’s built on top of <code>micromark</code> and boasts syntax trees. For an analogy, it’s like if Babel, ESLint, and more, were one project. It supports the syntax extensions that micromark has (so it’s 100% CM compliant and can be 100% GFM compliant), but most of the work is done in plugins that transform or inspect the tree. Transforming the tree is relatively easy: it’s a JSON object that can be manipulated directly. remark is stable, widely used, and extremely powerful for handling complex data.</p>
<p>If you’re looking to inspect or transform lots of content, use <a href="https://github.com/remarkjs/remark">remark</a>.</p>
<h6 id="marked">marked</h6>
<p><a href="https://github.com/markedjs/marked">marked</a> is the oldest markdown parser on the block. It’s been around for ages, is battle tested, small, popular, and has a bunch of extensions, but doesn’t match CommonMark or GFM, and is unsafe by default.</p>
<p>If you have markdown you trust and want to turn it into HTML without a fuss, use <a href="https://github.com/markedjs/marked">marked</a>.</p>
<h6 id="markdown-it">markdown-it</h6>
<p><a href="https://github.com/markdown-it/markdown-it">markdown-it</a> is a good, stable, and essentially CommonMark compliant markdown parser, with (optional) support for some GFM features as well. It’s used a lot as a direct dependency in packages, but is rather big. It shines at syntax extensions, where you want to support not just markdown, but <em>your</em> (company’s) version of markdown.</p>
<p>If you’re in Node and have CommonMark-compliant (or funky) markdown and want to turn it into HTML, use <a href="https://github.com/markdown-it/markdown-it">markdown-it</a>.</p>
<h6 id="others">Others</h6>
<p>There are lots of other markdown parsers! Some say they’re small, or fast, or that they’re CommonMark compliant — but that’s not always true. This list is not supposed to be exhaustive. This list of markdown parsers is a snapshot in time of why (not) to use (alternatives to) <code>micromark</code>: they’re all good choices, depending on what your goals are.</p>
<h2 id="version">Version</h2>
<p>The open beta of micromark starts at version <code>2.0.0</code> (there was a different package published on npm as <code>micromark</code> before). micromark will adhere to semver at <code>3.0.0</code>. Use tilde ranges for now: <code>"micromark": "~2.10.1"</code>.</p>
<h2 id="security">Security</h2>
<p>The typical security aspect discussed for markdown is <a href="https://en.wikipedia.org/wiki/Cross-site_scripting">cross-site scripting (XSS)</a> attacks. It’s safe to compile markdown to HTML if it does not include embedded HTML nor uses dangerous protocols in links (such as <code>javascript:</code> or <code>data:</code>). micromark is safe by default when embedded HTML or dangerous protocols are used too, as it encodes or drops them. Turning on the <code>allowDangerousHtml</code> or <code>allowDangerousProtocol</code> options for user-provided markdown opens you up to XSS attacks.</p>
<p>Another aspect is DDoS attacks. For example, an attacker could throw a 100mb file at micromark, in which case the JavaScript engine will run out of memory and crash. It is also possible to crash micromark with smaller payloads, notably when thousands of links, images, emphasis, or strong are opened but not closed. It is wise to cap the accepted size of input (500kb can hold a big book) and to process content in a different thread or worker so that it can be stopped when needed.</p>
<p>Using extensions might also be unsafe, refer to their documentation for more information.</p>
<p>For more information on markdown sanitation, see <a href="https://github.com/ChALkeR/notes/blob/master/Improper-markup-sanitization.md"><code>improper-markup-sanitization.md</code></a> by <a href="https://github.com/ChALkeR"><strong><span class="citation" data-cites="chalker">@chalker</span></strong></a>.</p>
<p>See <a href="https://github.com/micromark/.github/blob/HEAD/security.md"><code>security.md</code></a> in <a href="https://github.com/micromark/.github"><code>micromark/.github</code></a> for how to submit a security report.</p>
<h2 id="contribute">Contribute</h2>
<p>See <a href="https://github.com/micromark/.github/blob/HEAD/contributing.md"><code>contributing.md</code></a> in <a href="https://github.com/micromark/.github"><code>micromark/.github</code></a> for ways to get started. See <a href="https://github.com/micromark/.github/blob/HEAD/support.md"><code>support.md</code></a> for ways to get help.</p>
<p>This project has a <a href="https://github.com/micromark/.github/blob/HEAD/code-of-conduct.md">code of conduct</a>. By interacting with this repository, organisation, or community you agree to abide by its terms.</p>
<h2 id="sponsor">Sponsor</h2>
<p>Support this effort and give back by sponsoring on <a href="https://opencollective.com/unified">OpenCollective</a>!</p>
<table>
<tr valign="middle">
<td width="100%" align="center" colspan="10">
<br> <a href="https://www.salesforce.com">Salesforce</a> 🏅<br><br> <a href="https://www.salesforce.com"><img src="https://images.opencollective.com/salesforce/ca8f997/logo/512.png" width="256"></a>
</td>
</tr>
<tr valign="middle">
<td width="20%" align="center" colspan="2">
<a href="https://www.gatsbyjs.org">Gatsby</a> 🥇<br><br> <a href="https://www.gatsbyjs.org"><img src="https://avatars1.githubusercontent.com/u/12551863?s=256&v=4" width="128"></a>
</td>
<td width="20%" align="center" colspan="2">
<a href="https://vercel.com">Vercel</a> 🥇<br><br> <a href="https://vercel.com"><img src="https://avatars1.githubusercontent.com/u/14985020?s=256&v=4" width="128"></a>
</td>
<td width="20%" align="center" colspan="2">
<a href="https://www.netlify.com">Netlify</a><br><br> <!--OC has a sharper image--> <a href="https://www.netlify.com"><img src="https://images.opencollective.com/netlify/4087de2/logo/256.png" width="128"></a>
</td>
<td width="10%" align="center">
<a href="https://www.holloway.com">Holloway</a><br><br> <a href="https://www.holloway.com"><img src="https://avatars1.githubusercontent.com/u/35904294?s=128&v=4" width="64"></a>
</td>
<td width="10%" align="center">
<a href="https://themeisle.com">ThemeIsle</a><br><br> <a href="https://themeisle.com"><img src="https://avatars1.githubusercontent.com/u/58979018?s=128&v=4" width="64"></a>
</td>
<td width="10%" align="center">
<a href="https://boosthub.io">Boost Hub</a><br><br> <a href="https://boosthub.io"><img src="https://images.opencollective.com/boosthub/6318083/logo/128.png" width="64"></a>
</td>
<td width="10%" align="center">
<a href="https://expo.io">Expo</a><br><br> <a href="https://expo.io"><img src="https://avatars1.githubusercontent.com/u/12504344?s=128&v=4" width="64"></a>
</td>
</tr>
<tr valign="middle">
<td width="100%" align="center" colspan="10">
<br> <a href="https://opencollective.com/unified"><strong>You?</strong></a> <br><br>
</td>
</tr>
</table>
<h2 id="origin-story">Origin story</h2>
<p>Over the summer of 2018, micromark was planned, and the idea shared in August with a couple of friends and potential sponsors. The problem I (<strong><span class="citation" data-cites="wooorm">[@wooorm]</span>[]</strong>) had was that issues were piling up in remark and other repos, but my day job (teaching) was fun, fulfilling, and deserved time too. It was getting hard to combine the two. The thought was to feed two birds with one scone: fix the issues in remark with a new markdown parser (codename marydown) while being financially supported by sponsors building fancy stuff on top, such as Gatsby, Contentful, and Vercel (ZEIT at the time). <strong><span class="citation" data-cites="johno">[@johno]</span>[]</strong> was making MDX on top of remark at the time (important historical note: several other folks were working on JSX + markdown too). We bundled our strengths: MDX was getting some traction and we thought together we could perhaps make something sustainable.</p>
<p>In November 2018, we launched with the idea for micromark to solve all existing bugs, sustaining the existing hundreds of projects, and furthering the exciting high-level project MDX. We pushed a single name: unified (which back then was a small but essential part of the chain). Gatsby and Vercel were immediate sponsors. We didn’t know whether it would work, and it worked. But now you have a new problem: you are getting some financial support (much more than other open source projects) but it’s not enough money for rent, and too much money to print stickers with. You still have your job and issues are still piling up.</p>
<p>At the start of summer 2019, after a couple months of saving up donations, I quit my job and worked on unified through fall. That got the number of open issues down significantly and set up a strong governance and maintenance system for the collective. But when the time came to work on micromark, the money was gone again, so I contracted through winter 2019, and in spring 2020 I could do about half open source, half contracting. One of the contracting gigs was to write a new MDX parser, for which I also documented how to do that with a state machine <a href="https://github.com/micromark/mdx-state-machine">in prose</a>. That gave me the insight into how the same could be done for markdown: I drafted <a href="https://github.com/micromark/common-markup-state-machine">CMSM</a>, which was some of the core ideas for micromark, but in prose.</p>
<p>In May 2020, Salesforce reached out: they saw the bugs in remark, how micromark could help, and the initial work on CMSM. And they had thousands of Markdown files. In a for open source uncharacteristic move, they decided to fund my work on micromark. A large part of what maintaining open source means, is putting out fires, triaging issues, and making sure users and sponsors are happy, so it was amazing to get several months to just focus and make something new. I remember feeling that this project would probably be the hardest thing I’d work on: yeah, parsers are pretty difficult, but markdown is on another level. Markdown is such a giant stack of edge cases on edge cases on even more weirdness, what a mess. On August 20, 2020, I released <a href="https://github.com/micromark/micromark/releases/tag/2.0.0">2.0.0</a>, the first working version of micromark. And it’s hard to describe how that moment felt. It was great.</p>
<h2 id="license">License</h2>
<p><a href="license">MIT</a> © <a href="https://wooorm.com">Titus Wormer</a></p>
<!-- Definitions -->
<p><span class="citation" data-cites="wooorm">[@wooorm]</span>: https://github.com/wooorm</p>
<p><span class="citation" data-cites="johno">[@johno]</span>: https://github.com/johno</p>
</body>
</html>
