<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>readme</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="micromark-extension-mdx-expression">micromark-extension-mdx-expression</h1>
<p><a href="https://github.com/micromark/micromark-extension-mdx-expression/actions"><img src="https://github.com/micromark/micromark-extension-mdx-expression/workflows/main/badge.svg" alt="Build" /></a> <a href="https://codecov.io/github/micromark/micromark-extension-mdx-expression"><img src="https://img.shields.io/codecov/c/github/micromark/micromark-extension-mdx-expression.svg" alt="Coverage" /></a> <a href="https://www.npmjs.com/package/micromark-extension-mdx-expression"><img src="https://img.shields.io/npm/dm/micromark-extension-mdx-expression.svg" alt="Downloads" /></a> <a href="https://bundlephobia.com/result?p=micromark-extension-mdx-expression"><img src="https://img.shields.io/bundlephobia/minzip/micromark-extension-mdx-expression.svg" alt="Size" /></a> <a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/sponsors/badge.svg" alt="Sponsors" /></a> <a href="https://opencollective.com/unified"><img src="https://opencollective.com/unified/backers/badge.svg" alt="Backers" /></a> <a href="https://github.com/micromark/micromark/discussions"><img src="https://img.shields.io/badge/chat-discussions-success.svg" alt="Chat" /></a></p>
<p><strong><a href="https://github.com/micromark/micromark">micromark</a></strong> extension to support MDX (or MDX.js) expressions.</p>
<p>This package provides the low-level modules for integrating with the micromark tokenizer but has no handling of compiling to HTML: go to a syntax tree instead.</p>
<p>You should use this with <a href="https://github.com/syntax-tree/mdast-util-mdx-expression"><code>mdast-util-mdx-expression</code></a> (<strong><a href="https://github.com/syntax-tree/mdast">mdast</a></strong>). Alternatively, use either <a href="https://github.com/micromark/micromark-extension-mdx"><code>micromark-extension-mdx</code></a> or <a href="https://github.com/micromark/micromark-extension-mdxjs"><code>micromark-extension-mdxjs</code></a> with <a href="https://github.com/syntax-tree/mdast-util-mdx"><code>mdast-util-mdx</code></a> to support all of MDX (or MDX.js). Or, use it through <a href="https://github.com/mdx-js/mdx/tree/next/packages/remark-mdx"><code>remark-mdx</code></a> (<strong><a href="https://github.com/remarkjs/remark">remark</a></strong>).</p>
<h2 id="install">Install</h2>
<p><a href="https://docs.npmjs.com/cli/install">npm</a>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install micromark-extension-mdx-expression</a></code></pre></div>
<h2 id="use">Use</h2>
<p>See <a href="https://github.com/syntax-tree/mdast-util-mdx-expression"><code>mdast-util-mdx-expression</code></a> for an example.</p>
<h2 id="api">API</h2>
<h3 id="syntaxoptions"><code>syntax(options?)</code></h3>
<p>Support <a href="https://github.com/mdx-js/mdx">MDX</a> (or MDX.js) expressions.</p>
<p>The export of <code>syntax</code> is a function that can be called with options and returns an extension for the micromark parser (to tokenize expressions; can be passed in <code>extensions</code>).</p>
<h5 id="options"><code>options</code></h5>
<h6 id="options.acorn"><code>options.acorn</code></h6>
<p>Acorn parser to use (<a href="https://github.com/acornjs/acorn"><code>Acorn</code></a>, optional).</p>
<h6 id="options.acornoptions"><code>options.acornOptions</code></h6>
<p>Options to pass to acorn (<code>Object</code>, default: <code>{ecmaVersion: 2020, sourceType: 'module'}</code>). All fields can be set. Positional info (<code>loc</code>, <code>range</code>) is set on ES nodes regardless of acorn options.</p>
<h6 id="options.addresult"><code>options.addResult</code></h6>
<p>Whether to add an <code>estree</code> field to <code>mdxFlowExpression</code> and <code>mdxTextExpression</code> tokens with the results from acorn (<code>boolean</code>, default: <code>false</code>). Note that expressions can be empty or be just comments, in which case <code>estree</code> will be undefined.</p>
<h2 id="syntax">Syntax</h2>
<p>This extensions support both MDX and MDX.js. The first is agnostic to the programming language (it could contain Rust or so), the last is specific to JavaScript. To turn on gnostic mode, pass <code>acorn</code>.</p>
<p>There are two types of expressions: in text (inline, span) or in flow (block). They start with <code>{</code>.</p>
<p>Depending on whether <code>acorn</code> is passed, expressions are either parsed in several tries until whole JavaScript is found (as in, nested curly braces depend on JS expression nesting), or they are counted and must be balanced.</p>
<p>Expressions end with <code>}</code>.</p>
<p>For flow (block) expressions, optionally markdown spaces (<code></code> or <code>\t</code>) can occur after the closing brace, and finally a markdown line ending (<code>\r</code>, <code>\n</code>) or the end of the file must follow.</p>
<p>While markdown typically knows no errors, for MDX it is decided to instead throw on invalid syntax.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode markdown"><code class="sourceCode markdown"><a class="sourceLine" id="cb2-1" title="1">Here is an expression in a heading:</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="fu">## Hello, {1 + 1}!</span></a>
<a class="sourceLine" id="cb2-4" title="4"></a>
<a class="sourceLine" id="cb2-5" title="5">In agnostic mode, balanced braces can occur: {a + {b} + c}.</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7">In gnostic mode, the value of the expression must be JavaScript, so</a>
<a class="sourceLine" id="cb2-8" title="8">this would fail: {!}.</a>
<a class="sourceLine" id="cb2-9" title="9">But, in gnostic mode, braces can be in comments, strings, or in other</a>
<a class="sourceLine" id="cb2-10" title="10">places: {1 /* { */ + 2}.</a>
<a class="sourceLine" id="cb2-11" title="11"></a>
<a class="sourceLine" id="cb2-12" title="12">The previous examples were text (inline, span) expressions, they can</a>
<a class="sourceLine" id="cb2-13" title="13">also be flow (block):</a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15">{</a>
<a class="sourceLine" id="cb2-16" title="16">  1 + 1</a>
<a class="sourceLine" id="cb2-17" title="17">}</a>
<a class="sourceLine" id="cb2-18" title="18"></a>
<a class="sourceLine" id="cb2-19" title="19">This is incorrect, because there are further characters:</a>
<a class="sourceLine" id="cb2-20" title="20"></a>
<a class="sourceLine" id="cb2-21" title="21">{</a>
<a class="sourceLine" id="cb2-22" title="22">  1 + 1</a>
<a class="sourceLine" id="cb2-23" title="23">}!</a>
<a class="sourceLine" id="cb2-24" title="24"></a>
<a class="sourceLine" id="cb2-25" title="25">Blank lines cannot occur in text, because markdown has already split them in</a>
<a class="sourceLine" id="cb2-26" title="26">separate constructs, so this is incorrect: {1 +</a>
<a class="sourceLine" id="cb2-27" title="27"></a>
<a class="sourceLine" id="cb2-28" title="28">1}</a>
<a class="sourceLine" id="cb2-29" title="29"></a>
<a class="sourceLine" id="cb2-30" title="30"></a>
<a class="sourceLine" id="cb2-31" title="31">In flow, you can have blank lines:</a>
<a class="sourceLine" id="cb2-32" title="32"></a>
<a class="sourceLine" id="cb2-33" title="33">{</a>
<a class="sourceLine" id="cb2-34" title="34">  1 +</a>
<a class="sourceLine" id="cb2-35" title="35"></a>
<a class="sourceLine" id="cb2-36" title="36">  2</a>
<a class="sourceLine" id="cb2-37" title="37">}</a></code></pre></div>
<h2 id="errors">Errors</h2>
<h3 id="unexpected-end-of-file-in-expression-expected-a-corresponding-closing-brace-for">Unexpected end of file in expression, expected a corresponding closing brace for <code>{</code></h3>
<p>This error occurs if a <code>{</code> was seen without a <code>}</code> (source: <code>micromark-extension-mdx-expression</code>, rule id: <code>unexpected-eof</code>). For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><a class="sourceLine" id="cb3-1" title="1">a { b</a></code></pre></div>
<h3 id="could-not-parse-expression-with-acorn-unexpected-content-after-expression">Could not parse expression with acorn: Unexpected content after expression</h3>
<p>This error occurs when there is more content after a JS expression (source: <code>micromark-extension-mdx-expression</code>, rule id: <code>acorn</code>). For example:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown"><code class="sourceCode markdown"><a class="sourceLine" id="cb4-1" title="1">a {&quot;b&quot; &quot;c&quot;} d</a></code></pre></div>
<h3 id="could-not-parse-expression-with-acorn-error">Could not parse expression with acorn: $error</h3>
<p>This error occurs if acorn crashes (source: <code>micromark-extension-mdx-expression</code>, rule id: <code>acorn</code>). For example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><a class="sourceLine" id="cb5-1" title="1">a {var b = &quot;c&quot;} d</a></code></pre></div>
<h2 id="tokens">Tokens</h2>
<p>Two tokens are used, <code>mdxFlowExpression</code> and <code>mdxTextExpression</code>, to reflect flow and text expressions.</p>
<p>They include:</p>
<ul>
<li><code>lineEnding</code> for the markdown line endings <code>\r</code>, <code>\n</code>, and <code>\r\n</code></li>
<li><code>mdxFlowExpressionMarker</code> and <code>mdxTextExpressionMarker</code> for the braces</li>
<li><code>whitespace</code> for markdown spaces and tabs in blank lines</li>
<li><code>mdxFlowExpressionChunk</code> and <code>mdxTextExpressionChunk</code> for chunks of expression content</li>
</ul>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/micromark/micromark"><code>micromark/micromark</code></a> — the smallest commonmark-compliant markdown parser that exists</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx"><code>micromark/micromark-extension-mdx</code></a> — micromark extension to support MDX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs"><code>micromark/micromark-extension-mdxjs</code></a> — micromark extension to support MDX.js</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-jsx"><code>micromark/micromark-extension-mdx-jsx</code></a> — micromark extension to support MDX (or MDX.js) JSX</li>
<li><a href="https://github.com/micromark/micromark-extension-mdx-md"><code>micromark/micromark-extension-mdx-md</code></a> — micromark extension to support misc MDX changes</li>
<li><a href="https://github.com/micromark/micromark-extension-mdxjs-esm"><code>micromark/micromark-extension-mdxjs-esm</code></a> — micromark extension to support MDX.js import/exports</li>
<li><a href="https://github.com/syntax-tree/mdast-util-mdx"><code>syntax-tree/mdast-util-mdx</code></a> — mdast utility to support MDX (or MDX.js)</li>
</ul>
<h2 id="contribute">Contribute</h2>
<p>See <a href="https://github.com/micromark/.github/blob/HEAD/contributing.md"><code>contributing.md</code> in <code>micromark/.github</code></a> for ways to get started. See <a href="https://github.com/micromark/.github/blob/HEAD/support.md"><code>support.md</code></a> for ways to get help.</p>
<p>This project has a <a href="https://github.com/micromark/.github/blob/HEAD/code-of-conduct.md">code of conduct</a>. By interacting with this repository, organization, or community you agree to abide by its terms.</p>
<h2 id="license">License</h2>
<p><a href="license">MIT</a> © <a href="https://wooorm.com">Titus Wormer</a></p>
<!-- Definitions -->
</body>
</html>
