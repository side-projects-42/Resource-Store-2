<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<div data-align="center">
<p><a href="https://github.com/webpack/webpack"> <img width="200" height="200" src="https://webpack.js.org/assets/icon-square-big.svg"> </a></p>
</div>
<p><a href="https://npmjs.com/package/webpack-dev-middleware"><img src="https://img.shields.io/npm/v/webpack-dev-middleware.svg" alt="npm" /></a> <a href="https://nodejs.org"><img src="https://img.shields.io/node/v/webpack-dev-middleware.svg" alt="node" /></a> <a href="https://david-dm.org/webpack/webpack-dev-middleware"><img src="https://david-dm.org/webpack/webpack-dev-middleware.svg" alt="deps" /></a> <a href="https://github.com/webpack/webpack-dev-middleware/actions"><img src="https://github.com/webpack/webpack-dev-middleware/workflows/webpack-dev-middleware/badge.svg" alt="tests" /></a> <a href="https://codecov.io/gh/webpack/webpack-dev-middleware"><img src="https://codecov.io/gh/webpack/webpack-dev-middleware/branch/master/graph/badge.svg" alt="coverage" /></a> <a href="https://gitter.im/webpack/webpack"><img src="https://badges.gitter.im/webpack/webpack.svg" alt="chat" /></a> <a href="https://packagephobia.com/result?p=webpack-dev-middleware"><img src="https://packagephobia.com/badge?p=webpack-dev-middleware" alt="size" /></a></p>
<h1 id="webpack-dev-middleware">webpack-dev-middleware</h1>
<p>An express-style development middleware for use with <a href="https://webpack.js.org">webpack</a> bundles and allows for serving of the files emitted from webpack. This should be used for <strong>development only</strong>.</p>
<p>Some of the benefits of using this middleware include:</p>
<ul>
<li>No files are written to disk, rather it handles files in memory</li>
<li>If files changed in watch mode, the middleware delays requests until compiling has completed.</li>
<li>Supports hot module reload (HMR).</li>
</ul>
<h2 id="getting-started">Getting Started</h2>
<p>First thing’s first, install the module:</p>
<pre class="console"><code>npm install webpack-dev-middleware --save-dev</code></pre>
<p><em>Note: We do not recommend installing this module globally.</em></p>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="co">// webpack options</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="kw">const</span> app <span class="op">=</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="va">app</span>.<span class="at">use</span>(</a>
<a class="sourceLine" id="cb2-10" title="10">  <span class="at">middleware</span>(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-11" title="11">    <span class="co">// webpack-dev-middleware options</span></a>
<a class="sourceLine" id="cb2-12" title="12">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb2-13" title="13">)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-14" title="14"></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="va">app</span>.<span class="at">listen</span>(<span class="dv">3000</span><span class="op">,</span> () <span class="kw">=&gt;</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Example app listening on port 3000!&quot;</span>))<span class="op">;</span></a></code></pre></div>
<p>See <a href="#other-servers">below</a> for an example of use with fastify.</p>
<h2 id="options">Options</h2>
<p>The middleware accepts an <code>options</code> Object. The following is a property reference for the Object.</p>
<h3 id="methods">methods</h3>
<p>Type: <code>Array</code><br />
Default: <code>[ 'GET', 'HEAD' ]</code></p>
<p>This property allows a user to pass the list of HTTP request methods accepted by the middleware**.</p>
<h3 id="headers">headers</h3>
<p>Type: <code>Object|Function</code> Default: <code>undefined</code></p>
<p>This property allows a user to pass custom HTTP headers on each request. eg. <code>{ "X-Custom-Header": "yes" }</code></p>
<p>or</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="at">webpackDevMiddleware</span>(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="dt">headers</span><span class="op">:</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="cf">return</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-4" title="4">      <span class="st">&quot;Last-Modified&quot;</span><span class="op">:</span> <span class="kw">new</span> <span class="at">Date</span>()<span class="op">,</span></a>
<a class="sourceLine" id="cb3-5" title="5">    <span class="op">};</span></a>
<a class="sourceLine" id="cb3-6" title="6">  <span class="op">},</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="at">webpackDevMiddleware</span>(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="dt">headers</span><span class="op">:</span> (req<span class="op">,</span> res<span class="op">,</span> context) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="va">res</span>.<span class="at">setHeader</span>(<span class="st">&quot;Last-Modified&quot;</span><span class="op">,</span> <span class="kw">new</span> <span class="at">Date</span>())<span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="op">},</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="index">index</h3>
<p>Type: <code>Boolean|String</code><br />
Default: <code>index.html</code></p>
<p>If <code>false</code> (but not <code>undefined</code>), the server will not respond to requests to the root URL.</p>
<h3 id="mimetypes">mimeTypes</h3>
<p>Type: <code>Object</code><br />
Default: <code>undefined</code></p>
<p>This property allows a user to register custom mime types or extension mappings. eg. <code>mimeTypes: { phtml: 'text/html' }</code>.</p>
<p>Please see the documentation for <a href="https://github.com/jshttp/mime-types"><code>mime-types</code></a> for more information.</p>
<h3 id="publicpath">publicPath</h3>
<p>Type: <code>String</code> Default: <code>output.publicPath</code> (from a configuration)</p>
<p>The public path that the middleware is bound to.</p>
<p><em>Best Practice: use the same <code>publicPath</code> defined in your webpack config. For more information about <code>publicPath</code>, please see <a href="https://webpack.js.org/guides/public-path">the webpack documentation</a>.</em></p>
<h3 id="stats">stats</h3>
<p>Type: <code>Boolean|String|Object</code> Default: <code>stats</code> (from a configuration)</p>
<p>Stats options object or preset name.</p>
<h3 id="serversiderender">serverSideRender</h3>
<p>Type: <code>Boolean</code><br />
Default: <code>undefined</code></p>
<p>Instructs the module to enable or disable the server-side rendering mode. Please see <a href="#server-side-rendering">Server-Side Rendering</a> for more information.</p>
<h3 id="writetodisk">writeToDisk</h3>
<p>Type: <code>Boolean|Function</code><br />
Default: <code>false</code></p>
<p>If <code>true</code>, the option will instruct the module to write files to the configured location on disk as specified in your <code>webpack</code> config file. <em>Setting <code>writeToDisk: true</code> won’t change the behavior of the <code>webpack-dev-middleware</code>, and bundle files accessed through the browser will still be served from memory.</em> This option provides the same capabilities as the <a href="https://github.com/gajus/write-file-webpack-plugin/pulls"><code>WriteFilePlugin</code></a>.</p>
<p>This option also accepts a <code>Function</code> value, which can be used to filter which files are written to disk. The function follows the same premise as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter"><code>Array#filter</code></a> in which a return value of <code>false</code> <em>will not</em> write the file, and a return value of <code>true</code> <em>will</em> write the file to disk. eg.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">const</span> configuration <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="op">};</span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(configuration)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="at">middleware</span>(compiler<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="dt">writeToDisk</span><span class="op">:</span> (filePath) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-9" title="9">    <span class="cf">return</span> <span class="ss">/superman</span><span class="sc">\.</span><span class="ss">css</span><span class="sc">$</span><span class="ss">/</span>.<span class="at">test</span>(filePath)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="op">},</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="outputfilesystem">outputFileSystem</h3>
<p>Type: <code>Object</code><br />
Default: <a href="https://github.com/streamich/memfs">memfs</a></p>
<p>Set the default file system which will be used by webpack as primary destination of generated files. This option isn’t affected by the <a href="#writeToDisk">writeToDisk</a> option.</p>
<p>You have to provide <code>.join()</code> and <code>mkdirp</code> method to the <code>outputFileSystem</code> instance manually for compatibility with <code>webpack@4</code>.</p>
<p>This can be done simply by using <code>path.join</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">const</span> path <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;path&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">const</span> myOutputFileSystem <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;my-fs&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="kw">const</span> mkdirp <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;mkdirp&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-5" title="5"></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="va">myOutputFileSystem</span>.<span class="at">join</span> <span class="op">=</span> <span class="va">path</span>.<span class="va">join</span>.<span class="at">bind</span>(path)<span class="op">;</span> <span class="co">// no need to bind</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="va">myOutputFileSystem</span>.<span class="at">mkdirp</span> <span class="op">=</span> <span class="va">mkdirp</span>.<span class="at">bind</span>(mkdirp)<span class="op">;</span> <span class="co">// no need to bind</span></a>
<a class="sourceLine" id="cb6-8" title="8"></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb6-10" title="10">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="at">middleware</span>(compiler<span class="op">,</span> <span class="op">{</span> <span class="dt">outputFileSystem</span><span class="op">:</span> myOutputFileSystem <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="api">API</h2>
<p><code>webpack-dev-middleware</code> also provides convenience methods that can be use to interact with the middleware at runtime:</p>
<h3 id="closecallback"><code>close(callback)</code></h3>
<p>Instructs <code>webpack-dev-middleware</code> instance to stop watching for file changes.</p>
<h4 id="parameters">Parameters</h4>
<h5 id="callback"><code>callback</code></h5>
<p>Type: <code>Function</code> Required: <code>No</code></p>
<p>A function executed once the middleware has stopped watching.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw">const</span> instance <span class="op">=</span> <span class="at">middleware</span>(compiler)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-8" title="8"></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-10" title="10"></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="va">app</span>.<span class="at">use</span>(instance)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-12" title="12"></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-14" title="14">  <span class="co">// Says `webpack` to stop watch changes</span></a>
<a class="sourceLine" id="cb7-15" title="15">  <span class="va">instance</span>.<span class="at">close</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="invalidatecallback"><code>invalidate(callback)</code></h3>
<p>Instructs <code>webpack-dev-middleware</code> instance to recompile the bundle, e.g. after a change to the configuration.</p>
<h4 id="parameters-1">Parameters</h4>
<h5 id="callback-1"><code>callback</code></h5>
<p>Type: <code>Function</code> Required: <code>No</code></p>
<p>A function executed once the middleware has invalidated.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw">const</span> instance <span class="op">=</span> <span class="at">middleware</span>(compiler)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-10" title="10"></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="va">app</span>.<span class="at">use</span>(instance)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-12" title="12"></a>
<a class="sourceLine" id="cb8-13" title="13"><span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-14" title="14">  <span class="co">// After a short delay the configuration is changed and a banner plugin is added to the config</span></a>
<a class="sourceLine" id="cb8-15" title="15">  <span class="kw">new</span> <span class="va">webpack</span>.<span class="at">BannerPlugin</span>(<span class="st">&quot;A new banner&quot;</span>).<span class="at">apply</span>(compiler)<span class="op">;</span></a>
<a class="sourceLine" id="cb8-16" title="16"></a>
<a class="sourceLine" id="cb8-17" title="17">  <span class="co">// Recompile the bundle with the banner plugin:</span></a>
<a class="sourceLine" id="cb8-18" title="18">  <span class="va">instance</span>.<span class="at">invalidate</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="op">},</span> <span class="dv">1000</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="waituntilvalidcallback"><code>waitUntilValid(callback)</code></h3>
<p>Executes a callback function when the compiler bundle is valid, typically after compilation.</p>
<h4 id="parameters-2">Parameters</h4>
<h5 id="callback-2"><code>callback</code></h5>
<p>Type: <code>Function</code> Required: <code>No</code></p>
<p>A function executed when the bundle becomes valid. If the bundle is valid at the time of calling, the callback is executed immediately.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb9-4" title="4">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb9-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-6" title="6"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">const</span> instance <span class="op">=</span> <span class="at">middleware</span>(compiler)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb9-10" title="10"></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="va">app</span>.<span class="at">use</span>(instance)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-12" title="12"></a>
<a class="sourceLine" id="cb9-13" title="13"><span class="va">instance</span>.<span class="at">waitUntilValid</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb9-14" title="14">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&quot;Package is in a valid state&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-15" title="15"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="getfilenamefromurlurl"><code>getFilenameFromUrl(url)</code></h3>
<p>Get filename from URL.</p>
<h4 id="parameters-3">Parameters</h4>
<h5 id="url"><code>url</code></h5>
<p>Type: <code>String</code> Required: <code>Yes</code></p>
<p>URL for the requested file.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="kw">const</span> instance <span class="op">=</span> <span class="at">middleware</span>(compiler)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="va">app</span>.<span class="at">use</span>(instance)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-12" title="12"></a>
<a class="sourceLine" id="cb10-13" title="13"><span class="va">instance</span>.<span class="at">waitUntilValid</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb10-14" title="14">  <span class="kw">const</span> filename <span class="op">=</span> <span class="va">instance</span>.<span class="at">getFilenameFromUrl</span>(<span class="st">&quot;/bundle.js&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-15" title="15"></a>
<a class="sourceLine" id="cb10-16" title="16">  <span class="va">console</span>.<span class="at">log</span>(<span class="vs">`Filename is </span><span class="sc">${</span>filename<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="known-issues">Known Issues</h2>
<h3 id="multiple-successive-builds">Multiple Successive Builds</h3>
<p>Watching will frequently cause multiple compilations as the bundle changes during compilation. This is due in part to cross-platform differences in file watchers, so that webpack doesn’t loose file changes when watched files change rapidly. If you run into this situation, please make use of the <a href="https://github.com/egoist/time-fix-plugin"><code>TimeFixPlugin</code></a>.</p>
<h2 id="server-side-rendering">Server-Side Rendering</h2>
<p><em>Note: this feature is experimental and may be removed or changed completely in the future.</em></p>
<p>In order to develop an app using server-side rendering, we need access to the <a href="https://github.com/webpack/docs/wiki/node.js-api#stats"><code>stats</code></a>, which is generated with each build.</p>
<p>With server-side rendering enabled, <code>webpack-dev-middleware</code> sets the <code>stats</code> to <code>res.locals.webpack.devMiddleware.stats</code> and the filesystem to <code>res.locals.webpack.devMiddleware.outputFileSystem</code> before invoking the next middleware, allowing a developer to render the page body and manage the response to clients.</p>
<p><em>Note: Requests for bundle files will still be handled by <code>webpack-dev-middleware</code> and all requests will be pending until the build process is finished with server-side rendering enabled.</em></p>
<p>Example Implementation:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> express <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;express&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="co">/* Webpack configuration */</span></a>
<a class="sourceLine" id="cb11-5" title="5"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-6" title="6"><span class="kw">const</span> isObject <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;is-object&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-7" title="7"><span class="kw">const</span> middleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-8" title="8"></a>
<a class="sourceLine" id="cb11-9" title="9"><span class="kw">const</span> app <span class="op">=</span> <span class="kw">new</span> <span class="at">express</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb11-10" title="10"></a>
<a class="sourceLine" id="cb11-11" title="11"><span class="co">// This function makes server rendering of asset references consistent with different webpack chunk/entry configurations</span></a>
<a class="sourceLine" id="cb11-12" title="12"><span class="kw">function</span> <span class="at">normalizeAssets</span>(assets) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-13" title="13">  <span class="cf">if</span> (<span class="at">isObject</span>(assets)) <span class="op">{</span></a>
<a class="sourceLine" id="cb11-14" title="14">    <span class="cf">return</span> <span class="va">Object</span>.<span class="at">values</span>(assets)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-15" title="15">  <span class="op">}</span></a>
<a class="sourceLine" id="cb11-16" title="16"></a>
<a class="sourceLine" id="cb11-17" title="17">  <span class="cf">return</span> <span class="va">Array</span>.<span class="at">isArray</span>(assets) <span class="op">?</span> assets : [assets]<span class="op">;</span></a>
<a class="sourceLine" id="cb11-18" title="18"><span class="op">}</span></a>
<a class="sourceLine" id="cb11-19" title="19"></a>
<a class="sourceLine" id="cb11-20" title="20"><span class="va">app</span>.<span class="at">use</span>(<span class="at">middleware</span>(compiler<span class="op">,</span> <span class="op">{</span> <span class="dt">serverSideRender</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb11-21" title="21"></a>
<a class="sourceLine" id="cb11-22" title="22"><span class="co">// The following middleware would not be invoked until the latest build is finished.</span></a>
<a class="sourceLine" id="cb11-23" title="23"><span class="va">app</span>.<span class="at">use</span>((req<span class="op">,</span> res) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-24" title="24">  <span class="kw">const</span> <span class="op">{</span> devMiddleware <span class="op">}</span> <span class="op">=</span> <span class="va">res</span>.<span class="va">locals</span>.<span class="at">webpack</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-25" title="25">  <span class="kw">const</span> outputFileSystem <span class="op">=</span> <span class="va">devMiddleware</span>.<span class="at">outputFileSystem</span><span class="op">;</span></a>
<a class="sourceLine" id="cb11-26" title="26">  <span class="kw">const</span> jsonWebpackStats <span class="op">=</span> <span class="va">devMiddleware</span>.<span class="va">stats</span>.<span class="at">toJson</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb11-27" title="27">  <span class="kw">const</span> <span class="op">{</span> assetsByChunkName<span class="op">,</span> outputPath <span class="op">}</span> <span class="op">=</span> jsonWebpackStats<span class="op">;</span></a>
<a class="sourceLine" id="cb11-28" title="28"></a>
<a class="sourceLine" id="cb11-29" title="29">  <span class="co">// Then use `assetsByChunkName` for server-side rendering</span></a>
<a class="sourceLine" id="cb11-30" title="30">  <span class="co">// For example, if you have only one main chunk:</span></a>
<a class="sourceLine" id="cb11-31" title="31">  <span class="va">res</span>.<span class="at">send</span>(<span class="vs">`</span></a>
<a class="sourceLine" id="cb11-32" title="32"><span class="vs">&lt;html&gt;</span></a>
<a class="sourceLine" id="cb11-33" title="33"><span class="vs">  &lt;head&gt;</span></a>
<a class="sourceLine" id="cb11-34" title="34"><span class="vs">    &lt;title&gt;My App&lt;/title&gt;</span></a>
<a class="sourceLine" id="cb11-35" title="35"><span class="vs">    &lt;style&gt;</span></a>
<a class="sourceLine" id="cb11-36" title="36"><span class="vs">    </span><span class="sc">${</span><span class="at">normalizeAssets</span>(<span class="va">assetsByChunkName</span>.<span class="at">main</span>)</a>
<a class="sourceLine" id="cb11-37" title="37">      .<span class="at">filter</span>((path) <span class="kw">=&gt;</span> <span class="va">path</span>.<span class="at">endsWith</span>(<span class="st">&quot;.css&quot;</span>))</a>
<a class="sourceLine" id="cb11-38" title="38">      .<span class="at">map</span>((path) <span class="kw">=&gt;</span> <span class="va">outputFileSystem</span>.<span class="at">readFileSync</span>(<span class="va">path</span>.<span class="at">join</span>(outputPath<span class="op">,</span> path)))</a>
<a class="sourceLine" id="cb11-39" title="39">      .<span class="at">join</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">}</span></a>
<a class="sourceLine" id="cb11-40" title="40"><span class="vs">    &lt;/style&gt;</span></a>
<a class="sourceLine" id="cb11-41" title="41"><span class="vs">  &lt;/head&gt;</span></a>
<a class="sourceLine" id="cb11-42" title="42"><span class="vs">  &lt;body&gt;</span></a>
<a class="sourceLine" id="cb11-43" title="43"><span class="vs">    &lt;div id=&quot;root&quot;&gt;&lt;/div&gt;</span></a>
<a class="sourceLine" id="cb11-44" title="44"><span class="vs">    </span><span class="sc">${</span><span class="at">normalizeAssets</span>(<span class="va">assetsByChunkName</span>.<span class="at">main</span>)</a>
<a class="sourceLine" id="cb11-45" title="45">      .<span class="at">filter</span>((path) <span class="kw">=&gt;</span> <span class="va">path</span>.<span class="at">endsWith</span>(<span class="st">&quot;.js&quot;</span>))</a>
<a class="sourceLine" id="cb11-46" title="46">      .<span class="at">map</span>((path) <span class="kw">=&gt;</span> <span class="vs">`&lt;script src=&quot;</span><span class="sc">${</span>path<span class="sc">}</span><span class="vs">&quot;&gt;&lt;/script&gt;`</span>)</a>
<a class="sourceLine" id="cb11-47" title="47">      .<span class="at">join</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)<span class="sc">}</span></a>
<a class="sourceLine" id="cb11-48" title="48"><span class="vs">  &lt;/body&gt;</span></a>
<a class="sourceLine" id="cb11-49" title="49"><span class="vs">&lt;/html&gt;</span></a>
<a class="sourceLine" id="cb11-50" title="50"><span class="vs">  `</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-51" title="51"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="support">Support</h2>
<p>We do our best to keep Issues in the repository focused on bugs, features, and needed modifications to the code for the module. Because of that, we ask users with general support, “how-to”, or “why isn’t this working” questions to try one of the other support channels that are available.</p>
<p>Your first-stop-shop for support for webpack-dev-server should by the excellent <a href="https://webpack.js.org/guides/development/#using-webpack-dev-middleware">documentation</a> for the module. If you see an opportunity for improvement of those docs, please head over to the <a href="https://github.com/webpack/webpack.js.org">webpack.js.org repo</a> and open a pull request.</p>
<p>From there, we encourage users to visit the <a href="https://gitter.im/webpack/webpack">webpack Gitter chat</a> and talk to the fine folks there. If your quest for answers comes up dry in chat, head over to <a href="https://stackoverflow.com/questions/tagged/webpack-dev-middleware">StackOverflow</a> and do a quick search or open a new question. Remember; It’s always much easier to answer questions that include your <code>webpack.config.js</code> and relevant files!</p>
<p>If you’re twitter-savvy you can tweet <a href="https://twitter.com/search?q=webpack">#webpack</a> with your question and someone should be able to reach out and lend a hand.</p>
<p>If you have discovered a :bug:, have a feature suggestion, or would like to see a modification, please feel free to create an issue on Github. <em>Note: The issue template isn’t optional, so please be sure not to remove it, and please fill it out completely.</em></p>
<h2 id="other-servers">Other servers</h2>
<p>Examples of use with other servers will follow here.</p>
<h3 id="fastify">Fastify</h3>
<p>Fastify interop will require the use of <code>fastify-express</code> instead of <code>middie</code> for providing middleware support. As the authors of <code>fastify-express</code> recommend, this should only be used as a stopgap while full Fastify support is worked on.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">const</span> fastify <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;fastify&quot;</span>)()<span class="op">;</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">const</span> webpack <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">const</span> webpackConfig <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;./webpack.config.js&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">const</span> devMiddleware <span class="op">=</span> <span class="at">require</span>(<span class="st">&quot;webpack-dev-middleware&quot;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw">const</span> compiler <span class="op">=</span> <span class="at">webpack</span>(webpackConfig)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">const</span> <span class="op">{</span> publicPath <span class="op">}</span> <span class="op">=</span> <span class="va">webpackConfig</span>.<span class="at">output</span><span class="op">;</span></a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9">(<span class="kw">async</span> () <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb12-10" title="10">  <span class="cf">await</span> <span class="va">fastify</span>.<span class="at">register</span>(<span class="at">require</span>(<span class="st">&quot;fastify-express&quot;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb12-11" title="11">  <span class="cf">await</span> <span class="va">fastify</span>.<span class="at">use</span>(<span class="at">devMiddleware</span>(compiler<span class="op">,</span> <span class="op">{</span> publicPath <span class="op">}</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb12-12" title="12">  <span class="cf">await</span> <span class="va">fastify</span>.<span class="at">listen</span>(<span class="dv">3000</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-13" title="13"><span class="op">}</span>)()<span class="op">;</span></a></code></pre></div>
<h2 id="contributing">Contributing</h2>
<p>Please take a moment to read our contributing guidelines if you haven’t yet done so.</p>
<p><a href="./CONTRIBUTING.md">CONTRIBUTING</a></p>
<h2 id="license">License</h2>
<p><a href="./LICENSE">MIT</a></p>
</body>
</html>
