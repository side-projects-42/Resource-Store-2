<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>readme</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<div data-align="center">
<p><img src="logo.png" alt="klona" height="100" /></p>
</div>
<div data-align="center">
<p><a href="https://npmjs.org/package/klona"> <img src="https://badgen.now.sh/npm/v/klona" alt="version" /> </a> <a href="https://github.com/lukeed/klona/actions"> <img src="https://github.com/lukeed/klona/workflows/CI/badge.svg" alt="CI" /> </a> <a href="https://npmjs.org/package/klona"> <img src="https://badgen.now.sh/npm/dm/klona" alt="downloads" /> </a> <a href="https://codecov.io/gh/lukeed/klona"> <img src="https://codecov.io/gh/lukeed/klona/branch/master/graph/badge.svg?token=8ej0WeKqz7" alt="codecov" /> </a></p>
</div>
<div data-align="center">
A tiny (240B to 501B) and fast utility to “deep clone” Objects, Arrays, Dates, RegExps, and more!
</div>
<h2 id="features">Features</h2>
<ul>
<li>Super tiny and <a href="#benchmarks">performant</a></li>
<li>Deep clone / recursive copies</li>
<li>Safely handles complex data types<br> <em>Array, Date, Map, Object, RegExp, Set, TypedArray, and more</em></li>
</ul>
<p>Unlike a “shallow copy” (eg, <code>Object.assign</code>), a “deep clone” recursively traverses a source input and copies its <em>values</em> — instead of <em>references</em> to its values — into a new instance of that input. The result is a structurally equivalent clone that operates independently of the original source and controls its own values.</p>
<blockquote>
<p><strong>Why “klona”?</strong> It’s “clone” in Swedish.<br> <strong>What’s with the sheep?</strong> <a href="https://en.wikipedia.org/wiki/Dolly_(sheep)">Dolly</a>.</p>
</blockquote>
<h2 id="install">Install</h2>
<pre><code>$ npm install --save klona</code></pre>
<h2 id="modes">Modes</h2>
<p>There are multiple “versions” of <code>klona</code> available, which allows you to bring only the functionality you need!</p>
<h4 id="klonajson"><code>klona/json</code></h4>
<blockquote>
<p><strong>Size (gzip):</strong> 240 bytes<br> <strong>Availability:</strong> <a href="https://unpkg.com/klona/json/index.js">CommonJS</a>, <a href="https://unpkg.com/klona/json/index.mjs">ES Module</a>, <a href="https://unpkg.com/klona/json/index.min.js">UMD</a><br> <strong>Ability:</strong> JSON data types</p>
</blockquote>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="im">import</span> <span class="op">{</span> klona <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;klona/json&#39;</span><span class="op">;</span></a></code></pre></div>
<h4 id="klonalite"><code>klona/lite</code></h4>
<blockquote>
<p><strong>Size (gzip):</strong> 354 bytes<br> <strong>Availability:</strong> <a href="https://unpkg.com/klona/lite/index.js">CommonJS</a>, <a href="https://unpkg.com/klona/lite/index.mjs">ES Module</a>, <a href="https://unpkg.com/klona/lite/index.min.js">UMD</a><br> <strong>Ability:</strong> extends <code>klona/json</code> with support for custom class, Date, and RegExp</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="im">import</span> <span class="op">{</span> klona <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;klona/lite&#39;</span><span class="op">;</span></a></code></pre></div>
<h4 id="klona"><code>klona</code></h4>
<blockquote>
<p><strong>Size (gzip):</strong> 451 bytes<br> <strong>Availability:</strong> <a href="https://unpkg.com/klona/dist/index.js">CommonJS</a>, <a href="https://unpkg.com/klona/dist/index.mjs">ES Module</a>, <a href="https://unpkg.com/klona/dist/index.min.js">UMD</a><br> <strong>Ability:</strong> extends <code>klona/lite</code> with support for Map, Set, DataView, ArrayBuffer, TypedArray</p>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="im">import</span> <span class="op">{</span> klona <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;klona&#39;</span><span class="op">;</span></a></code></pre></div>
<h4 id="klonafull"><code>klona/full</code></h4>
<blockquote>
<p><strong>Size (gzip):</strong> 501 bytes<br> <strong>Availability:</strong> <a href="https://unpkg.com/klona/full/index.js">CommonJS</a>, <a href="https://unpkg.com/klona/full/index.mjs">ES Module</a>, <a href="https://unpkg.com/klona/full/index.min.js">UMD</a><br> <strong>Ability:</strong> extends <code>klona</code> with support for Symbol properties and and non-enumerable properties</p>
</blockquote>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="im">import</span> <span class="op">{</span> klona <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;klona/full&#39;</span><span class="op">;</span></a></code></pre></div>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="im">import</span> <span class="op">{</span> klona <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;klona&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">const</span> input <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="dt">foo</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="dt">bar</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-6" title="6">    <span class="dt">baz</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-7" title="7">    <span class="dt">bat</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-8" title="8">      <span class="dt">hello</span><span class="op">:</span> <span class="st">&#39;world&#39;</span></a>
<a class="sourceLine" id="cb6-9" title="9">    <span class="op">}</span></a>
<a class="sourceLine" id="cb6-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="op">};</span></a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="kw">const</span> output <span class="op">=</span> <span class="at">klona</span>(input)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-14" title="14"></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="co">// exact copy of original</span></a>
<a class="sourceLine" id="cb6-16" title="16"><span class="va">assert</span>.<span class="at">deepStrictEqual</span>(input<span class="op">,</span> output)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-17" title="17"></a>
<a class="sourceLine" id="cb6-18" title="18"><span class="co">// applying deep updates...</span></a>
<a class="sourceLine" id="cb6-19" title="19"><span class="va">output</span>.<span class="va">bar</span>.<span class="va">bat</span>.<span class="at">hola</span> <span class="op">=</span> <span class="st">&#39;mundo&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-20" title="20"><span class="va">output</span>.<span class="va">bar</span>.<span class="at">baz</span> <span class="op">=</span> <span class="dv">99</span><span class="op">;</span></a>
<a class="sourceLine" id="cb6-21" title="21"></a>
<a class="sourceLine" id="cb6-22" title="22"><span class="co">// ...doesn&#39;t affect source!</span></a>
<a class="sourceLine" id="cb6-23" title="23"><span class="va">console</span>.<span class="at">log</span>(</a>
<a class="sourceLine" id="cb6-24" title="24">  <span class="va">JSON</span>.<span class="at">stringify</span>(input<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-25" title="25">)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-26" title="26"><span class="co">// {</span></a>
<a class="sourceLine" id="cb6-27" title="27"><span class="co">//   &quot;foo&quot;: 1,</span></a>
<a class="sourceLine" id="cb6-28" title="28"><span class="co">//   &quot;bar&quot;: {</span></a>
<a class="sourceLine" id="cb6-29" title="29"><span class="co">//     &quot;baz&quot;: 2,</span></a>
<a class="sourceLine" id="cb6-30" title="30"><span class="co">//     &quot;bat&quot;: {</span></a>
<a class="sourceLine" id="cb6-31" title="31"><span class="co">//       &quot;hello&quot;: &quot;world&quot;</span></a>
<a class="sourceLine" id="cb6-32" title="32"><span class="co">//     }</span></a>
<a class="sourceLine" id="cb6-33" title="33"><span class="co">//   }</span></a>
<a class="sourceLine" id="cb6-34" title="34"><span class="co">// }</span></a></code></pre></div>
<h2 id="api">API</h2>
<h3 id="klonainput">klona(input)</h3>
<p>Returns: <code>typeof input</code></p>
<p>Returns a deep copy/clone of the input.</p>
<h2 id="benchmarks">Benchmarks</h2>
<blockquote>
<p>Running Node v12.18.3</p>
</blockquote>
<p>The benchmarks can be found in the <a href="/bench"><code>/bench</code></a> directory. They are separated into multiple categories:</p>
<ul>
<li><code>JSON</code> – compares an array of objects comprised of JSON data types (<code>String</code>, <code>Number</code>, <code>null</code>, <code>Array</code>, <code>Object</code>)</li>
<li><code>LITE</code> – like <code>JSON</code>, but adds <code>RegExp</code>, <code>Date</code> and <code>undefined</code> values</li>
<li><code>DEFAULT</code> – object with <code>RegExp</code>, <code>Date</code>, <code>Array</code>, <code>Map</code>, <code>Set</code>, custom class, <code>Int8Array</code>, <code>DataView</code>, <code>Buffer</code> values</li>
<li><code>FULL</code> – like <code>DEFAULT</code>, but adds <code>Symbol</code> and non-enumerable properties</li>
</ul>
<blockquote>
<p><strong>Important:</strong> Only candidates that pass validation step(s) are listed. <br>However, <code>lodash</code> and <code>clone</code> are kept to highlight important differences.</p>
</blockquote>
<blockquote>
<p><strong>Note:</strong> The <code>clone/include</code> candidate refers to its <a href="https://www.npmjs.com/package/clone#api"><code>includeNonEnumerable</code> option</a> enabled.</p>
</blockquote>
<pre><code>Load times:
  lodash/clonedeep   29.257ms
  rfdc                0.511ms
  clone               0.576ms
  clone-deep          2.494ms
  deep-copy           0.451ms
  klona/full          0.408ms
  klona               0.265ms
  klona/lite          0.308ms
  klona/json          0.263ms

Benchmark :: JSON
  JSON.stringify      x   53,899 ops/sec ±0.76% (92 runs sampled)
  lodash              x   46,800 ops/sec ±0.86% (90 runs sampled)
  rfdc                x  221,456 ops/sec ±0.88% (92 runs sampled)
  clone               x   39,537 ops/sec ±0.68% (92 runs sampled)
  clone/include       x   25,488 ops/sec ±1.06% (88 runs sampled)
  clone-deep          x   99,998 ops/sec ±0.91% (93 runs sampled)
  deep-copy           x  141,270 ops/sec ±0.95% (92 runs sampled)
  klona/full          x   55,016 ops/sec ±0.68% (94 runs sampled)
  klona               x  281,215 ops/sec ±0.77% (93 runs sampled)
  klona/lite          x  318,481 ops/sec ±0.72% (91 runs sampled)
  klona/json          x  334,932 ops/sec ±0.66% (93 runs sampled)

Benchmark :: LITE
  lodash              x   36,992 ops/sec ±0.65% (91 runs sampled)
  clone               x   35,974 ops/sec ±1.13% (88 runs sampled)
  clone/include       x   22,609 ops/sec ±1.02% (91 runs sampled)
  clone-deep          x   92,846 ops/sec ±0.66% (93 runs sampled)
  klona/full          x   47,873 ops/sec ±0.83% (88 runs sampled)
  klona               x  226,638 ops/sec ±1.16% (93 runs sampled)
  klona/lite          x  257,900 ops/sec ±0.82% (93 runs sampled)

Benchmark :: DEFAULT
  lodash              x   55,914 ops/sec ±0.75% (93 runs sampled)
    ✘ Buffer
    ✘ Map keys
  clone               x   92,127 ops/sec ±0.83% (94 runs sampled)
    ✘ DataView
  clone/include       x   62,052 ops/sec ±0.88% (93 runs sampled)
    ✘ DataView
  klona/full          x   90,308 ops/sec ±0.68% (89 runs sampled)
  klona               x  230,257 ops/sec ±0.71% (91 runs sampled)

Benchmark :: FULL
  lodash              x   60,361 ops/sec ±0.65% (91 runs sampled)
    ✘ Buffer
    ✘ Map keys
    ✘ Missing non-enumerable Properties
  clone/include       x   47,263 ops/sec ±0.85% (93 runs sampled)
    ✘ DataView
    ✘ Incorrect non-enumerable Properties
  klona/full          x   82,346 ops/sec ±0.62% (93 runs sampled)</code></pre>
<h2 id="related">Related</h2>
<ul>
<li><a href="https://github.com/developit/dlv">dlv</a> – safely <strong>read</strong> from deep properties in 120 bytes</li>
<li><a href="https://github.com/lukeed/dset">dset</a> – safely <strong>write</strong> into deep properties in 160 bytes</li>
<li><a href="https://github.com/lukeed/dequal">dequal</a> – safely check for deep equality in 304 to 489 bytes</li>
</ul>
<h2 id="license">License</h2>
<p>MIT © <a href="https://lukeed.com">Luke Edwards</a></p>
</body>
</html>
