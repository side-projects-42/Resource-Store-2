<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="rc">rc</h1>
<p>The non-configurable configuration loader for lazy people.</p>
<h2 id="usage">Usage</h2>
<p>The only option is to pass rc the name of your app, and your default configuration.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">var</span> conf <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;rc&#39;</span>)(appname<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="co">//defaults go here.</span></a>
<a class="sourceLine" id="cb1-3" title="3">  <span class="dt">port</span><span class="op">:</span> <span class="dv">2468</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">  <span class="co">//defaults which are objects will be merged, not replaced</span></a>
<a class="sourceLine" id="cb1-6" title="6">  <span class="dt">views</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-7" title="7">    <span class="dt">engine</span><span class="op">:</span> <span class="st">&#39;jade&#39;</span></a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="op">}</span></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p><code>rc</code> will return your configuration options merged with the defaults you specify. If you pass in a predefined defaults object, it will be mutated:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> conf <span class="op">=</span> <span class="op">{};</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="at">require</span>(<span class="st">&#39;rc&#39;</span>)(appname<span class="op">,</span> conf)<span class="op">;</span></a></code></pre></div>
<p>If <code>rc</code> finds any config files for your app, the returned config object will have a <code>configs</code> array containing their paths:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">var</span> appCfg <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;rc&#39;</span>)(appname<span class="op">,</span> conf)<span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="va">appCfg</span>.<span class="at">configs</span>[<span class="dv">0</span>] <span class="co">// /etc/appnamerc</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="va">appCfg</span>.<span class="at">configs</span>[<span class="dv">1</span>] <span class="co">// /home/dominictarr/.config/appname</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="va">appCfg</span>.<span class="at">config</span> <span class="co">// same as appCfg.configs[appCfg.configs.length - 1]</span></a></code></pre></div>
<h2 id="standards">Standards</h2>
<p>Given your application name (<code>appname</code>), rc will look in all the obvious places for configuration.</p>
<ul>
<li>command line arguments, parsed by minimist <em>(e.g. <code>--foo baz</code>, also nested: <code>--foo.bar=baz</code>)</em></li>
<li>environment variables prefixed with <code>${appname}_</code>
<ul>
<li>or use “__” to indicate nested properties <br/> <em>(e.g. <code>appname_foo__bar__baz</code> =&gt; <code>foo.bar.baz</code>)</em></li>
</ul></li>
<li>if you passed an option <code>--config file</code> then from that file</li>
<li>a local <code>.${appname}rc</code> or the first found looking in <code>./ ../ ../../ ../../../</code> etc.</li>
<li><code>$HOME/.${appname}rc</code></li>
<li><code>$HOME/.${appname}/config</code></li>
<li><code>$HOME/.config/${appname}</code></li>
<li><code>$HOME/.config/${appname}/config</code></li>
<li><code>/etc/${appname}rc</code></li>
<li><code>/etc/${appname}/config</code></li>
<li>the defaults object you passed in.</li>
</ul>
<p>All configuration sources that were found will be flattened into one object, so that sources <strong>earlier</strong> in this list override later ones.</p>
<h2 id="configuration-file-formats">Configuration File Formats</h2>
<p>Configuration files (e.g. <code>.appnamerc</code>) may be in either <a href="http://json.org/example">json</a> or <a href="http://en.wikipedia.org/wiki/INI_file">ini</a> format. <strong>No</strong> file extension (<code>.json</code> or <code>.ini</code>) should be used. The example configurations below are equivalent:</p>
<h4 id="formatted-as-ini">Formatted as <code>ini</code></h4>
<pre><code>; You can include comments in `ini` format if you want.

dependsOn=0.10.0


; `rc` has built-in support for ini sections, see?

[commands]
  www     = ./commands/www
  console = ./commands/repl


; You can even do nested sections

[generators.options]
  engine  = ejs

[generators.modules]
  new     = generate-new
  engine  = generate-backend
</code></pre>
<h4 id="formatted-as-json">Formatted as <code>json</code></h4>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="op">{</span></a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="co">// You can even comment your JSON, if you want</span></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="st">&quot;dependsOn&quot;</span><span class="op">:</span> <span class="st">&quot;0.10.0&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="st">&quot;commands&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="st">&quot;www&quot;</span><span class="op">:</span> <span class="st">&quot;./commands/www&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="st">&quot;console&quot;</span><span class="op">:</span> <span class="st">&quot;./commands/repl&quot;</span></a>
<a class="sourceLine" id="cb5-7" title="7">  <span class="op">},</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="st">&quot;generators&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-9" title="9">    <span class="st">&quot;options&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-10" title="10">      <span class="st">&quot;engine&quot;</span><span class="op">:</span> <span class="st">&quot;ejs&quot;</span></a>
<a class="sourceLine" id="cb5-11" title="11">    <span class="op">},</span></a>
<a class="sourceLine" id="cb5-12" title="12">    <span class="st">&quot;modules&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-13" title="13">      <span class="st">&quot;new&quot;</span><span class="op">:</span> <span class="st">&quot;generate-new&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-14" title="14">      <span class="st">&quot;backend&quot;</span><span class="op">:</span> <span class="st">&quot;generate-backend&quot;</span></a>
<a class="sourceLine" id="cb5-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb5-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="op">}</span></a></code></pre></div>
<p>Comments are stripped from JSON config via <a href="https://github.com/sindresorhus/strip-json-comments">strip-json-comments</a>.</p>
<blockquote>
<p>Since ini, and env variables do not have a standard for types, your application needs be prepared for strings.</p>
</blockquote>
<p>To ensure that string representations of booleans and numbers are always converted into their proper types (especially useful if you intend to do strict <code>===</code> comparisons), consider using a module such as <a href="https://github.com/anselanza/parse-strings-in-object">parse-strings-in-object</a> to wrap the config object returned from rc.</p>
<h2 id="simple-example-demonstrating-precedence">Simple example demonstrating precedence</h2>
<p>Assume you have an application like this (notice the hard-coded defaults passed to rc):</p>
<pre><code>const conf = require(&#39;rc&#39;)(&#39;myapp&#39;, {
    port: 12345,
    mode: &#39;test&#39;
});

console.log(JSON.stringify(conf, null, 2));</code></pre>
<p>You also have a file <code>config.json</code>, with these contents:</p>
<pre><code>{
  &quot;port&quot;: 9000,
  &quot;foo&quot;: &quot;from config json&quot;,
  &quot;something&quot;: &quot;else&quot;
}</code></pre>
<p>And a file <code>.myapprc</code> in the same folder, with these contents:</p>
<pre><code>{
  &quot;port&quot;: &quot;3001&quot;,
  &quot;foo&quot;: &quot;bar&quot;
}</code></pre>
<p>Here is the expected output from various commands:</p>
<p><code>node .</code></p>
<pre><code>{
  &quot;port&quot;: &quot;3001&quot;,
  &quot;mode&quot;: &quot;test&quot;,
  &quot;foo&quot;: &quot;bar&quot;,
  &quot;_&quot;: [],
  &quot;configs&quot;: [
    &quot;/Users/stephen/repos/conftest/.myapprc&quot;
  ],
  &quot;config&quot;: &quot;/Users/stephen/repos/conftest/.myapprc&quot;
}</code></pre>
<p><em>Default <code>mode</code> from hard-coded object is retained, but port is overridden by <code>.myapprc</code> file (automatically found based on appname match), and <code>foo</code> is added.</em></p>
<p><code>node . --foo baz</code></p>
<pre><code>{
  &quot;port&quot;: &quot;3001&quot;,
  &quot;mode&quot;: &quot;test&quot;,
  &quot;foo&quot;: &quot;baz&quot;,
  &quot;_&quot;: [],
  &quot;configs&quot;: [
    &quot;/Users/stephen/repos/conftest/.myapprc&quot;
  ],
  &quot;config&quot;: &quot;/Users/stephen/repos/conftest/.myapprc&quot;
}</code></pre>
<p><em>Same result as above but <code>foo</code> is overridden because command-line arguments take precedence over <code>.myapprc</code> file.</em></p>
<p><code>node . --foo barbar --config config.json</code></p>
<pre><code>{
  &quot;port&quot;: 9000,
  &quot;mode&quot;: &quot;test&quot;,
  &quot;foo&quot;: &quot;barbar&quot;,
  &quot;something&quot;: &quot;else&quot;,
  &quot;_&quot;: [],
  &quot;config&quot;: &quot;config.json&quot;,
  &quot;configs&quot;: [
    &quot;/Users/stephen/repos/conftest/.myapprc&quot;,
    &quot;config.json&quot;
  ]
}</code></pre>
<p><em>Now the <code>port</code> comes from the <code>config.json</code> file specified (overriding the value from <code>.myapprc</code>), and <code>foo</code> value is overriden by command-line despite also being specified in the <code>config.json</code> file.</em></p>
<h2 id="advanced-usage">Advanced Usage</h2>
<h4 id="pass-in-your-own-argv">Pass in your own <code>argv</code></h4>
<p>You may pass in your own <code>argv</code> as the third argument to <code>rc</code>. This is in case you want to <a href="https://github.com/dominictarr/rc/pull/12">use your own command-line opts parser</a>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="at">require</span>(<span class="st">&#39;rc&#39;</span>)(appname<span class="op">,</span> defaults<span class="op">,</span> customArgvParser)<span class="op">;</span></a></code></pre></div>
<h2 id="pass-in-your-own-parser">Pass in your own parser</h2>
<p>If you have a special need to use a non-standard parser, you can do so by passing in the parser as the 4th argument. (leave the 3rd as null to get the default args parser)</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="at">require</span>(<span class="st">&#39;rc&#39;</span>)(appname<span class="op">,</span> defaults<span class="op">,</span> <span class="kw">null</span><span class="op">,</span> parser)<span class="op">;</span></a></code></pre></div>
<p>This may also be used to force a more strict format, such as strict, valid JSON only.</p>
<h2 id="note-on-performance">Note on Performance</h2>
<p><code>rc</code> is running <code>fs.statSync</code>– so make sure you don’t use it in a hot code path (e.g. a request handler)</p>
<h2 id="license">License</h2>
<p>Multi-licensed under the two-clause BSD License, MIT License, or Apache License, version 2.0</p>
</body>
</html>
