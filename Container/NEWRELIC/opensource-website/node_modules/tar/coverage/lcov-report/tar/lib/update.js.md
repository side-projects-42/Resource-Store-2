[All files](../../index.html) / [tar/lib](index.html) update.js
===============================================================

<span class="strong">100% </span> <span class="quiet">Statements</span> <span class="fraction">20/20</span>

<span class="strong">100% </span> <span class="quiet">Branches</span> <span class="fraction">15/15</span>

<span class="strong">100% </span> <span class="quiet">Functions</span> <span class="fraction">4/4</span>

<span class="strong">100% </span> <span class="quiet">Lines</span> <span class="fraction">20/20</span>

    1
    2
    3
    4
    5
    6
    7
    8
    9
    10
    11
    12
    13
    14
    15
    16
    17
    18
    19
    20
    21
    22
    23
    24
    25
    26
    27
    28
    29
    30
    31
    32
    33
    34
    35
    36
    37

<span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">2x</span> <span class="cline-any cline-yes">2x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">2x</span> <span class="cline-any cline-yes">36x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">36x</span> <span class="cline-any cline-yes">1x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">35x</span> <span class="cline-any cline-yes">1x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">34x</span> <span class="cline-any cline-yes">1x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">2x</span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-yes">32x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-yes">33x</span> <span class="cline-any cline-yes">2x</span> <span class="cline-any cline-yes">24x</span> <span class="cline-any cline-neutral"> </span> <span class="cline-any cline-neutral"> </span>

    'use strict'
     
    // tar -u
     
    const hlo = require('./high-level-opt.js')
    const r = require('./replace.js')
    // just call tar.r with the filter and mtimeCache
     
    const u = module.exports = (opt_, files, cb) => {
      const opt = hlo(opt_)
     
      if (!opt.file)
        throw new TypeError('file is required')
     
      if (opt.gzip)
        throw new TypeError('cannot append to compressed archives')
     
      if (!files || !Array.isArray(files) || !files.length)
        throw new TypeError('no files or directories specified')
     
      files = Array.from(files)
     
      mtimeFilter(opt)
      return r(opt, files, cb)
    }
     
    const mtimeFilter = opt => {
      const filter = opt.filter
     
      if (!opt.mtimeCache)
        opt.mtimeCache = new Map()
     
      opt.filter = filter ? (path, stat) =>
        filter(path, stat) && !(opt.mtimeCache.get(path) > stat.mtime)
        : (path, stat) => !(opt.mtimeCache.get(path) > stat.mtime)
    }
     

Code coverage generated by [istanbul](https://istanbul.js.org/) at Mon Nov 20 2017 16:00:38 GMT-0800 (PST)
