<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="jest-diff">jest-diff</h1>
<p>Display differences clearly so people can review changes confidently.</p>
<p>The default export serializes JavaScript <strong>values</strong>, compares them line-by-line, and returns a string which includes comparison lines.</p>
<p>Two named exports compare <strong>strings</strong> character-by-character:</p>
<ul>
<li><code>diffStringsUnified</code> returns a string.</li>
<li><code>diffStringsRaw</code> returns an array of <code>Diff</code> objects.</li>
</ul>
<p>Three named exports compare <strong>arrays of strings</strong> line-by-line:</p>
<ul>
<li><code>diffLinesUnified</code> and <code>diffLinesUnified2</code> return a string.</li>
<li><code>diffLinesRaw</code> returns an array of <code>Diff</code> objects.</li>
</ul>
<h2 id="installation">Installation</h2>
<p>To add this package as a dependency of a project, run either of the following commands:</p>
<ul>
<li><code>npm install jest-diff</code></li>
<li><code>yarn add jest-diff</code></li>
</ul>
<h2 id="usage-of-default-export">Usage of default export</h2>
<p>Given JavaScript <strong>values</strong>, <code>diffDefault(a, b, options?)</code> does the following:</p>
<ol type="1">
<li><strong>serialize</strong> the values as strings using the <code>pretty-format</code> package</li>
<li><strong>compare</strong> the strings line-by-line using the <code>diff-sequences</code> package</li>
<li><strong>format</strong> the changed or common lines using the <code>chalk</code> package</li>
</ol>
<p>To use this function, write either of the following:</p>
<ul>
<li><code>const diffDefault = require('jest-diff').default;</code> in CommonJS modules</li>
<li><code>import diffDefault from 'jest-diff';</code> in ECMAScript modules</li>
</ul>
<h3 id="example-of-default-export">Example of default export</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">const</span> a <span class="op">=</span> [<span class="st">&#39;delete&#39;</span><span class="op">,</span> <span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed from&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">const</span> b <span class="op">=</span> [<span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="st">&#39;insert&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffDefault</span>(a<span class="op">,</span> b)<span class="op">;</span></a></code></pre></div>
<p>The returned <strong>string</strong> consists of:</p>
<ul>
<li>annotation lines: describe the two change indicators with labels, and a blank line</li>
<li>comparison lines: similar to “unified” view on GitHub, but <code>Expected</code> lines are green, <code>Received</code> lines are red, and common lines are dim (by default, see Options)</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb2-1" title="1"><span class="st">- Expected</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">+ Received</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">  Array [</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="st">-   &quot;delete&quot;,</span></a>
<a class="sourceLine" id="cb2-6" title="6">    &quot;common&quot;,</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="st">-   &quot;changed from&quot;,</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="va">+   &quot;changed to&quot;,</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="va">+   &quot;insert&quot;,</span></a>
<a class="sourceLine" id="cb2-10" title="10">  ]</a></code></pre></div>
<h3 id="edge-cases-of-default-export">Edge cases of default export</h3>
<p>Here are edge cases for the return value:</p>
<ul>
<li><code>' Comparing two different types of values. …'</code> if the arguments have <strong>different types</strong> according to the <code>jest-get-type</code> package (instances of different classes have the same <code>'object'</code> type)</li>
<li><code>'Compared values have no visual difference.'</code> if the arguments have either <strong>referential identity</strong> according to <code>Object.is</code> method or <strong>same serialization</strong> according to the <code>pretty-format</code> package</li>
<li><code>null</code> if either argument is a so-called <strong>asymmetric matcher</strong> in Jasmine or Jest</li>
</ul>
<h2 id="usage-of-diffstringsunified">Usage of diffStringsUnified</h2>
<p>Given <strong>strings</strong>, <code>diffStringsUnified(a, b, options?)</code> does the following:</p>
<ol type="1">
<li><strong>compare</strong> the strings character-by-character using the <code>diff-sequences</code> package</li>
<li><strong>clean up</strong> small (often coincidental) common substrings, also known as chaff</li>
<li><strong>format</strong> the changed or common lines using the <code>chalk</code> package</li>
</ol>
<p>Although the function is mainly for <strong>multiline</strong> strings, it compares any strings.</p>
<p>Write either of the following:</p>
<ul>
<li><code>const {diffStringsUnified} = require('jest-diff');</code> in CommonJS modules</li>
<li><code>import {diffStringsUnified} from 'jest-diff';</code> in ECMAScript modules</li>
</ul>
<h3 id="example-of-diffstringsunified">Example of diffStringsUnified</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">const</span> a <span class="op">=</span> <span class="st">&#39;common</span><span class="sc">\n</span><span class="st">changed from&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">const</span> b <span class="op">=</span> <span class="st">&#39;common</span><span class="sc">\n</span><span class="st">changed to&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffStringsUnified</span>(a<span class="op">,</span> b)<span class="op">;</span></a></code></pre></div>
<p>The returned <strong>string</strong> consists of:</p>
<ul>
<li>annotation lines: describe the two change indicators with labels, and a blank line</li>
<li>comparison lines: similar to “unified” view on GitHub, and <strong>changed substrings</strong> have <strong>inverse</strong> foreground and background colors (that is, <code>from</code> has white-on-green and <code>to</code> has white-on-red, which the following example does not show)</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb4-1" title="1"><span class="st">- Expected</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="va">+ Received</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4">  common</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="st">- changed from</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="va">+ changed to</span></a></code></pre></div>
<h3 id="performance-of-diffstringsunified">Performance of diffStringsUnified</h3>
<p>To get the benefit of <strong>changed substrings</strong> within the comparison lines, a character-by-character comparison has a higher computational cost (in time and space) than a line-by-line comparison.</p>
<p>If the input strings can have <strong>arbitrary length</strong>, we recommend that the calling code set a limit, beyond which splits the strings, and then calls <code>diffLinesUnified</code> instead. For example, Jest falls back to line-by-line comparison if either string has length greater than 20K characters.</p>
<h2 id="usage-of-difflinesunified">Usage of diffLinesUnified</h2>
<p>Given <strong>arrays of strings</strong>, <code>diffLinesUnified(aLines, bLines, options?)</code> does the following:</p>
<ol type="1">
<li><strong>compare</strong> the arrays line-by-line using the <code>diff-sequences</code> package</li>
<li><strong>format</strong> the changed or common lines using the <code>chalk</code> package</li>
</ol>
<p>You might call this function when strings have been split into lines and you do not need to see changed substrings within lines.</p>
<h3 id="example-of-difflinesunified">Example of diffLinesUnified</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> aLines <span class="op">=</span> [<span class="st">&#39;delete&#39;</span><span class="op">,</span> <span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed from&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw">const</span> bLines <span class="op">=</span> [<span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="st">&#39;insert&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb5-3" title="3"></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffLinesUnified</span>(aLines<span class="op">,</span> bLines)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb6-1" title="1"><span class="st">- Expected</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="va">+ Received</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="st">- delete</span></a>
<a class="sourceLine" id="cb6-5" title="5">  common</a>
<a class="sourceLine" id="cb6-6" title="6"><span class="st">- changed from</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="va">+ changed to</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="va">+ insert</span></a></code></pre></div>
<h3 id="edge-cases-of-difflinesunified-or-diffstringsunified">Edge cases of diffLinesUnified or diffStringsUnified</h3>
<p>Here are edge cases for arguments and return values:</p>
<ul>
<li>both <code>a</code> and <code>b</code> are empty strings: no comparison lines</li>
<li>only <code>a</code> is empty string: all comparison lines have <code>bColor</code> and <code>bIndicator</code> (see Options)</li>
<li>only <code>b</code> is empty string: all comparison lines have <code>aColor</code> and <code>aIndicator</code> (see Options)</li>
<li><code>a</code> and <code>b</code> are equal non-empty strings: all comparison lines have <code>commonColor</code> and <code>commonIndicator</code> (see Options)</li>
</ul>
<h2 id="usage-of-difflinesunified2">Usage of diffLinesUnified2</h2>
<p>Given two <strong>pairs</strong> of arrays of strings, <code>diffLinesUnified2(aLinesDisplay, bLinesDisplay, aLinesCompare, bLinesCompare, options?)</code> does the following:</p>
<ol type="1">
<li><strong>compare</strong> the pair of <code>Compare</code> arrays line-by-line using the <code>diff-sequences</code> package</li>
<li><strong>format</strong> the corresponding lines in the pair of <code>Display</code> arrays using the <code>chalk</code> package</li>
</ol>
<p>Jest calls this function to consider lines as common instead of changed if the only difference is indentation.</p>
<p>You might call this function for case insensitive or Unicode equivalence comparison of lines.</p>
<h3 id="example-of-difflinesunified2">Example of diffLinesUnified2</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="im">import</span> format <span class="im">from</span> <span class="st">&#39;pretty-format&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb7-2" title="2"></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">const</span> a <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-4" title="4">  <span class="dt">text</span><span class="op">:</span> <span class="st">&#39;Ignore indentation in serialized object&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-5" title="5">  <span class="dt">time</span><span class="op">:</span> <span class="st">&#39;2019-09-19T12:34:56.000Z&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-6" title="6">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;CREATE_ITEM&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="op">};</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="kw">const</span> b <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="dt">payload</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-10" title="10">    <span class="dt">text</span><span class="op">:</span> <span class="st">&#39;Ignore indentation in serialized object&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-11" title="11">    <span class="dt">time</span><span class="op">:</span> <span class="st">&#39;2019-09-19T12:34:56.000Z&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-12" title="12">  <span class="op">},</span></a>
<a class="sourceLine" id="cb7-13" title="13">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;CREATE_ITEM&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="op">};</span></a>
<a class="sourceLine" id="cb7-15" title="15"></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffLinesUnified2</span>(</a>
<a class="sourceLine" id="cb7-17" title="17">  <span class="co">// serialize with indentation to display lines</span></a>
<a class="sourceLine" id="cb7-18" title="18">  <span class="at">format</span>(a).<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb7-19" title="19">  <span class="at">format</span>(b).<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb7-20" title="20">  <span class="co">// serialize without indentation to compare lines</span></a>
<a class="sourceLine" id="cb7-21" title="21">  <span class="at">format</span>(a<span class="op">,</span> <span class="op">{</span><span class="dt">indent</span><span class="op">:</span> <span class="dv">0</span><span class="op">}</span>).<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb7-22" title="22">  <span class="at">format</span>(b<span class="op">,</span> <span class="op">{</span><span class="dt">indent</span><span class="op">:</span> <span class="dv">0</span><span class="op">}</span>).<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb7-23" title="23">)<span class="op">;</span></a></code></pre></div>
<p>The <code>text</code> and <code>time</code> properties are common, because their only difference is indentation:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb8-1" title="1"><span class="st">- Expected</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="va">+ Received</span></a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4">  Object {</a>
<a class="sourceLine" id="cb8-5" title="5"><span class="va">+   payload: Object {</span></a>
<a class="sourceLine" id="cb8-6" title="6">      text: &#39;Ignore indentation in serialized object&#39;,</a>
<a class="sourceLine" id="cb8-7" title="7">      time: &#39;2019-09-19T12:34:56.000Z&#39;,</a>
<a class="sourceLine" id="cb8-8" title="8"><span class="va">+   },</span></a>
<a class="sourceLine" id="cb8-9" title="9">    type: &#39;CREATE_ITEM&#39;,</a>
<a class="sourceLine" id="cb8-10" title="10">  }</a></code></pre></div>
<p>The preceding example illustrates why (at least for indentation) it seems more intuitive that the function returns the common line from the <code>bLinesDisplay</code> array instead of from the <code>aLinesDisplay</code> array.</p>
<h2 id="usage-of-diffstringsraw">Usage of diffStringsRaw</h2>
<p>Given <strong>strings</strong> and a boolean option, <code>diffStringsRaw(a, b, cleanup)</code> does the following:</p>
<ol type="1">
<li><strong>compare</strong> the strings character-by-character using the <code>diff-sequences</code> package</li>
<li>optionally <strong>clean up</strong> small (often coincidental) common substrings, also known as chaff</li>
</ol>
<p>Because <code>diffStringsRaw</code> returns the difference as <strong>data</strong> instead of a string, you can format it as your application requires (for example, enclosed in HTML markup for browser instead of escape sequences for console).</p>
<p>The returned <strong>array</strong> describes substrings as instances of the <code>Diff</code> class, which calling code can access like array tuples:</p>
<p>The value at index <code>0</code> is one of the following:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">value</th>
<th style="text-align: left;">named export</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: left;"><code>DIFF_EQUAL</code></td>
<td style="text-align: left;">in <code>a</code> and in <code>b</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>DIFF_DELETE</code></td>
<td style="text-align: left;">in <code>a</code> but not in <code>b</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>DIFF_INSERT</code></td>
<td style="text-align: left;">in <code>b</code> but not in <code>a</code></td>
</tr>
</tbody>
</table>
<p>The value at index <code>1</code> is a substring of <code>a</code> or <code>b</code> or both.</p>
<h3 id="example-of-diffstringsraw-with-cleanup">Example of diffStringsRaw with cleanup</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">const</span> diffs <span class="op">=</span> <span class="at">diffStringsRaw</span>(<span class="st">&#39;changed from&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="kw">true</span>)<span class="op">;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"><code>i</code></th>
<th style="text-align: right;"><code>diffs[i][0]</code></th>
<th style="text-align: left;"><code>diffs[i][1]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: left;"><code>'changed '</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'from'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>2</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'to'</code></td>
</tr>
</tbody>
</table>
<h3 id="example-of-diffstringsraw-without-cleanup">Example of diffStringsRaw without cleanup</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">const</span> diffs <span class="op">=</span> <span class="at">diffStringsRaw</span>(<span class="st">&#39;changed from&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="kw">false</span>)<span class="op">;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"><code>i</code></th>
<th style="text-align: right;"><code>diffs[i][0]</code></th>
<th style="text-align: left;"><code>diffs[i][1]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: left;"><code>'changed '</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'fr'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>2</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'t'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>3</code></td>
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: left;"><code>'o'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>4</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'m'</code></td>
</tr>
</tbody>
</table>
<h3 id="advanced-import-for-diffstringsraw">Advanced import for diffStringsRaw</h3>
<p>Here are all the named imports that you might need for the <code>diffStringsRaw</code> function:</p>
<ul>
<li><code>const {DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT, Diff, diffStringsRaw} = require('jest-diff');</code> in CommonJS modules</li>
<li><code>import {DIFF_DELETE, DIFF_EQUAL, DIFF_INSERT, Diff, diffStringsRaw} from 'jest-diff';</code> in ECMAScript modules</li>
</ul>
<p>To write a <strong>formatting</strong> function, you might need the named constants (and <code>Diff</code> in TypeScript annotations).</p>
<p>If you write an application-specific <strong>cleanup</strong> algorithm, then you might need to call the <code>Diff</code> constructor:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">const</span> diffCommon <span class="op">=</span> <span class="kw">new</span> <span class="at">Diff</span>(DIFF_EQUAL<span class="op">,</span> <span class="st">&#39;changed &#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">const</span> diffDelete <span class="op">=</span> <span class="kw">new</span> <span class="at">Diff</span>(DIFF_DELETE<span class="op">,</span> <span class="st">&#39;from&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw">const</span> diffInsert <span class="op">=</span> <span class="kw">new</span> <span class="at">Diff</span>(DIFF_INSERT<span class="op">,</span> <span class="st">&#39;to&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h2 id="usage-of-difflinesraw">Usage of diffLinesRaw</h2>
<p>Given <strong>arrays of strings</strong>, <code>diffLinesRaw(aLines, bLines)</code> does the following:</p>
<ul>
<li><strong>compare</strong> the arrays line-by-line using the <code>diff-sequences</code> package</li>
</ul>
<p>Because <code>diffLinesRaw</code> returns the difference as <strong>data</strong> instead of a string, you can format it as your application requires.</p>
<h3 id="example-of-difflinesraw">Example of diffLinesRaw</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">const</span> aLines <span class="op">=</span> [<span class="st">&#39;delete&#39;</span><span class="op">,</span> <span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed from&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">const</span> bLines <span class="op">=</span> [<span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="st">&#39;insert&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">const</span> diffs <span class="op">=</span> <span class="at">diffLinesRaw</span>(aLines<span class="op">,</span> bLines)<span class="op">;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"><code>i</code></th>
<th style="text-align: right;"><code>diffs[i][0]</code></th>
<th style="text-align: left;"><code>diffs[i][1]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'delete'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: left;"><code>'common'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>2</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'changed from'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>3</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'changed to'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>4</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'insert'</code></td>
</tr>
</tbody>
</table>
<h3 id="edge-case-of-difflinesraw">Edge case of diffLinesRaw</h3>
<p>If you call <code>string.split('\n')</code> for an empty string:</p>
<ul>
<li>the result is <code>['']</code> an array which contains an empty string</li>
<li>instead of <code>[]</code> an empty array</li>
</ul>
<p>Depending of your application, you might call <code>diffLinesRaw</code> with either array.</p>
<h3 id="example-of-split-method">Example of split method</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="im">import</span> <span class="op">{</span>diffLinesRaw<span class="op">}</span> <span class="im">from</span> <span class="st">&#39;jest-diff&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-2" title="2"></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="kw">const</span> a <span class="op">=</span> <span class="st">&#39;non-empty string&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-4" title="4"><span class="kw">const</span> b <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-5" title="5"></a>
<a class="sourceLine" id="cb13-6" title="6"><span class="kw">const</span> diffs <span class="op">=</span> <span class="at">diffLinesRaw</span>(<span class="va">a</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span> <span class="va">b</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))<span class="op">;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"><code>i</code></th>
<th style="text-align: right;"><code>diffs[i][0]</code></th>
<th style="text-align: left;"><code>diffs[i][1]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: right;"><code>-1</code></td>
<td style="text-align: left;"><code>'non-empty string'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>''</code></td>
</tr>
</tbody>
</table>
<p>Which you might format as follows:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb14-1" title="1"><span class="st">- Expected  - 1</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="va">+ Received  + 1</span></a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="st">- non-empty string</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="va">+</span></a></code></pre></div>
<h3 id="example-of-splitlines0-function">Example of splitLines0 function</h3>
<p>For edge case behavior like the <code>diffLinesUnified</code> function, you might define a <code>splitLines0</code> function, which given an empty string, returns <code>[]</code> an empty array:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="im">export</span> <span class="kw">const</span> splitLines0 <span class="op">=</span> string <span class="kw">=&gt;</span></a>
<a class="sourceLine" id="cb15-2" title="2">  <span class="va">string</span>.<span class="at">length</span> <span class="op">===</span> <span class="dv">0</span> <span class="op">?</span> [] : <span class="va">string</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="im">import</span> <span class="op">{</span>diffLinesRaw<span class="op">}</span> <span class="im">from</span> <span class="st">&#39;jest-diff&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-2" title="2"></a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw">const</span> a <span class="op">=</span> <span class="st">&#39;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="kw">const</span> b <span class="op">=</span> <span class="st">&#39;line 1</span><span class="sc">\n</span><span class="st">line 2</span><span class="sc">\n</span><span class="st">line 3&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb16-5" title="5"></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="kw">const</span> diffs <span class="op">=</span> <span class="at">diffLinesRaw</span>(<span class="va">a</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)<span class="op">,</span> <span class="va">b</span>.<span class="at">split</span>(<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>))<span class="op">;</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th style="text-align: right;"><code>i</code></th>
<th style="text-align: right;"><code>diffs[i][0]</code></th>
<th style="text-align: left;"><code>diffs[i][1]</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>0</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'line 1'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'line 2'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>2</code></td>
<td style="text-align: right;"><code>1</code></td>
<td style="text-align: left;"><code>'line 3'</code></td>
</tr>
</tbody>
</table>
<p>Which you might format as follows:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb17-1" title="1"><span class="st">- Expected  - 0</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="va">+ Received  + 3</span></a>
<a class="sourceLine" id="cb17-3" title="3"></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="va">+ line 1</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="va">+ line 2</span></a>
<a class="sourceLine" id="cb17-6" title="6"><span class="va">+ line 3</span></a></code></pre></div>
<p>In contrast to the <code>diffLinesRaw</code> function, the <code>diffLinesUnified</code> and <code>diffLinesUnified2</code> functions <strong>automatically</strong> convert array arguments computed by string <code>split</code> method, so callers do <strong>not</strong> need a <code>splitLine0</code> function.</p>
<h2 id="options">Options</h2>
<p>The default options are for the report when an assertion fails from the <code>expect</code> package used by Jest.</p>
<p>For other applications, you can provide an options object as a third argument:</p>
<ul>
<li><code>diffDefault(a, b, options)</code></li>
<li><code>diffStringsUnified(a, b, options)</code></li>
<li><code>diffLinesUnified(aLines, bLines, options)</code></li>
<li><code>diffLinesUnified2(aLinesDisplay, bLinesDisplay, aLinesCompare, bLinesCompare, options)</code></li>
</ul>
<h3 id="properties-of-options-object">Properties of options object</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">name</th>
<th style="text-align: left;">default</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>aAnnotation</code></td>
<td style="text-align: left;"><code>'Expected'</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>aColor</code></td>
<td style="text-align: left;"><code>chalk.green</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>aIndicator</code></td>
<td style="text-align: left;"><code>'-'</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bAnnotation</code></td>
<td style="text-align: left;"><code>'Received'</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>bColor</code></td>
<td style="text-align: left;"><code>chalk.red</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>bIndicator</code></td>
<td style="text-align: left;"><code>'+'</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>changeColor</code></td>
<td style="text-align: left;"><code>chalk.inverse</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>changeLineTrailingSpaceColor</code></td>
<td style="text-align: left;"><code>string =&gt; string</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>commonColor</code></td>
<td style="text-align: left;"><code>chalk.dim</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>commonIndicator</code></td>
<td style="text-align: left;"><code>' '</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>commonLineTrailingSpaceColor</code></td>
<td style="text-align: left;"><code>string =&gt; string</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>contextLines</code></td>
<td style="text-align: left;"><code>5</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>emptyFirstOrLastLinePlaceholder</code></td>
<td style="text-align: left;"><code>''</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>expand</code></td>
<td style="text-align: left;"><code>true</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>includeChangeCounts</code></td>
<td style="text-align: left;"><code>false</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>omitAnnotationLines</code></td>
<td style="text-align: left;"><code>false</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>patchColor</code></td>
<td style="text-align: left;"><code>chalk.yellow</code></td>
</tr>
</tbody>
</table>
<p>For more information about the options, see the following examples.</p>
<h3 id="example-of-options-for-labels">Example of options for labels</h3>
<p>If the application is code modification, you might replace the labels:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="dt">aAnnotation</span><span class="op">:</span> <span class="st">&#39;Original&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="dt">bAnnotation</span><span class="op">:</span> <span class="st">&#39;Modified&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="op">};</span></a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb19-1" title="1"><span class="st">- Original</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="va">+ Modified</span></a>
<a class="sourceLine" id="cb19-3" title="3"></a>
<a class="sourceLine" id="cb19-4" title="4">  common</a>
<a class="sourceLine" id="cb19-5" title="5"><span class="st">- changed from</span></a>
<a class="sourceLine" id="cb19-6" title="6"><span class="va">+ changed to</span></a></code></pre></div>
<p>The <code>jest-diff</code> package does not assume that the 2 labels have equal length.</p>
<h3 id="example-of-options-for-colors-of-changed-lines">Example of options for colors of changed lines</h3>
<p>For consistency with most diff tools, you might exchange the colors:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb20-1" title="1"><span class="im">import</span> chalk <span class="op">=</span><span class="kw"> require</span><span class="op">(</span><span class="st">&#39;chalk&#39;</span><span class="op">);</span></a>
<a class="sourceLine" id="cb20-2" title="2"></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb20-4" title="4">  aColor<span class="op">:</span> <span class="va">chalk</span><span class="op">.</span><span class="at">red</span><span class="op">,</span></a>
<a class="sourceLine" id="cb20-5" title="5">  bColor<span class="op">:</span> <span class="va">chalk</span><span class="op">.</span><span class="at">green</span><span class="op">,</span></a>
<a class="sourceLine" id="cb20-6" title="6"><span class="op">};</span></a></code></pre></div>
<h3 id="example-of-option-for-color-of-changed-substrings">Example of option for color of changed substrings</h3>
<p>Although the default inverse of foreground and background colors is hard to beat for changed substrings <strong>within lines</strong>, especially because it highlights spaces, if you want bold font weight on yellow background color:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb21-1" title="1"><span class="im">import</span> chalk <span class="op">=</span><span class="kw"> require</span><span class="op">(</span><span class="st">&#39;chalk&#39;</span><span class="op">);</span></a>
<a class="sourceLine" id="cb21-2" title="2"></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb21-4" title="4">  changeColor<span class="op">:</span> <span class="va">chalk</span><span class="op">.</span><span class="va">bold</span><span class="op">.</span><span class="at">bgYellowBright</span><span class="op">,</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="op">};</span></a></code></pre></div>
<h3 id="example-of-option-to-format-trailing-spaces">Example of option to format trailing spaces</h3>
<p>Because the default export does not display substring differences within lines, formatting can help you see when lines differ by the presence or absence of trailing spaces found by <code>/\s+$/</code> regular expression.</p>
<ul>
<li>If change lines have a background color, then you can see trailing spaces.</li>
<li>If common lines have default dim color, then you cannot see trailing spaces. You might want yellowish background color to see them.</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-2" title="2">  <span class="dt">aColor</span><span class="op">:</span> <span class="va">chalk</span>.<span class="at">rgb</span>(<span class="dv">128</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">128</span>).<span class="at">bgRgb</span>(<span class="dv">255</span><span class="op">,</span> <span class="dv">215</span><span class="op">,</span> <span class="dv">255</span>)<span class="op">,</span> <span class="co">// magenta</span></a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="dt">bColor</span><span class="op">:</span> <span class="va">chalk</span>.<span class="at">rgb</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">95</span><span class="op">,</span> <span class="dv">0</span>).<span class="at">bgRgb</span>(<span class="dv">215</span><span class="op">,</span> <span class="dv">255</span><span class="op">,</span> <span class="dv">215</span>)<span class="op">,</span> <span class="co">// green</span></a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="dt">commonLineTrailingSpaceColor</span><span class="op">:</span> <span class="va">chalk</span>.<span class="at">bgYellow</span><span class="op">,</span></a>
<a class="sourceLine" id="cb22-5" title="5"><span class="op">};</span></a></code></pre></div>
<p>The value of a Color option is a function, which given a string, returns a string.</p>
<p>If you want to replace trailing spaces with middle dot characters:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">const</span> replaceSpacesWithMiddleDot <span class="op">=</span> string <span class="kw">=&gt;</span> <span class="st">&#39;·&#39;</span>.<span class="at">repeat</span>(<span class="va">string</span>.<span class="at">length</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"></a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb23-4" title="4">  <span class="dt">changeLineTrailingSpaceColor</span><span class="op">:</span> replaceSpacesWithMiddleDot<span class="op">,</span></a>
<a class="sourceLine" id="cb23-5" title="5">  <span class="dt">commonLineTrailingSpaceColor</span><span class="op">:</span> replaceSpacesWithMiddleDot<span class="op">,</span></a>
<a class="sourceLine" id="cb23-6" title="6"><span class="op">};</span></a></code></pre></div>
<p>If you need the TypeScript type of a Color option:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb24-1" title="1"><span class="im">import</span> <span class="op">{</span>DiffOptionsColor<span class="op">}</span> <span class="im">from</span> <span class="st">&#39;jest-diff&#39;</span><span class="op">;</span></a></code></pre></div>
<h3 id="example-of-options-for-no-colors">Example of options for no colors</h3>
<p>To store the difference in a file without escape codes for colors, provide an identity function:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">const</span> noColor <span class="op">=</span> string <span class="kw">=&gt;</span> string<span class="op">;</span></a>
<a class="sourceLine" id="cb25-2" title="2"></a>
<a class="sourceLine" id="cb25-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb25-4" title="4">  <span class="dt">aColor</span><span class="op">:</span> noColor<span class="op">,</span></a>
<a class="sourceLine" id="cb25-5" title="5">  <span class="dt">bColor</span><span class="op">:</span> noColor<span class="op">,</span></a>
<a class="sourceLine" id="cb25-6" title="6">  <span class="dt">changeColor</span><span class="op">:</span> noColor<span class="op">,</span></a>
<a class="sourceLine" id="cb25-7" title="7">  <span class="dt">commonColor</span><span class="op">:</span> noColor<span class="op">,</span></a>
<a class="sourceLine" id="cb25-8" title="8">  <span class="dt">patchColor</span><span class="op">:</span> noColor<span class="op">,</span></a>
<a class="sourceLine" id="cb25-9" title="9"><span class="op">};</span></a></code></pre></div>
<h3 id="example-of-options-for-indicators">Example of options for indicators</h3>
<p>For consistency with the <code>diff</code> command, you might replace the indicators:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-2" title="2">  <span class="dt">aIndicator</span><span class="op">:</span> <span class="st">&#39;&lt;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb26-3" title="3">  <span class="dt">bIndicator</span><span class="op">:</span> <span class="st">&#39;&gt;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="op">};</span></a></code></pre></div>
<p>The <code>jest-diff</code> package assumes (but does not enforce) that the 3 indicators have equal length.</p>
<h3 id="example-of-options-to-limit-common-lines">Example of options to limit common lines</h3>
<p>By default, the output includes all common lines.</p>
<p>To emphasize the changes, you might limit the number of common “context” lines:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb27-2" title="2">  <span class="dt">contextLines</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span></a>
<a class="sourceLine" id="cb27-3" title="3">  <span class="dt">expand</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="op">};</span></a></code></pre></div>
<p>A patch mark like <code>@@ -12,7 +12,9 @@</code> accounts for omitted common lines.</p>
<h3 id="example-of-option-for-color-of-patch-marks">Example of option for color of patch marks</h3>
<p>If you want patch marks to have the same dim color as common lines:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode ts"><code class="sourceCode typescript"><a class="sourceLine" id="cb28-1" title="1"><span class="im">import</span> chalk <span class="op">=</span><span class="kw"> require</span><span class="op">(</span><span class="st">&#39;chalk&#39;</span><span class="op">);</span></a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb28-4" title="4">  expand<span class="op">:</span> <span class="kw">false</span><span class="op">,</span></a>
<a class="sourceLine" id="cb28-5" title="5">  patchColor<span class="op">:</span> <span class="va">chalk</span><span class="op">.</span><span class="at">dim</span><span class="op">,</span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="op">};</span></a></code></pre></div>
<h3 id="example-of-option-to-include-change-counts">Example of option to include change counts</h3>
<p>To display the number of changed lines at the right of annotation lines:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">const</span> a <span class="op">=</span> [<span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed from&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="kw">const</span> b <span class="op">=</span> [<span class="st">&#39;common&#39;</span><span class="op">,</span> <span class="st">&#39;changed to&#39;</span><span class="op">,</span> <span class="st">&#39;insert&#39;</span>]<span class="op">;</span></a>
<a class="sourceLine" id="cb29-3" title="3"></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb29-5" title="5">  <span class="dt">includeChangeCounts</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb29-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb29-7" title="7"></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffDefault</span>(a<span class="op">,</span> b<span class="op">,</span> options)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb30-1" title="1"><span class="st">- Expected  - 1</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="va">+ Received  + 2</span></a>
<a class="sourceLine" id="cb30-3" title="3"></a>
<a class="sourceLine" id="cb30-4" title="4">  Array [</a>
<a class="sourceLine" id="cb30-5" title="5">    &quot;common&quot;,</a>
<a class="sourceLine" id="cb30-6" title="6"><span class="st">-   &quot;changed from&quot;,</span></a>
<a class="sourceLine" id="cb30-7" title="7"><span class="va">+   &quot;changed to&quot;,</span></a>
<a class="sourceLine" id="cb30-8" title="8"><span class="va">+   &quot;insert&quot;,</span></a>
<a class="sourceLine" id="cb30-9" title="9">  ]</a></code></pre></div>
<h3 id="example-of-option-to-omit-annotation-lines">Example of option to omit annotation lines</h3>
<p>To display only the comparison lines:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">const</span> a <span class="op">=</span> <span class="st">&#39;common</span><span class="sc">\n</span><span class="st">changed from&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb31-2" title="2"><span class="kw">const</span> b <span class="op">=</span> <span class="st">&#39;common</span><span class="sc">\n</span><span class="st">changed to&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb31-3" title="3"></a>
<a class="sourceLine" id="cb31-4" title="4"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb31-5" title="5">  <span class="dt">omitAnnotationLines</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb31-6" title="6"><span class="op">};</span></a>
<a class="sourceLine" id="cb31-7" title="7"></a>
<a class="sourceLine" id="cb31-8" title="8"><span class="kw">const</span> difference <span class="op">=</span> <span class="at">diffStringsUnified</span>(a<span class="op">,</span> b<span class="op">,</span> options)<span class="op">;</span></a></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode diff"><code class="sourceCode diff"><a class="sourceLine" id="cb32-1" title="1">  common</a>
<a class="sourceLine" id="cb32-2" title="2"><span class="st">- changed from</span></a>
<a class="sourceLine" id="cb32-3" title="3"><span class="va">+ changed to</span></a></code></pre></div>
<h3 id="example-of-option-for-empty-first-or-last-lines">Example of option for empty first or last lines</h3>
<p>If the <strong>first</strong> or <strong>last</strong> comparison line is <strong>empty</strong>, because the content is empty and the indicator is a space, you might not notice it.</p>
<p>The replacement option is a string whose default value is <code>''</code> empty string.</p>
<p>Because Jest trims the report when a matcher fails, it deletes an empty last line.</p>
<p>Therefore, Jest uses as placeholder the downwards arrow with corner leftwards:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb33-2" title="2">  <span class="dt">emptyFirstOrLastLinePlaceholder</span><span class="op">:</span> <span class="st">&#39;↵&#39;</span><span class="op">,</span> <span class="co">// U+21B5</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="op">};</span></a></code></pre></div>
<p>If a content line is empty, then the corresponding comparison line is automatically trimmed to remove the margin space (represented as a middle dot below) for the default indicators:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: right;">Indicator</th>
<th style="text-align: left;">untrimmed</th>
<th style="text-align: left;">trimmed</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;"><code>aIndicator</code></td>
<td style="text-align: left;"><code>'-·'</code></td>
<td style="text-align: left;"><code>'-'</code></td>
</tr>
<tr class="even">
<td style="text-align: right;"><code>bIndicator</code></td>
<td style="text-align: left;"><code>'+·'</code></td>
<td style="text-align: left;"><code>'+'</code></td>
</tr>
<tr class="odd">
<td style="text-align: right;"><code>commonIndicator</code></td>
<td style="text-align: left;"><code>' ·'</code></td>
<td style="text-align: left;"><code>''</code></td>
</tr>
</tbody>
</table>
</body>
</html>
