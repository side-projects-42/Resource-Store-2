"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const react_1 = require("react");
const useLocalStorageStateBase_1 = require("./useLocalStorageStateBase");
function createLocalStorageStateHook(key, defaultValue) {
    const setValueFunctions = [];
    return function useLocalStorageStateHook() {
        const [value, setValue, isPersistent] = useLocalStorageStateBase_1.default(key, defaultValue);
        const setValueAll = react_1.useMemo(() => {
            const fn = (newValue) => {
                for (const setValueFunction of setValueFunctions) {
                    setValueFunction(newValue);
                }
            };
            fn.reset = () => {
                for (const setValueFunction of setValueFunctions) {
                    setValueFunction.reset();
                }
            };
            return fn;
        }, []);
        react_1.useEffect(() => {
            setValueFunctions.push(setValue);
            return () => void setValueFunctions.splice(setValueFunctions.indexOf(setValue), 1);
        }, [setValue]);
        return [value, setValueAll, isPersistent];
    };
}
exports.default = createLocalStorageStateHook;
