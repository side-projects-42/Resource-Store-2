<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="jest-emotion">jest-emotion</h1>
<blockquote>
<p>Jest testing utilities for emotion</p>
</blockquote>
<h1 id="installation">Installation</h1>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="ex">npm</span> install --save-dev jest-emotion</a></code></pre></div>
<h1 id="snapshot-serializer">Snapshot Serializer</h1>
<p>The easiest way to test React components with emotion is with the snapshot serializer. You can register the serializer via the <code>snapshotSerializers</code> configuration property in your jest configuration like so:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="co">// jest.config.js</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="va">module</span>.<span class="at">exports</span> <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">  <span class="co">// ... other config</span></a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="dt">snapshotSerializers</span><span class="op">:</span> [<span class="st">&#39;jest-emotion&#39;</span>]</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="op">}</span></a></code></pre></div>
<p>Or you can customize the serializer via the <code>createSerializer</code> method like so: (the example below is with react-test-renderer but jest-emotion also works with enzyme and react-testing-library)</p>
<pre class="jsx"><code>import React from &#39;react&#39;
import renderer from &#39;react-test-renderer&#39;
import serializer from &#39;jest-emotion&#39;
import styled from &#39;@emotion/styled&#39;

expect.addSnapshotSerializer(serializer)

test(&#39;renders with correct styles&#39;, () =&gt; {
  const H1 = styled.h1`
    float: left;
  `

  const tree = renderer.create(&lt;H1&gt;hello world&lt;/H1&gt;).toJSON()

  expect(tree).toMatchSnapshot()
})</code></pre>
<p>Refer to the <a href="https://github.com/emotion-js/emotion/blob/master/docs/testing.md">testing doc</a> for more information about snapshot testing with emotion.</p>
<h2 id="options">Options</h2>
<h3 id="classnamereplacer"><code>classNameReplacer</code></h3>
<p>jest-emotion’s snapshot serializer replaces the hashes in class names with an index so that things like whitespace changes won’t break snapshots. It optionally accepts a custom class name replacer, it defaults to the below.</p>
<pre class="jsx"><code>function classNameReplacer(className, index) {
  return `emotion-${index}`
}</code></pre>
<pre class="jsx"><code>import { createSerializer } from &#39;jest-emotion&#39;

expect.addSnapshotSerializer(
  createSerializer({
    classNameReplacer(className, index) {
      return `my-new-class-name-${index}`
    }
  })
)</code></pre>
<h3 id="domelements"><code>DOMElements</code></h3>
<p>jest-emotion’s snapshot serializer inserts styles and replaces class names in both React and DOM elements. If you would like to disable this behavior for DOM elements, you can do so by passing <code>{ DOMElements: false }</code>. For example:</p>
<pre class="jsx"><code>import { createSerializer } from &#39;jest-emotion&#39;

// configures jest-emotion to ignore DOM elements
expect.addSnapshotSerializer(createSerializer({ DOMElements: false }))</code></pre>
<h1 id="custom-matchers">Custom matchers</h1>
<h2 id="tohavestylerule">toHaveStyleRule</h2>
<p>To make more explicit assertions when testing your styled components you can use the <code>toHaveStyleRule</code> matcher.</p>
<pre class="jsx"><code>import React from &#39;react&#39;
import renderer from &#39;react-test-renderer&#39;
import { matchers } from &#39;jest-emotion&#39;
import styled from &#39;@emotion/styled&#39;

// Add the custom matchers provided by &#39;jest-emotion&#39;
expect.extend(matchers)

test(&#39;renders with correct styles&#39;, () =&gt; {
  const Svg = styled(&#39;svg&#39;)`
    width: 100%;
  `

  const Div = styled(&#39;div&#39;)`
    float: left;
    height: 80%;
    &amp;:hover {
      width: 50px;
    }
    ${Svg} {
      fill: green;
    }
    span {
      color: yellow;
    }
    @media screen and (max-width: 1200px) {
      font-size: 14px;
    }
  `

  const tree = renderer
    .create(
      &lt;Div&gt;
        &lt;Svg /&gt;
        &lt;span&gt;Test&lt;/span&gt;
      &lt;/Div&gt;
    )
    .toJSON()

  expect(tree).toHaveStyleRule(&#39;float&#39;, &#39;left&#39;)
  expect(tree).not.toHaveStyleRule(&#39;height&#39;, &#39;100%&#39;)
})</code></pre>
<p>You can provide additional options for <code>toHaveStyleRule</code> matcher.<br />
<code>target</code> - helps to specify css selector or other component where style rule should be found.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="at">expect</span>(tree).<span class="at">toHaveStyleRule</span>(<span class="st">&#39;width&#39;</span><span class="op">,</span> <span class="st">&#39;50px&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">target</span><span class="op">:</span> <span class="st">&#39;:hover&#39;</span> <span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="at">expect</span>(tree).<span class="at">toHaveStyleRule</span>(<span class="st">&#39;color&#39;</span><span class="op">,</span> <span class="st">&#39;yellow&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">target</span><span class="op">:</span> <span class="st">&#39;span&#39;</span> <span class="op">}</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="at">expect</span>(tree).<span class="at">toHaveStyleRule</span>(<span class="st">&#39;fill&#39;</span><span class="op">,</span> <span class="st">&#39;green&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">target</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>Svg<span class="sc">}</span><span class="vs">`</span> <span class="op">}</span>)</a></code></pre></div>
<p><code>media</code> - specifies the media rule where the matcher should look for the style property.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="at">expect</span>(tree).<span class="at">toHaveStyleRule</span>(<span class="st">&#39;font-size&#39;</span><span class="op">,</span> <span class="st">&#39;14px&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">media</span><span class="op">:</span> <span class="st">&#39;screen and (max-width: 1200px)&#39;</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="op">}</span>)</a></code></pre></div>
<p>Use <code>media</code> and <code>target</code> options to assert on rules within media queries and to target nested components, pseudo-classes, and pseudo-elements.</p>
<pre class="jsx"><code>import React from &#39;react&#39;
import renderer from &#39;react-test-renderer&#39;
import { matchers } from &#39;jest-emotion&#39;
import styled from &#39;@emotion/styled&#39;

// Add the custom matchers provided by &#39;jest-emotion&#39;
expect.extend(matchers)

test(&#39;renders with correct link styles&#39;, () =&gt; {
  const Container = styled.div`
    font-size: 14px;

    a {
      color: yellow;
    }

    a:hover {
      color: black;
    }

    @media (min-width: 768px) {
      font-size: 16px;
    }
  `

  const tree = renderer.create(&lt;Container&gt;hello world&lt;/Container&gt;).toJSON()

  expect(tree).toHaveStyleRule(&#39;color&#39;, &#39;yellow&#39;, { target: /a$/ })
  expect(tree).toHaveStyleRule(&#39;color&#39;, &#39;black&#39;, { target: &#39;a:hover&#39; })
  expect(tree).toHaveStyleRule(&#39;font-size&#39;, &#39;16px&#39;, {
    media: &#39;(min-width: 768px)&#39;
  })
})</code></pre>
<h2 id="thanks">Thanks</h2>
<p>Thanks to <a href="https://twitter.com/kentcdodds">Kent C. Dodds</a> who wrote <a href="https://github.com/kentcdodds/jest-glamor-react">jest-glamor-react</a> which this library is largely based on. ❤️</p>
</body>
</html>
