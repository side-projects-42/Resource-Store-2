<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="gatsby-plugin-offline">gatsby-plugin-offline</h1>
<p>Adds drop-in support for making a Gatsby site work offline and more resistant to bad network connections. It uses <a href="https://developers.google.com/web/tools/workbox/modules/workbox-build">Workbox Build</a> to create a service worker for the site and loads the service worker into the client.</p>
<p>If youâ€™re using this plugin with <code>gatsby-plugin-manifest</code> (recommended) this plugin should be listed <em>after</em> that plugin so the manifest file can be included in the service worker.</p>
<h2 id="install">Install</h2>
<p><code>npm install gatsby-plugin-offline</code></p>
<h2 id="how-to-use">How to use</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="co">// In your gatsby-config.js</span></a>
<a class="sourceLine" id="cb1-2" title="2">plugins<span class="op">:</span> [<span class="vs">`gatsby-plugin-offline`</span>]</a></code></pre></div>
<h2 id="available-options">Available options</h2>
<p>In <code>gatsby-plugin-offline</code> 3.x, the following options are available:</p>
<ul>
<li><p><code>precachePages</code> lets you specify pages whose resources should be precached by the service worker, using an array of globs. For example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript:title=gatsby-config.js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb2-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb2-3" title="3">    <span class="dt">resolve</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb2-4" title="4">    <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">      <span class="dt">precachePages</span><span class="op">:</span> [<span class="vs">`/about-us/`</span><span class="op">,</span> <span class="vs">`/projects/*`</span>]<span class="op">,</span></a>
<a class="sourceLine" id="cb2-6" title="6">    <span class="op">},</span></a>
<a class="sourceLine" id="cb2-7" title="7">  <span class="op">},</span></a>
<a class="sourceLine" id="cb2-8" title="8">]</a></code></pre></div>
<p>Note: while essential resources of specified pages will be precached, such as JavaScript and CSS, non-essential resources such as fonts and images will not be included. Instead, these will be cached at runtime when a user visits a given page that includes these resources.</p></li>
<li><p><code>appendScript</code> lets you specify a file to be appended at the end of the generated service worker (<code>sw.js</code>). For example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript:title=gatsby-config.js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb3-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb3-3" title="3">    <span class="dt">resolve</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-5" title="5">      <span class="dt">appendScript</span><span class="op">:</span> <span class="va">require</span>.<span class="at">resolve</span>(<span class="vs">`src/custom-sw-code.js`</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="op">},</span></a>
<a class="sourceLine" id="cb3-7" title="7">  <span class="op">},</span></a>
<a class="sourceLine" id="cb3-8" title="8">]</a></code></pre></div>
<p><br /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript:title=src/custom-sw-code.js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="co">// show a notification after 15 seconds (the notification</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co">// permission must be granted first)</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="at">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="va">self</span>.<span class="va">registration</span>.<span class="at">showNotification</span>(<span class="st">&quot;Hello, world!&quot;</span>)</a>
<a class="sourceLine" id="cb4-5" title="5"><span class="op">},</span> <span class="dv">15000</span>)</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="co">// register a custom navigation route</span></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw">const</span> customRoute <span class="op">=</span> <span class="kw">new</span> <span class="va">workbox</span>.<span class="va">routing</span>.<span class="at">NavigationRoute</span>((<span class="op">{</span> event <span class="op">}</span>) <span class="kw">=&gt;</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-9" title="9">  <span class="co">// ...</span></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb4-11" title="11"><span class="va">workbox</span>.<span class="va">routing</span>.<span class="at">registerRoute</span>(customRoute)</a></code></pre></div></li>
<li><p><code>debug</code> specifies whether Workbox should show debugging output in the browser console at runtime. When undefined, defaults to showing debug messages on <code>localhost</code> only.</p></li>
<li><p><code>workboxConfig</code> allows you to override the default Workbox options - see <a href="#overriding-workbox-configuration">Overriding Workbox configuration</a>. For example:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript:title=gatsby-config.js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="dt">resolve</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-5" title="5">      <span class="dt">workboxConfig</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-6" title="6">        <span class="dt">importWorkboxFrom</span><span class="op">:</span> <span class="vs">`cdn`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-7" title="7">      <span class="op">},</span></a>
<a class="sourceLine" id="cb5-8" title="8">    <span class="op">},</span></a>
<a class="sourceLine" id="cb5-9" title="9">  <span class="op">},</span></a>
<a class="sourceLine" id="cb5-10" title="10">]</a></code></pre></div></li>
</ul>
<h2 id="upgrading-from-2.x">Upgrading from 2.x</h2>
<p>To upgrade from 2.x to 3.x, move any existing options into the <code>workboxConfig</code> option. If you havenâ€™t specified any options, you have nothing to do.</p>
<p>For example, here is a 2.x config:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb6-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb6-3" title="3">    <span class="dt">resolve</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-5" title="5">      <span class="dt">importWorkboxFrom</span><span class="op">:</span> <span class="vs">`cdn`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-6" title="6">    <span class="op">},</span></a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="op">},</span></a>
<a class="sourceLine" id="cb6-8" title="8">]</a></code></pre></div>
<p>Here is the equivalent 3.x config:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1">plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="op">{</span></a>
<a class="sourceLine" id="cb7-3" title="3">    <span class="dt">resolve</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-4" title="4">    <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-5" title="5">      <span class="dt">workboxConfig</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-6" title="6">        <span class="dt">importWorkboxFrom</span><span class="op">:</span> <span class="vs">`cdn`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb7-7" title="7">      <span class="op">},</span></a>
<a class="sourceLine" id="cb7-8" title="8">    <span class="op">},</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="op">},</span></a>
<a class="sourceLine" id="cb7-10" title="10">]</a></code></pre></div>
<p>In version 3, Workbox is also upgraded to version 4 so you may need to update your <code>workboxConfig</code> if any of those changes apply to you. Please see the <a href="https://developers.google.com/web/tools/workbox/guides/migrations/migrate-from-v3">docs on Google Developers</a> for more information.</p>
<h2 id="overriding-workbox-configuration">Overriding Workbox configuration</h2>
<p>When adding this plugin to your <code>gatsby-config.js</code>, you can use the option <code>workboxConfig</code> to override the default Workbox config. To see the full list of options, see <a href="https://developers.google.com/web/tools/workbox/modules/workbox-build#full_generatesw_config">this article on Google Developers</a>.</p>
<p>The default <code>workboxConfig</code> is as follows. Note that some of these options are configured automatically, e.g.Â <code>globPatterns</code>. If youâ€™re not sure about what all of these options mean, itâ€™s best to leave them as-is - otherwise, you may end up causing errors on your site, causing old files to be remain cached, or even breaking offline support.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">const</span> options <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">  <span class="dt">importWorkboxFrom</span><span class="op">:</span> <span class="vs">`local`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="dt">globDirectory</span><span class="op">:</span> rootDir<span class="op">,</span></a>
<a class="sourceLine" id="cb8-4" title="4">  globPatterns<span class="op">,</span></a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="dt">modifyURLPrefix</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-6" title="6">    <span class="co">// If `pathPrefix` is configured by user, we should replace</span></a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="co">// the default prefix with `pathPrefix`.</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="st">&quot;/&quot;</span><span class="op">:</span> <span class="vs">`</span><span class="sc">${</span>pathPrefix<span class="sc">}</span><span class="vs">/`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-9" title="9">  <span class="op">},</span></a>
<a class="sourceLine" id="cb8-10" title="10">  <span class="dt">cacheId</span><span class="op">:</span> <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="co">// Don&#39;t cache-bust JS or CSS files, and anything in the static directory,</span></a>
<a class="sourceLine" id="cb8-12" title="12">  <span class="co">// since these files have unique URLs and their contents will never change</span></a>
<a class="sourceLine" id="cb8-13" title="13">  <span class="dt">dontCacheBustURLsMatching</span><span class="op">:</span> <span class="ss">/</span><span class="sc">(\.</span><span class="ss">js$</span><span class="sc">|\.</span><span class="ss">css$</span><span class="sc">|</span><span class="ss">static</span><span class="sc">\/)</span><span class="ss">/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-14" title="14">  <span class="dt">runtimeCaching</span><span class="op">:</span> [</a>
<a class="sourceLine" id="cb8-15" title="15">    <span class="op">{</span></a>
<a class="sourceLine" id="cb8-16" title="16">      <span class="co">// Use cacheFirst since these don&#39;t need to be revalidated (same RegExp</span></a>
<a class="sourceLine" id="cb8-17" title="17">      <span class="co">// and same reason as above)</span></a>
<a class="sourceLine" id="cb8-18" title="18">      <span class="dt">urlPattern</span><span class="op">:</span> <span class="ss">/</span><span class="sc">(\.</span><span class="ss">js$</span><span class="sc">|\.</span><span class="ss">css$</span><span class="sc">|</span><span class="ss">static</span><span class="sc">\/)</span><span class="ss">/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-19" title="19">      <span class="dt">handler</span><span class="op">:</span> <span class="vs">`CacheFirst`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-20" title="20">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-21" title="21">    <span class="op">{</span></a>
<a class="sourceLine" id="cb8-22" title="22">      <span class="co">// page-data.json files, static query results and app-data.json</span></a>
<a class="sourceLine" id="cb8-23" title="23">      <span class="co">// are not content hashed</span></a>
<a class="sourceLine" id="cb8-24" title="24">      <span class="dt">urlPattern</span><span class="op">:</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">https</span><span class="sc">?</span><span class="ss">:.</span><span class="sc">*\/</span><span class="ss">page-data</span><span class="sc">\/</span><span class="ss">.</span><span class="sc">*\.</span><span class="ss">json/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-25" title="25">      <span class="dt">handler</span><span class="op">:</span> <span class="vs">`StaleWhileRevalidate`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-26" title="26">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-27" title="27">    <span class="op">{</span></a>
<a class="sourceLine" id="cb8-28" title="28">      <span class="co">// Add runtime caching of various other page resources</span></a>
<a class="sourceLine" id="cb8-29" title="29">      <span class="dt">urlPattern</span><span class="op">:</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">https</span><span class="sc">?</span><span class="ss">:.</span><span class="sc">*\.(</span><span class="ss">png</span><span class="sc">|</span><span class="ss">jpg</span><span class="sc">|</span><span class="ss">jpeg</span><span class="sc">|</span><span class="ss">webp</span><span class="sc">|</span><span class="ss">svg</span><span class="sc">|</span><span class="ss">gif</span><span class="sc">|</span><span class="ss">tiff</span><span class="sc">|</span><span class="ss">js</span><span class="sc">|</span><span class="ss">woff</span><span class="sc">|</span><span class="ss">woff2</span><span class="sc">|</span><span class="ss">json</span><span class="sc">|</span><span class="ss">css</span><span class="sc">)$</span><span class="ss">/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-30" title="30">      <span class="dt">handler</span><span class="op">:</span> <span class="vs">`StaleWhileRevalidate`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-31" title="31">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-32" title="32">    <span class="op">{</span></a>
<a class="sourceLine" id="cb8-33" title="33">      <span class="co">// Google Fonts CSS (doesn&#39;t end in .css so we need to specify it)</span></a>
<a class="sourceLine" id="cb8-34" title="34">      <span class="dt">urlPattern</span><span class="op">:</span> <span class="ss">/</span><span class="sc">^</span><span class="ss">https</span><span class="sc">?</span><span class="ss">:</span><span class="sc">\/\/</span><span class="ss">fonts</span><span class="sc">\.</span><span class="ss">googleapis</span><span class="sc">\.</span><span class="ss">com</span><span class="sc">\/</span><span class="ss">css/</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-35" title="35">      <span class="dt">handler</span><span class="op">:</span> <span class="vs">`StaleWhileRevalidate`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-36" title="36">    <span class="op">},</span></a>
<a class="sourceLine" id="cb8-37" title="37">  ]<span class="op">,</span></a>
<a class="sourceLine" id="cb8-38" title="38">  <span class="dt">skipWaiting</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-39" title="39">  <span class="dt">clientsClaim</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></a>
<a class="sourceLine" id="cb8-40" title="40"><span class="op">}</span></a></code></pre></div>
<h2 id="remove">Remove</h2>
<p>If you want to remove <code>gatsby-plugin-offline</code> from your site at a later point, substitute it with <a href="https://www.npmjs.com/package/gatsby-plugin-remove-serviceworker"><code>gatsby-plugin-remove-serviceworker</code></a> to safely remove the service worker. First, install the new package:</p>
<pre class="shell"><code>npm install gatsby-plugin-remove-serviceworker
npm uninstall gatsby-plugin-offline</code></pre>
<p>Then, update your <code>gatsby-config.js</code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode diff:title=gatsby-config.js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"> plugins<span class="op">:</span> [</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="op">-</span>  <span class="vs">`gatsby-plugin-offline`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-3" title="3"><span class="op">+</span>  <span class="vs">`gatsby-plugin-remove-serviceworker`</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-4" title="4"> ]</a></code></pre></div>
<p>This will ensure that the worker is properly unregistered, instead of leaving an outdated version registered in usersâ€™ browsers.</p>
<h2 id="notes">Notes</h2>
<h3 id="empty-view-source-and-seo">Empty View Source and SEO</h3>
<p>Gatsby offers great SEO capabilities and that is no different with <code>gatsby-plugin-offline</code>. However, you shouldnâ€™t think that Gatsby doesnâ€™t serve HTML tags anymore when looking at your source code in the browser (with <code>Right click</code> =&gt; <code>View source</code>). <code>View source</code> doesnâ€™t represent the actual HTML data since <code>gatsby-plugin-offline</code> registers and loads a service worker that will cache and handle this differently. Your site is loaded from the service worker, not from its actual source (check your <code>Network</code> tab in the DevTools for that).</p>
<p>To see the HTML data that crawlers will receive, run this in your terminal:</p>
<p><strong>on Windows (using powershell):</strong></p>
<pre class="shell"><code>Invoke-WebRequest https://www.yourdomain.tld | Select -ExpandProperty Content</code></pre>
<p><strong>on Mac OS/Linux:</strong></p>
<pre class="shell"><code>curl https://www.yourdomain.tld</code></pre>
<p>Alternatively you can have a look at the <code>/public/index.html</code> file in your project folder.</p>
<h3 id="app-shell-and-server-logs">App shell and server logs</h3>
<p>Server logs (like from <a href="https://www.netlify.com/products/analytics/">Netlify analytics</a>) may show a large number of pageviews to a route like <code>/offline-plugin-app-shell-fallback/index.html</code>, this is a result of <code>gatsby-plugin-offline</code> adding an <a href="https://developers.google.com/web/fundamentals/architecture/app-shell">app shell</a> to the page. The app shell is a minimal amount of user interface that can be cached offline for reliable performance loading on repeat visits. The shell can be loaded from the cache, and the content of the site loaded into the shell by the service worker.</p>
<h3 id="using-with-gatsby-plugin-manifest">Using with gatsby-plugin-manifest</h3>
<p>If using this plugin with <code>gatsby-plugin-manifest</code> you may find that your icons are not cached. In order to solve this, update your <code>gatsby-config.js</code> as follows:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="co">// gatsby-config.js</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="op">{</span></a>
<a class="sourceLine" id="cb13-3" title="3">   <span class="dt">resolve</span><span class="op">:</span> <span class="st">&#39;gatsby-plugin-manifest&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-4" title="4">   <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-5" title="5">      <span class="dt">icon</span><span class="op">:</span> <span class="st">&#39;icon.svg&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-6" title="6">      <span class="dt">cache_busting_mode</span><span class="op">:</span> <span class="st">&#39;none&#39;</span></a>
<a class="sourceLine" id="cb13-7" title="7">   <span class="op">}</span></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="op">},</span></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="op">{</span></a>
<a class="sourceLine" id="cb13-10" title="10">   <span class="dt">resolve</span><span class="op">:</span> <span class="st">&#39;gatsby-plugin-offline&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb13-11" title="11">   <span class="dt">options</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-12" title="12">      <span class="dt">workboxConfig</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb13-13" title="13">         <span class="dt">globPatterns</span><span class="op">:</span> [<span class="st">&#39;**/icon-path*&#39;</span>]</a>
<a class="sourceLine" id="cb13-14" title="14">      <span class="op">}</span></a>
<a class="sourceLine" id="cb13-15" title="15">   <span class="op">}</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="op">}</span></a></code></pre></div>
<p>Updating <code>cache_busting_mode</code> is necessary. Otherwise, workbox will break while attempting to find the cached URLs. Adding the <code>globPatterns</code> makes sure that the offline plugin will cache everything. Note that you have to prefix your icon with <code>icon-path</code> or whatever you may call it</p>
</body>
</html>
