<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="qs-version-badge21">qs <sup><a href="https://npmjs.org/package/qs"><img src="http://versionbadg.es/ljharb/qs.svg" alt="Version Badge" /></a></sup></h1>
<p><a href="https://travis-ci.org/ljharb/qs"><img src="https://api.travis-ci.org/ljharb/qs.svg" alt="Build Status" /></a> <a href="https://david-dm.org/ljharb/qs"><img src="https://david-dm.org/ljharb/qs.svg" alt="dependency status" /></a> <a href="https://david-dm.org/ljharb/qs?type=dev"><img src="https://david-dm.org/ljharb/qs/dev-status.svg" alt="dev dependency status" /></a> <a href="LICENSE"><img src="http://img.shields.io/npm/l/qs.svg" alt="License" /></a> <a href="http://npm-stat.com/charts.html?package=qs"><img src="http://img.shields.io/npm/dm/qs.svg" alt="Downloads" /></a></p>
<p><a href="https://npmjs.org/package/qs"><img src="https://nodei.co/npm/qs.png?downloads=true&amp;stars=true" alt="npm badge" /></a></p>
<p>A querystring parsing and stringifying library with some added security.</p>
<p>Lead Maintainer: <a href="https://github.com/ljharb">Jordan Harband</a></p>
<p>The <strong>qs</strong> module was originally created and maintained by <a href="https://github.com/visionmedia/node-querystring">TJ Holowaychuk</a>.</p>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">var</span> qs <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;qs&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">var</span> assert <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;assert&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">var</span> obj <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="va">assert</span>.<span class="at">deepEqual</span>(obj<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="kw">var</span> str <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(obj)<span class="op">;</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="va">assert</span>.<span class="at">equal</span>(str<span class="op">,</span> <span class="st">&#39;a=c&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="parsing-objects">Parsing Objects</h3>
<p><a href="#preventEval"></a></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="va">qs</span>.<span class="at">parse</span>(string<span class="op">,</span> [options])<span class="op">;</span></a></code></pre></div>
<p><strong>qs</strong> allows you to create nested objects within your query strings, by surrounding the name of sub-keys with square brackets <code>[]</code>. For example, the string <code>'foo[bar]=baz'</code> converts to:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"><span class="va">assert</span>.<span class="at">deepEqual</span>(<span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;foo[bar]=baz&#39;</span>)<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-2" title="2">    <span class="dt">foo</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb3-3" title="3">        <span class="dt">bar</span><span class="op">:</span> <span class="st">&#39;baz&#39;</span></a>
<a class="sourceLine" id="cb3-4" title="4">    <span class="op">}</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>When using the <code>plainObjects</code> option the parsed value is returned as a null object, created via <code>Object.create(null)</code> and as such you should be aware that prototype methods will not exist on it and a user may set those names to whatever value they like:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> nullObject <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[hasOwnProperty]=b&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">plainObjects</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(nullObject<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">hasOwnProperty</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>By default parameters that would overwrite properties on the object prototype are ignored, if you wish to keep the data from those fields either use <code>plainObjects</code> as mentioned above, or set <code>allowPrototypes</code> to <code>true</code> which will allow user input to overwrite those properties. <em>WARNING</em> It is generally a bad idea to enable this option as it can cause problems when attempting to use the properties that have been overwritten. Always be careful with this option.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">var</span> protoObject <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[hasOwnProperty]=b&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">allowPrototypes</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(protoObject<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">hasOwnProperty</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>URI encoded strings work too:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="va">assert</span>.<span class="at">deepEqual</span>(<span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a%5Bb%5D=c&#39;</span>)<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-2" title="2">    <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You can also nest your objects, like <code>'foo[bar][baz]=foobarbaz'</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="va">assert</span>.<span class="at">deepEqual</span>(<span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;foo[bar][baz]=foobarbaz&#39;</span>)<span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-2" title="2">    <span class="dt">foo</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-3" title="3">        <span class="dt">bar</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb7-4" title="4">            <span class="dt">baz</span><span class="op">:</span> <span class="st">&#39;foobarbaz&#39;</span></a>
<a class="sourceLine" id="cb7-5" title="5">        <span class="op">}</span></a>
<a class="sourceLine" id="cb7-6" title="6">    <span class="op">}</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>By default, when nesting objects <strong>qs</strong> will only parse up to 5 children deep. This means if you attempt to parse a string like <code>'a[b][c][d][e][f][g][h][i]=j'</code> your resulting object will be:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">var</span> expected <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-2" title="2">    <span class="dt">a</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-3" title="3">        <span class="dt">b</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-4" title="4">            <span class="dt">c</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-5" title="5">                <span class="dt">d</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-6" title="6">                    <span class="dt">e</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-7" title="7">                        <span class="dt">f</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb8-8" title="8">                            <span class="st">&#39;[g][h][i]&#39;</span><span class="op">:</span> <span class="st">&#39;j&#39;</span></a>
<a class="sourceLine" id="cb8-9" title="9">                        <span class="op">}</span></a>
<a class="sourceLine" id="cb8-10" title="10">                    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-11" title="11">                <span class="op">}</span></a>
<a class="sourceLine" id="cb8-12" title="12">            <span class="op">}</span></a>
<a class="sourceLine" id="cb8-13" title="13">        <span class="op">}</span></a>
<a class="sourceLine" id="cb8-14" title="14">    <span class="op">}</span></a>
<a class="sourceLine" id="cb8-15" title="15"><span class="op">};</span></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="kw">var</span> string <span class="op">=</span> <span class="st">&#39;a[b][c][d][e][f][g][h][i]=j&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb8-17" title="17"><span class="va">assert</span>.<span class="at">deepEqual</span>(<span class="va">qs</span>.<span class="at">parse</span>(string)<span class="op">,</span> expected)<span class="op">;</span></a></code></pre></div>
<p>This depth can be overridden by passing a <code>depth</code> option to <code>qs.parse(string, [options])</code>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">var</span> deep <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[b][c][d][e][f][g][h][i]=j&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">depth</span><span class="op">:</span> <span class="dv">1</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(deep<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;[c][d][e][f][g][h][i]&#39;</span><span class="op">:</span> <span class="st">&#39;j&#39;</span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>The depth limit helps mitigate abuse when <strong>qs</strong> is used to parse user input, and it is recommended to keep it a reasonably small number.</p>
<p>For similar reasons, by default <strong>qs</strong> will only parse up to 1000 parameters. This can be overridden by passing a <code>parameterLimit</code> option:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">var</span> limited <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=b&amp;c=d&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">parameterLimit</span><span class="op">:</span> <span class="dv">1</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(limited<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To bypass the leading question mark, use <code>ignoreQueryPrefix</code>:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">var</span> prefixed <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;?a=b&amp;c=d&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">ignoreQueryPrefix</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(prefixed<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>An optional delimiter can also be passed:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">var</span> delimited <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=b;c=d&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">delimiter</span><span class="op">:</span> <span class="st">&#39;;&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(delimited<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Delimiters can be a regular expression too:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">var</span> regexed <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=b;c=d,e=f&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">delimiter</span><span class="op">:</span> <span class="ss">/</span><span class="sc">[;,]</span><span class="ss">/</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(regexed<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Option <code>allowDots</code> can be used to enable dot notation:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">var</span> withDots <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a.b=c&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">allowDots</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb14-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withDots<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If you have to deal with legacy browsers or services, there’s also support for decoding percent-encoded octets as iso-8859-1:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">var</span> oldCharset <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=%A7&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(oldCharset<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;§&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Some services add an initial <code>utf8=✓</code> value to forms so that old Internet Explorer versions are more likely to submit the form as utf-8. Additionally, the server can check the value against wrong encodings of the checkmark character and detect that a query string or <code>application/x-www-form-urlencoded</code> body was <em>not</em> sent as utf-8, eg. if the form had an <code>accept-charset</code> parameter or the containing page had a different character set.</p>
<p><strong>qs</strong> supports this mechanism via the <code>charsetSentinel</code> option. If specified, the <code>utf8</code> parameter will be omitted from the returned object. It will be used to switch to <code>iso-8859-1</code>/<code>utf-8</code> mode depending on how the checkmark is encoded.</p>
<p><strong>Important</strong>: When you specify both the <code>charset</code> option and the <code>charsetSentinel</code> option, the <code>charset</code> will be overridden when the request contains a <code>utf8</code> parameter from which the actual charset can be deduced. In that sense the <code>charset</code> will behave as the default charset rather than the authoritative charset.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">var</span> detectedAsUtf8 <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;utf8=%E2%9C%93&amp;a=%C3%B8&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-2" title="2">    <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-3" title="3">    <span class="dt">charsetSentinel</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-5" title="5"><span class="va">assert</span>.<span class="at">deepEqual</span>(detectedAsUtf8<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;ø&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-6" title="6"></a>
<a class="sourceLine" id="cb16-7" title="7"><span class="co">// Browsers encode the checkmark as &amp;#10003; when submitting as iso-8859-1:</span></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="kw">var</span> detectedAsIso8859_1 <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;utf8=%26%2310003%3B&amp;a=%F8&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-9" title="9">    <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;utf-8&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-10" title="10">    <span class="dt">charsetSentinel</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb16-11" title="11"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb16-12" title="12"><span class="va">assert</span>.<span class="at">deepEqual</span>(detectedAsIso8859_1<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;ø&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If you want to decode the <code>&amp;#...;</code> syntax to the actual character, you can specify the <code>interpretNumericEntities</code> option as well:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">var</span> detectedAsIso8859_1 <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=%26%239786%3B&#39;</span><span class="op">,</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb17-2" title="2">    <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb17-3" title="3">    <span class="dt">interpretNumericEntities</span><span class="op">:</span> <span class="kw">true</span></a>
<a class="sourceLine" id="cb17-4" title="4"><span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb17-5" title="5"><span class="va">assert</span>.<span class="at">deepEqual</span>(detectedAsIso8859_1<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;☺&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>It also works when the charset has been detected in <code>charsetSentinel</code> mode.</p>
<h3 id="parsing-arrays">Parsing Arrays</h3>
<p><strong>qs</strong> can also parse arrays using a similar <code>[]</code> notation:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">var</span> withArray <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[]=b&amp;a[]=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withArray<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You may specify an index as well:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">var</span> withIndexes <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[1]=c&amp;a[0]=b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb19-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withIndexes<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Note that the only difference between an index in an array and a key in an object is that the value between the brackets must be a number to create an array. When creating arrays with specific indices, <strong>qs</strong> will compact a sparse array to only the existing values preserving their order:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">var</span> noSparse <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[1]=b&amp;a[15]=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb20-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(noSparse<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Note that an empty string is also a value, and will be preserved:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">var</span> withEmptyString <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[]=&amp;a[]=b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withEmptyString<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;&#39;</span><span class="op">,</span> <span class="st">&#39;b&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-3" title="3"></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="kw">var</span> withIndexedEmptyString <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[0]=b&amp;a[1]=&amp;a[2]=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="va">assert</span>.<span class="at">deepEqual</span>(withIndexedEmptyString<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p><strong>qs</strong> will also limit specifying indices in an array to a maximum index of <code>20</code>. Any array members with an index of greater than <code>20</code> will instead be converted to an object with the index as the key. This is needed to handle cases when someone sent, for example, <code>a[999999999]</code> and it will take significant time to iterate over this huge array.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">var</span> withMaxIndex <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[100]=b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withMaxIndex<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;100&#39;</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>This limit can be overridden by passing an <code>arrayLimit</code> option:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">var</span> withArrayLimit <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[1]=b&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">arrayLimit</span><span class="op">:</span> <span class="dv">0</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb23-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(withArrayLimit<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;1&#39;</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To disable array parsing entirely, set <code>parseArrays</code> to <code>false</code>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">var</span> noParsingArrays <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[]=b&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">parseArrays</span><span class="op">:</span> <span class="kw">false</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb24-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(noParsingArrays<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;0&#39;</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>If you mix notations, <strong>qs</strong> will merge the two items into an object:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">var</span> mixedNotation <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[0]=b&amp;a[b]=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb25-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(mixedNotation<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="st">&#39;0&#39;</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>You can also create arrays of objects:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">var</span> arraysOfObjects <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a[][b]=c&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(arraysOfObjects<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span>] <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>Some people use comma to join array, <strong>qs</strong> can parse it:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">var</span> arraysOfObjects <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=b,c&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">comma</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb27-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(arraysOfObjects<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">}</span>)</a></code></pre></div>
<p>(<em>this cannot convert nested objects, such as <code>a={b:1},{c:d}</code></em>)</p>
<h3 id="stringifying">Stringifying</h3>
<p><a href="#preventEval"></a></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb28-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(object<span class="op">,</span> [options])<span class="op">;</span></a></code></pre></div>
<p>When stringifying, <strong>qs</strong> by default URI encodes output. Objects are stringified as you would expect:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb29-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=b&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb29-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a%5Bb%5D=c&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>This encoding can be disabled by setting the <code>encode</code> option to <code>false</code>:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">var</span> unencoded <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">encode</span><span class="op">:</span> <span class="kw">false</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb30-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(unencoded<span class="op">,</span> <span class="st">&#39;a[b]=c&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Encoding can be disabled for keys by setting the <code>encodeValuesOnly</code> option to <code>true</code>:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">var</span> encodedValues <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(</a>
<a class="sourceLine" id="cb31-2" title="2">    <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> [<span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="st">&#39;e=f&#39;</span>]<span class="op">,</span> <span class="dt">f</span><span class="op">:</span> [[<span class="st">&#39;g&#39;</span>]<span class="op">,</span> [<span class="st">&#39;h&#39;</span>]] <span class="op">},</span></a>
<a class="sourceLine" id="cb31-3" title="3">    <span class="op">{</span> <span class="dt">encodeValuesOnly</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span></a>
<a class="sourceLine" id="cb31-4" title="4">)<span class="op">;</span></a>
<a class="sourceLine" id="cb31-5" title="5"><span class="va">assert</span>.<span class="at">equal</span>(encodedValues<span class="op">,</span><span class="st">&#39;a=b&amp;c[0]=d&amp;c[1]=e%3Df&amp;f[0][0]=g&amp;f[1][0]=h&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>This encoding can also be replaced by a custom encoding method set as <code>encoder</code> option:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">var</span> encoded <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;c&#39;</span> <span class="op">}</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">encoder</span><span class="op">:</span> <span class="kw">function</span> (str) <span class="op">{</span></a>
<a class="sourceLine" id="cb32-2" title="2">    <span class="co">// Passed in values `a`, `b`, `c`</span></a>
<a class="sourceLine" id="cb32-3" title="3">    <span class="cf">return</span> <span class="co">// Return encoded string</span></a>
<a class="sourceLine" id="cb32-4" title="4"><span class="op">}}</span>)</a></code></pre></div>
<p><em>(Note: the <code>encoder</code> option does not apply if <code>encode</code> is <code>false</code>)</em></p>
<p>Analogue to the <code>encoder</code> there is a <code>decoder</code> option for <code>parse</code> to override decoding of properties and values:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">var</span> decoded <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;x=z&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">decoder</span><span class="op">:</span> <span class="kw">function</span> (str) <span class="op">{</span></a>
<a class="sourceLine" id="cb33-2" title="2">    <span class="co">// Passed in values `x`, `z`</span></a>
<a class="sourceLine" id="cb33-3" title="3">    <span class="cf">return</span> <span class="co">// Return decoded string</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="op">}}</span>)</a></code></pre></div>
<p>Examples beyond this point will be shown as though the output is not URI encoded for clarity. Please note that the return values in these cases <em>will</em> be URI encoded during real usage.</p>
<p>When arrays are stringified, by default they are given explicit indices:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb34-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span><span class="op">,</span> <span class="st">&#39;d&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="co">// &#39;a[0]=b&amp;a[1]=c&amp;a[2]=d&#39;</span></a></code></pre></div>
<p>You may override this by setting the <code>indices</code> option to <code>false</code>:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb35-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span><span class="op">,</span> <span class="st">&#39;d&#39;</span>] <span class="op">},</span> <span class="op">{</span> <span class="dt">indices</span><span class="op">:</span> <span class="kw">false</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb35-2" title="2"><span class="co">// &#39;a=b&amp;a=c&amp;a=d&#39;</span></a></code></pre></div>
<p>You may use the <code>arrayFormat</code> option to specify the format of the output array:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb36-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">},</span> <span class="op">{</span> <span class="dt">arrayFormat</span><span class="op">:</span> <span class="st">&#39;indices&#39;</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb36-2" title="2"><span class="co">// &#39;a[0]=b&amp;a[1]=c&#39;</span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">},</span> <span class="op">{</span> <span class="dt">arrayFormat</span><span class="op">:</span> <span class="st">&#39;brackets&#39;</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb36-4" title="4"><span class="co">// &#39;a[]=b&amp;a[]=c&#39;</span></a>
<a class="sourceLine" id="cb36-5" title="5"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">},</span> <span class="op">{</span> <span class="dt">arrayFormat</span><span class="op">:</span> <span class="st">&#39;repeat&#39;</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb36-6" title="6"><span class="co">// &#39;a=b&amp;a=c&#39;</span></a>
<a class="sourceLine" id="cb36-7" title="7"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span>] <span class="op">},</span> <span class="op">{</span> <span class="dt">arrayFormat</span><span class="op">:</span> <span class="st">&#39;comma&#39;</span> <span class="op">}</span>)</a>
<a class="sourceLine" id="cb36-8" title="8"><span class="co">// &#39;a=b,c&#39;</span></a></code></pre></div>
<p>When objects are stringified, by default they use bracket notation:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb37-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="op">{</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">}</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="co">// &#39;a[b][c]=d&amp;a[b][e]=f&#39;</span></a></code></pre></div>
<p>You may override this to use dot notation by setting the <code>allowDots</code> option to <code>true</code>:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb38-1" title="1"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="op">{</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">}</span> <span class="op">}</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">allowDots</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb38-2" title="2"><span class="co">// &#39;a.b.c=d&amp;a.b.e=f&#39;</span></a></code></pre></div>
<p>Empty strings and null values will omit the value, but the equals sign (=) remains in place:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb39-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Key with no values (such as an empty object or array) will return nothing:</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb40-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [] <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{}</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="op">{}</span>] <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> []<span class="op">}</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="op">{</span> <span class="dt">b</span><span class="op">:</span> <span class="op">{}}</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Properties that are set to <code>undefined</code> will be omitted entirely:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb41-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="kw">undefined</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>The query string may optionally be prepended with a question mark:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb42-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">addQueryPrefix</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;?a=b&amp;c=d&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>The delimiter may be overridden with stringify as well:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb43-1" title="1"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">delimiter</span><span class="op">:</span> <span class="st">&#39;;&#39;</span> <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=b;c=d&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>If you only want to override the serialization of <code>Date</code> objects, you can provide a <code>serializeDate</code> option:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">var</span> date <span class="op">=</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="dv">7</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> date <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=1970-01-01T00:00:00.007Z&#39;</span>.<span class="at">replace</span>(<span class="ss">/:/g</span><span class="op">,</span> <span class="st">&#39;%3A&#39;</span>))<span class="op">;</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="va">assert</span>.<span class="at">equal</span>(</a>
<a class="sourceLine" id="cb44-4" title="4">    <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> date <span class="op">},</span> <span class="op">{</span> <span class="dt">serializeDate</span><span class="op">:</span> <span class="kw">function</span> (d) <span class="op">{</span> <span class="cf">return</span> <span class="va">d</span>.<span class="at">getTime</span>()<span class="op">;</span> <span class="op">}</span> <span class="op">}</span>)<span class="op">,</span></a>
<a class="sourceLine" id="cb44-5" title="5">    <span class="st">&#39;a=7&#39;</span></a>
<a class="sourceLine" id="cb44-6" title="6">)<span class="op">;</span></a></code></pre></div>
<p>You may use the <code>sort</code> option to affect the order of parameter keys:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">function</span> <span class="at">alphabeticalSort</span>(a<span class="op">,</span> b) <span class="op">{</span></a>
<a class="sourceLine" id="cb45-2" title="2">    <span class="cf">return</span> <span class="va">a</span>.<span class="at">localeCompare</span>(b)<span class="op">;</span></a>
<a class="sourceLine" id="cb45-3" title="3"><span class="op">}</span></a>
<a class="sourceLine" id="cb45-4" title="4"><span class="va">assert</span>.<span class="at">equal</span>(<span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;c&#39;</span><span class="op">,</span> <span class="dt">z</span><span class="op">:</span> <span class="st">&#39;y&#39;</span><span class="op">,</span> <span class="dt">b </span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">sort</span><span class="op">:</span> alphabeticalSort <span class="op">}</span>)<span class="op">,</span> <span class="st">&#39;a=c&amp;b=f&amp;z=y&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Finally, you can use the <code>filter</code> option to restrict which keys will be included in the stringified output. If you pass a function, it will be called for each key to obtain the replacement value. Otherwise, if you pass an array, it will be used to select properties and array indices for stringification:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb46-1" title="1"><span class="kw">function</span> <span class="at">filterFunc</span>(prefix<span class="op">,</span> value) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-2" title="2">    <span class="cf">if</span> (prefix <span class="op">==</span> <span class="st">&#39;b&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-3" title="3">        <span class="co">// Return an `undefined` value to omit a property.</span></a>
<a class="sourceLine" id="cb46-4" title="4">        <span class="cf">return</span><span class="op">;</span></a>
<a class="sourceLine" id="cb46-5" title="5">    <span class="op">}</span></a>
<a class="sourceLine" id="cb46-6" title="6">    <span class="cf">if</span> (prefix <span class="op">==</span> <span class="st">&#39;e[f]&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-7" title="7">        <span class="cf">return</span> <span class="va">value</span>.<span class="at">getTime</span>()<span class="op">;</span></a>
<a class="sourceLine" id="cb46-8" title="8">    <span class="op">}</span></a>
<a class="sourceLine" id="cb46-9" title="9">    <span class="cf">if</span> (prefix <span class="op">==</span> <span class="st">&#39;e[g][0]&#39;</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb46-10" title="10">        <span class="cf">return</span> value <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></a>
<a class="sourceLine" id="cb46-11" title="11">    <span class="op">}</span></a>
<a class="sourceLine" id="cb46-12" title="12">    <span class="cf">return</span> value<span class="op">;</span></a>
<a class="sourceLine" id="cb46-13" title="13"><span class="op">}</span></a>
<a class="sourceLine" id="cb46-14" title="14"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="op">{</span> <span class="dt">f</span><span class="op">:</span> <span class="kw">new</span> <span class="at">Date</span>(<span class="dv">123</span>)<span class="op">,</span> <span class="dt">g</span><span class="op">:</span> [<span class="dv">2</span>] <span class="op">}</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">filter</span><span class="op">:</span> filterFunc <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-15" title="15"><span class="co">// &#39;a=b&amp;c=d&amp;e[f]=123&amp;e[g][0]=4&#39;</span></a>
<a class="sourceLine" id="cb46-16" title="16"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="st">&#39;d&#39;</span><span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">filter</span><span class="op">:</span> [<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="st">&#39;e&#39;</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-17" title="17"><span class="co">// &#39;a=b&amp;e=f&#39;</span></a>
<a class="sourceLine" id="cb46-18" title="18"><span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> [<span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="st">&#39;c&#39;</span><span class="op">,</span> <span class="st">&#39;d&#39;</span>]<span class="op">,</span> <span class="dt">e</span><span class="op">:</span> <span class="st">&#39;f&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">filter</span><span class="op">:</span> [<span class="st">&#39;a&#39;</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="dv">2</span>] <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb46-19" title="19"><span class="co">// &#39;a[0]=b&amp;a[2]=d&#39;</span></a></code></pre></div>
<h3 id="handling-of-null-values">Handling of <code>null</code> values</h3>
<p>By default, <code>null</code> values are treated like empty strings:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">var</span> withNull <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb47-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(withNull<span class="op">,</span> <span class="st">&#39;a=&amp;b=&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Parsing does not distinguish between parameters with and without equal signs. Both are converted to empty strings.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">var</span> equalsInsensitive <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a&amp;b=&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(equalsInsensitive<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;&#39;</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To distinguish between <code>null</code> values and empty strings use the <code>strictNullHandling</code> flag. In the result string the <code>null</code> values have no <code>=</code> sign:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">var</span> strictNull <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">strictNullHandling</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(strictNull<span class="op">,</span> <span class="st">&#39;a&amp;b=&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>To parse values without <code>=</code> back to <code>null</code> use the <code>strictNullHandling</code> flag:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">var</span> parsedStrictNull <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a&amp;b=&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">strictNullHandling</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb50-2" title="2"><span class="va">assert</span>.<span class="at">deepEqual</span>(parsedStrictNull<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span> <span class="dt">b</span><span class="op">:</span> <span class="st">&#39;&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<p>To completely skip rendering keys with <code>null</code> values, use the <code>skipNulls</code> flag:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">var</span> nullsSkipped <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;b&#39;</span><span class="op">,</span> <span class="dt">c</span><span class="op">:</span> <span class="kw">null</span><span class="op">},</span> <span class="op">{</span> <span class="dt">skipNulls</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb51-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(nullsSkipped<span class="op">,</span> <span class="st">&#39;a=b&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>If you’re communicating with legacy systems, you can switch to <code>iso-8859-1</code> using the <code>charset</code> option:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb52-1" title="1"><span class="kw">var</span> iso <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">æ</span><span class="op">:</span> <span class="st">&#39;æ&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(iso<span class="op">,</span> <span class="st">&#39;%E6=%E6&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>Characters that don’t exist in <code>iso-8859-1</code> will be converted to numeric entities, similar to what browsers do:</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">var</span> numeric <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;☺&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb53-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(numeric<span class="op">,</span> <span class="st">&#39;a=%26%239786%3B&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>You can use the <code>charsetSentinel</code> option to announce the character by including an <code>utf8=✓</code> parameter with the proper encoding if the checkmark, similar to what Ruby on Rails and others do when submitting forms.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">var</span> sentinel <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;☺&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">charsetSentinel</span><span class="op">:</span> <span class="kw">true</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="va">assert</span>.<span class="at">equal</span>(sentinel<span class="op">,</span> <span class="st">&#39;utf8=%E2%9C%93&amp;a=%E2%98%BA&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-3" title="3"></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="kw">var</span> isoSentinel <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;æ&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">charsetSentinel</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span> <span class="dt">charset</span><span class="op">:</span> <span class="st">&#39;iso-8859-1&#39;</span> <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="va">assert</span>.<span class="at">equal</span>(isoSentinel<span class="op">,</span> <span class="st">&#39;utf8=%26%2310003%3B&amp;a=%E6&#39;</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="dealing-with-special-character-sets">Dealing with special character sets</h3>
<p>By default the encoding and decoding of characters is done in <code>utf-8</code>, and <code>iso-8859-1</code> support is also built in via the <code>charset</code> parameter.</p>
<p>If you wish to encode querystrings to a different character set (i.e. <a href="https://en.wikipedia.org/wiki/Shift_JIS">Shift JIS</a>) you can use the <a href="https://github.com/martinheidegger/qs-iconv"><code>qs-iconv</code></a> library:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">var</span> encoder <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;qs-iconv/encoder&#39;</span>)(<span class="st">&#39;shift_jis&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">var</span> shiftJISEncoded <span class="op">=</span> <span class="va">qs</span>.<span class="at">stringify</span>(<span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;こんにちは！&#39;</span> <span class="op">},</span> <span class="op">{</span> <span class="dt">encoder</span><span class="op">:</span> encoder <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb55-3" title="3"><span class="va">assert</span>.<span class="at">equal</span>(shiftJISEncoded<span class="op">,</span> <span class="st">&#39;a=%82%B1%82%F1%82%C9%82%BF%82%CD%81I&#39;</span>)<span class="op">;</span></a></code></pre></div>
<p>This also works for decoding of query strings:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">var</span> decoder <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;qs-iconv/decoder&#39;</span>)(<span class="st">&#39;shift_jis&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">var</span> obj <span class="op">=</span> <span class="va">qs</span>.<span class="at">parse</span>(<span class="st">&#39;a=%82%B1%82%F1%82%C9%82%BF%82%CD%81I&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">decoder</span><span class="op">:</span> decoder <span class="op">}</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb56-3" title="3"><span class="va">assert</span>.<span class="at">deepEqual</span>(obj<span class="op">,</span> <span class="op">{</span> <span class="dt">a</span><span class="op">:</span> <span class="st">&#39;こんにちは！&#39;</span> <span class="op">}</span>)<span class="op">;</span></a></code></pre></div>
<h3 id="rfc-3986-and-rfc-1738-space-encoding">RFC 3986 and RFC 1738 space encoding</h3>
<p>RFC3986 used as default option and encodes ’ ’ to <em>%20</em> which is backward compatible. In the same time, output can be stringified as per RFC1738 with ’ ’ equal to ‘+’.</p>
<pre><code>assert.equal(qs.stringify({ a: &#39;b c&#39; }), &#39;a=b%20c&#39;);
assert.equal(qs.stringify({ a: &#39;b c&#39; }, { format : &#39;RFC3986&#39; }), &#39;a=b%20c&#39;);
assert.equal(qs.stringify({ a: &#39;b c&#39; }, { format : &#39;RFC1738&#39; }), &#39;a=b+c&#39;);</code></pre>
</body>
</html>
