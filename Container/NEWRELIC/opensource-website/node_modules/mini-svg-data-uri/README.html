<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="mini-svg-data-uri">Mini SVG <code>data:</code> URI</h1>
<p>This tool converts SVGs into the most compact, compressible <code>data:</code> URI that SVG-supporting browsers tolerate. The results look like this (169 bytes):</p>
<pre class="url"><code>data:image/svg+xml,%3csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 50 50&#39;
%3e%3cpath d=&#39;M22 38V51L32 32l19-19v12C44 26 43 10 38 0 52 15 49 39 22 38z&#39;/%3e
%3c/svg%3e</code></pre>
<p>Compare to the Base64 version (210 bytes):</p>
<pre class="url"><code>data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIH
ZpZXdCb3g9IjAgMCA1MCA1MCI+PHBhdGggZD0iTTIyIDM4VjUxTDMyIDMybDE5LTE5djEyQzQ0IDI2ID
QzIDEwIDM4IDAgNTIgMTUgNDkgMzkgMjIgMzh6Ii8+PC9zdmc+</code></pre>
<p>Or the URL-encoded version other tools produce (256 bytes):</p>
<pre class="url"><code>data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%
2F2000%2Fsvg%22%20viewBox%3D%220%200%2050%2050%22%3E%3Cpath%20d%3D%22M22%2038V51
L32%2032l19-19v12C44%2026%2043%2010%2038%200%2052%2015%2049%2039%2022%2038z%22%2
F%3E%3C%2Fsvg%3E</code></pre>
<p>For a more realistic example, I inlined the icons from the <a href="https://useiconic.com/open">Open Iconic</a> project into CSS files with the 3 above methods:</p>
<table>
<thead>
<tr class="header">
<th>Compression</th>
<th style="text-align: right;">Base64</th>
<th style="text-align: right;">Basic %-encoding</th>
<th style="text-align: right;"><code>mini-svg-data-uri</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>None</td>
<td style="text-align: right;">96.459 kB</td>
<td style="text-align: right;">103.268 kB</td>
<td style="text-align: right;">76.583 kB</td>
</tr>
<tr class="even">
<td><code>gzip -9</code></td>
<td style="text-align: right;">17.902 kB</td>
<td style="text-align: right;">13.780 kB</td>
<td style="text-align: right;">12.974 kB</td>
</tr>
<tr class="odd">
<td><code>brotli -Z</code></td>
<td style="text-align: right;">15.797 kB</td>
<td style="text-align: right;">11.693 kB</td>
<td style="text-align: right;">10.976 kB</td>
</tr>
</tbody>
</table>
<p>Roughly 6% smaller compressed, but don’t write off the ≈20% uncompressed savings either. <a href="https://blogs.msdn.microsoft.com/ieinternals/2014/10/21/compressing-the-web/">Some browser caches decompress before store</a>, and parsing time/memory usage scale linearly with uncompressed filesize.</p>
<h2 id="usage">Usage</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> svgToMiniDataURI <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;mini-svg-data-uri&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">var</span> svg <span class="op">=</span> <span class="st">&#39;&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; viewBox=&quot;0 0 50 50&quot;&gt;&lt;path d=&quot;M22 38V51L32 32l19-19v12C44 26 43 10 38 0 52 15 49 39 22 38z&quot;/&gt;&lt;/svg&gt;&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-4" title="4"></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="kw">var</span> optimizedSVGDataURI <span class="op">=</span> <span class="at">svgToMiniDataURI</span>(svg)<span class="op">;</span></a>
<a class="sourceLine" id="cb4-6" title="6"><span class="co">// &quot;data:image/svg+xml,%3csvg xmlns=&#39;http://www.w3.org/2000/svg&#39; viewBox=&#39;0 0 50 50&#39;%3e%3cpath d=&#39;M22 38V51L32 32l19-19v12C44 26 43 10 38 0 52 15 49 39 22 38z&#39;/%3e%3c/svg%3e&quot;</span></a></code></pre></div>
<p>You can also <a href="https://npm.runkit.com/mini-svg-data-uri">try it in your browser at RunKit</a>.</p>
<h3 id="cli">CLI</h3>
<p>If you have it installed globally, or as some kind of dependency inside your project’s directory:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="ex">mini-svg-to-data-uri</span> file.svg <span class="co"># writes to stdout</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="ex">mini-svg-to-data-uri</span> file.svg file.svg.uri <span class="co"># writes to the given output filename</span></a></code></pre></div>
<p>Use <code>--help</code> for more info.</p>
<h3 id="warning">Warning</h3>
<ul>
<li><p>This <strong>does not optimize the SVG source file</strong>. You’ll want <a href="https://github.com/svg/svgo">svgo</a> or its brother <a href="https://jakearchibald.github.io/svgomg/">SVGOMG</a> for that.</p></li>
<li><p>The default output <strong>does not work inside <code>srcset</code> attributes</strong>. Use the <code>.toSrcset</code> method for that:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> srcsetExample <span class="op">=</span> html<span class="vs">`</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="vs">&lt;picture&gt;</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="vs">  &lt;source srcset=&quot;</span><span class="sc">${</span><span class="va">svgToMiniDataURI</span>.<span class="at">toSrcset</span>(svg)<span class="sc">}</span><span class="vs">&quot;&gt;</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="vs">  &lt;img src=&quot;</span><span class="sc">${</span><span class="at">svgToMiniDataURI</span>(svg)<span class="sc">}</span><span class="vs">&quot;&gt;</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="vs">&lt;/picture&gt;`</span><span class="op">;</span></a></code></pre></div></li>
<li><p>The resulting Data URI should be wrapped with double quotes: <code>url("…")</code>, <code>&lt;img src="…"&gt;</code>, etc.</p></li>
<li><p>This might change or break SVGs that use <code>"</code> in character data, like inside <code>&lt;text&gt;</code> or <code>aria-label</code> or something. Try curly quotes (<code>“”</code>) or <code>&amp;quot;</code> instead.</p></li>
</ul>
<h2 id="faq">FAQ</h2>
<h3 id="dont-you-need-a-charset-in-the-mime-type">Don’t you need a <code>charset</code> in the MIME Type?</h3>
<p><code>charset</code> does nothing for Data URIs. The URI can only be the encoding of its parent file — it’s included in it!</p>
<h3 id="why-lowercase-the-url-encoded-hex-pairs">Why lowercase the URL-encoded hex pairs?</h3>
<p>It compresses slightly better. No, really. Using the same files from earlier:</p>
<table>
<thead>
<tr class="header">
<th>Compression</th>
<th style="text-align: right;">Uppercase (<code>%AF</code>)</th>
<th style="text-align: right;">Lowercase (<code>%af</code>)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>gzip -9</code></td>
<td style="text-align: right;">12.978 kB</td>
<td style="text-align: right;">12.974 kB</td>
</tr>
<tr class="even">
<td><code>brotli -Z</code></td>
<td style="text-align: right;">10.988 kB</td>
<td style="text-align: right;">10.976 kB</td>
</tr>
</tbody>
</table>
<p>I did say <em>slightly</em>.</p>
<h2 id="browser-support">Browser support</h2>
<ul>
<li>Internet Explorer 9 and up, including Edge</li>
<li>Firefox, Safari, Chrome, whatever else uses their engines</li>
<li>Android WebKit 3+</li>
<li>Opera Mini’s server-side Presto</li>
</ul>
</body>
</html>
