<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>no-large-snapshots</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<h1 id="disallow-large-snapshots-no-large-snapshots">disallow large snapshots (no-large-snapshots)</h1>
<p>When using Jest’s snapshot capability one should be mindful of the size of created snapshots. As a best practice snapshots should be limited in size in order to be more manageable and reviewable. A stored snapshot is only as good as its review and as such keeping it short, sweet, and readable is important to allow for thorough reviews.</p>
<h2 id="usage">Usage</h2>
<p>Because Jest snapshots are written with back-ticks (` `) which are only valid with <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals">ES2015 onwards</a> you should set <code>parserOptions</code> in your config to at least allow ES2015 in order to use this rule:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1">parserOptions<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb1-2" title="2">  <span class="dt">ecmaVersion</span><span class="op">:</span> <span class="dv">2015</span><span class="op">,</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="op">},</span></a></code></pre></div>
<h2 id="rule-details">Rule Details</h2>
<p>This rule looks at all Jest inline and external snapshots (files with <code>.snap</code> extension) and validates that each stored snapshot within those files does not exceed 50 lines (by default, this is configurable as explained in <code>Options</code> section below).</p>
<p>Example of <strong>incorrect</strong> code for this rule:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1">exports[<span class="vs">`a large snapshot 1`</span>] <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="vs">line 1</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="vs">line 2</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="vs">line 3</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="vs">line 4</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="vs">line 5</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="vs">line 6</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="vs">line 7</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="vs">line 8</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="vs">line 9</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="vs">line 10</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="vs">line 11</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="vs">line 12</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="vs">line 13</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="vs">line 14</span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="vs">line 15</span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="vs">line 16</span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="vs">line 17</span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="vs">line 18</span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="vs">line 19</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="vs">line 20</span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="vs">line 21</span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="vs">line 22</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="vs">line 23</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="vs">line 24</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="vs">line 25</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="vs">line 26</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="vs">line 27</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="vs">line 28</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="vs">line 29</span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="vs">line 30</span></a>
<a class="sourceLine" id="cb2-32" title="32"><span class="vs">line 31</span></a>
<a class="sourceLine" id="cb2-33" title="33"><span class="vs">line 32</span></a>
<a class="sourceLine" id="cb2-34" title="34"><span class="vs">line 33</span></a>
<a class="sourceLine" id="cb2-35" title="35"><span class="vs">line 34</span></a>
<a class="sourceLine" id="cb2-36" title="36"><span class="vs">line 35</span></a>
<a class="sourceLine" id="cb2-37" title="37"><span class="vs">line 36</span></a>
<a class="sourceLine" id="cb2-38" title="38"><span class="vs">line 37</span></a>
<a class="sourceLine" id="cb2-39" title="39"><span class="vs">line 38</span></a>
<a class="sourceLine" id="cb2-40" title="40"><span class="vs">line 39</span></a>
<a class="sourceLine" id="cb2-41" title="41"><span class="vs">line 40</span></a>
<a class="sourceLine" id="cb2-42" title="42"><span class="vs">line 41</span></a>
<a class="sourceLine" id="cb2-43" title="43"><span class="vs">line 42</span></a>
<a class="sourceLine" id="cb2-44" title="44"><span class="vs">line 43</span></a>
<a class="sourceLine" id="cb2-45" title="45"><span class="vs">line 44</span></a>
<a class="sourceLine" id="cb2-46" title="46"><span class="vs">line 45</span></a>
<a class="sourceLine" id="cb2-47" title="47"><span class="vs">line 46</span></a>
<a class="sourceLine" id="cb2-48" title="48"><span class="vs">line 47</span></a>
<a class="sourceLine" id="cb2-49" title="49"><span class="vs">line 48</span></a>
<a class="sourceLine" id="cb2-50" title="50"><span class="vs">line 49</span></a>
<a class="sourceLine" id="cb2-51" title="51"><span class="vs">line 50</span></a>
<a class="sourceLine" id="cb2-52" title="52"><span class="vs">line 51</span></a>
<a class="sourceLine" id="cb2-53" title="53"><span class="vs">`</span><span class="op">;</span></a></code></pre></div>
<p>Example of <strong>correct</strong> code for this rule:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1">exports[<span class="vs">`a more manageable and readable snapshot 1`</span>] <span class="op">=</span> <span class="vs">`</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="vs">line 1</span></a>
<a class="sourceLine" id="cb3-3" title="3"><span class="vs">line 2</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="vs">line 3</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="vs">line 4</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="vs">`</span><span class="op">;</span></a></code></pre></div>
<h2 id="options">Options</h2>
<p>This rule has an option for modifying the max number of lines allowed for a snapshot:</p>
<p>In an <code>eslintrc</code> file:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode json"><code class="sourceCode json"><a class="sourceLine" id="cb4-1" title="1"><span class="er">...</span></a>
<a class="sourceLine" id="cb4-2" title="2">  <span class="er">&quot;rules&quot;:</span> <span class="fu">{</span></a>
<a class="sourceLine" id="cb4-3" title="3">    <span class="dt">&quot;jest/no-large-snapshots&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;warn&quot;</span><span class="ot">,</span> <span class="fu">{</span> <span class="dt">&quot;maxSize&quot;</span><span class="fu">:</span> <span class="dv">12</span> <span class="fu">}</span><span class="ot">]</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="fu">}</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="er">...</span></a></code></pre></div>
<p>In addition there is an option for whitelisting large snapshot files. Since <code>//eslint</code> comments will be removed when a <code>.snap</code> file is updated, this option provides a way of whitelisting large snapshots. The list of whitelistedSnapshots is keyed first on the absolute filepath of the snapshot file. You can then provide an array of strings to match the snapshot names against. If you’re using a <code>.eslintrc.js</code> file, you can use regular expressions AND strings.</p>
<p>In an <code>.eslintrc.js</code> file:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1">...</a>
<a class="sourceLine" id="cb5-2" title="2"></a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="st">&quot;rules&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="st">&quot;jest/no-large-snapshots&quot;</span><span class="op">:</span> [<span class="st">&quot;error&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb5-5" title="5">      <span class="op">{</span></a>
<a class="sourceLine" id="cb5-6" title="6">        <span class="st">&quot;whitelistedSnapshots&quot;</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb5-7" title="7">          <span class="st">&quot;/path/to/file.js.snap&quot;</span><span class="op">:</span> [<span class="st">&quot;snapshot name 1&quot;</span><span class="op">,</span> <span class="ss">/a big snapshot </span><span class="sc">\d+</span><span class="ss">/</span>]</a>
<a class="sourceLine" id="cb5-8" title="8">        <span class="op">}</span></a>
<a class="sourceLine" id="cb5-9" title="9">      <span class="op">}</span>]</a>
<a class="sourceLine" id="cb5-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb5-11" title="11"></a>
<a class="sourceLine" id="cb5-12" title="12">...</a></code></pre></div>
<p>Note: If you store your paths as relative paths, you can use <code>path.resolve</code> so that it can be shared between computers. For example, suppose you have your whitelisted snapshots in a file called <code>allowed-snaps.js</code> which stores them as relative paths. To convert them to absolute paths you can do something like the following:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode javascript"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> path <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;path&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">const</span> <span class="op">{</span>mapKeys<span class="op">}</span> <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;lodash&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="kw">const</span> allowedSnapshots <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;./allowed-snaps.js&#39;</span>)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="kw">const</span> whitelistedSnapshots <span class="op">=</span> <span class="at">mapKeys</span>(allowedSnapshots<span class="op">,</span> (val<span class="op">,</span> file) <span class="kw">=&gt;</span> <span class="va">path</span>.<span class="at">resolve</span>(__dirname<span class="op">,</span> file))<span class="op">;</span></a>
<a class="sourceLine" id="cb6-7" title="7"></a>
<a class="sourceLine" id="cb6-8" title="8">...</a>
<a class="sourceLine" id="cb6-9" title="9">  rules<span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="st">&quot;jest/no-large-snapshots&quot;</span><span class="op">:</span> [<span class="st">&quot;error&quot;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb6-11" title="11">      <span class="op">{</span> whitelistedSnapshots <span class="op">}</span></a>
<a class="sourceLine" id="cb6-12" title="12">    ]</a>
<a class="sourceLine" id="cb6-13" title="13">  <span class="op">}</span></a></code></pre></div>
</body>
</html>
