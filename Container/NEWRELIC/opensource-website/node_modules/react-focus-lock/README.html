<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<div align="left">
<h1 align="center">
REACT FOCUS LOCK
</h1>
<p><img src="./assets/ackbar.png" alt="it-is-a-trap" width="200" height="200" align="right"></p>
<ul>
<li>browser friendly focus lock<br/></li>
<li>matching all your use cases<br/></li>
<li>trusted by best UI frameworks<br/></li>
<li>the thing Admiral Ackbar was talking about<br/> <br/></li>
</ul>
<a href="https://circleci.com/gh/theKashey/react-focus-lock/tree/master"><img src="https://img.shields.io/circleci/project/github/theKashey/react-focus-lock/master.svg?style=flat-square" alt="CircleCI status" /></a> <a href="https://www.npmjs.com/package/react-focus-lock"><img src="https://img.shields.io/npm/v/react-focus-lock.svg" alt="npm" /></a> <a href="https://bundlephobia.com/result?p=react-focus-lock"><img src="https://badgen.net/bundlephobia/minzip/react-focus-lock" alt="bundle size" /></a> <a href="https://www.npmtrends.com/react-focus-lock"><img src="https://badgen.net/npm/dm/react-focus-lock" alt="downloads" /></a>
<hr/>
</div>
<p>It is a trap! We got your focus and will not let him out!</p>
<ul>
<li>Modal dialogs. You can not leave it with ‚ÄúTab‚Äù, ie do a ‚Äútab-out‚Äù.</li>
<li>Focused tasks. It will aways brings you back, as you can ‚Äúlock‚Äù user inside a component.</li>
<li>Any any other case, when you have to lock user <em>intention</em> and <em>focus</em>, if that‚Äôs what <code>a11y</code> is asking for.</li>
</ul>
<h3 id="trusted">Trusted</h3>
<p>Trusted by <a href="https://atlaskit.atlassian.com">Atlassian AtlasKit</a>, <a href="https://ui.reach.tech/">ReachUI</a>, <a href="https://smooth-ui.smooth-code.com/">SmoothUI</a>, <a href="https://storybook.js.org/">Storybook</a> and we will do our best to earn your trust too!</p>
<h1 id="features">Features</h1>
<ul>
<li>no keyboard control, everything is done watching a <strong>focus behavior</strong>, not emulating it. Thus works always and everywhere.</li>
<li>React <strong>Portals</strong> support. Even if some data is in outer space - it is <a href="https://github.com/theKashey/react-focus-lock/issues/19">still in lock</a>.</li>
<li><em>Scattered</em> locks, or focus lock groups - you can setup different isolated locks, and <em>tab</em> from one to another.</li>
<li>Controllable isolation level.</li>
<li>variable size bundle. Uses sidecar to trim UI part to 1.5kb.</li>
</ul>
<blockquote>
<p>üí° <strong>focus</strong> locks is only the first part, there are also <strong>scroll lock</strong> and <strong>text-to-speech</strong> lock you have to use to really ‚Äúlock‚Äù the user. Try <a href="https://github.com/theKashey/react-focus-on">react-focus-on</a> to archive everything above, assembled in the right order.</p>
</blockquote>
<h1 id="how-to-use">How to use</h1>
<p>Just wrap something with focus lock, and focus will be <code>moved inside</code> on mount.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb1-1" title="1"> <span class="im">import</span> FocusLock <span class="im">from</span> <span class="st">&#39;react-focus-lock&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"> <span class="kw">const</span> JailForAFocus <span class="op">=</span> (<span class="op">{</span>onClose<span class="op">}</span>) <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb1-4" title="4">    <span class="op">&lt;</span>FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1-5" title="5">      You can not leave <span class="kw">this</span> form</a>
<a class="sourceLine" id="cb1-6" title="6">      <span class="op">&lt;</span>button onClick<span class="op">={</span>onClose<span class="op">}</span> /&gt;</a>
<a class="sourceLine" id="cb1-7" title="7">    &lt;/FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb1-8" title="8"> )<span class="op">;</span></a></code></pre></div>
<p>Demo - https://codesandbox.io/s/5wmrwlvxv4.</p>
<h1 id="why">WHY?</h1>
<p>From <a href="https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/ARIA_Techniques/Using_the_dialog_role">MDN Article about accessible dialogs</a>: - The dialog must be properly labeled - Keyboard <strong>focus must be managed</strong> correctly</p>
<p>This one is about managing the focus.</p>
<p>I‚Äôve got a good <a href="https://medium.com/@antonkorzunov/its-a-focus-trap-699a04d66fb5">article about focus management, dialogs and WAI-ARIA</a>.</p>
<h1 id="api">API</h1>
<blockquote>
<p>FocusLock would work perfectly even with no props set.</p>
</blockquote>
<p>FocusLock has few props to tune behavior, all props are optional: - <code>disabled</code>, to disable(enable) behavior without altering the tree. - <code>returnFocus</code>, to return focus into initial position on unmount(not disable). &gt; By default <code>returnFocus</code> is disabled, so FocusLock will <strong>not</strong> restore original focus on deactivation.</p>
<p>This is expected behavior for Modals, but it is better to implement it by your self. See <a href="https://github.com/theKashey/react-focus-lock#unmounting-and-focus-management">unmounting and focus management</a> for details - <code>persistentFocus=false</code>, requires any element to be focused. This also disables text selections inside, and <strong>outside</strong> focus lock. - <code>autoFocus=true</code>, enables or disables focusing into on Lock activation. If disabled Lock will blur an active focus. - <code>noFocusGuards=false</code> disabled <em>focus guards</em> - virtual inputs which secure tab index. - <code>group='''</code> named focus group for focus scattering aka <a href="https://github.com/theKashey/vue-focus-lock/issues/2">combined lock targets</a> - <code>shards=[]</code> an array of <code>ref</code> pointing to the nodes, which focus lock should consider and a part of it. This is another way focus scattering.<br />
- <code>whiteList=fn</code> you could <em>whitelist</em> locations FocusLock should carry about. Everything outside it will ignore. For example - any modals. - <code>as='div'</code> if you need to change internal <code>div</code> element, to any other. Use ref forwarding to give FocusLock the node to work with. - <code>lockProps={}</code> to pass any extra props (except className) to the internal wrapper.</p>
<h3 id="focusing-in-osx-safarifirefox-is-strange">Focusing in OSX (Safari/Firefox) is strange!</h3>
<p>By default <code>tabbing</code> in OSX <code>sees</code> only controls, but not links or anything else <code>tabbable</code>. This is system settings, and Safari/Firefox obey. Press Option+Tab in Safari to loop across all tabbables, or change the Safari settings. There is no way to <em>fix</em> Firefox, unless change system settings (Control+F7). See <a href="https://github.com/theKashey/react-focus-lock/issues/24">this issue</a> for more information.</p>
<h2 id="set-up">Set up</h2>
<h3 id="requirements">Requirements</h3>
<ul>
<li>version 1x is React 15/16 compatible</li>
<li>version 2+ requires React 16.8+ (hooks) ### Import <code>react-focus-lock</code> exposed <strong>3 entry points</strong>: for the classical usage, and a <em>sidecar</em> one. #### Default usage</li>
<li>4kb, <code>import FocusLock from 'react-focus-lock</code> would give you component you are looking for.</li>
</ul>
<h4 id="separated-usage">Separated usage</h4>
<p>Meanwhile - you dont need any focus related logic until it‚Äôs needed. Thus - you may defer that logic till Lock activation and move all related code to a <em>sidecar</em>.</p>
<ul>
<li>UI, <strong>1.5kb</strong>, <code>import FocusLockUI from 'react-focus-lock/UI</code> - a DOM part of a lock.</li>
<li>Sidecar, 3.5kb, <code>import Sidecar from 'react-focus-lock/sidecar</code> - which is the real focus lock.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="im">import</span> FocusLockUI <span class="im">from</span> <span class="st">&quot;react-focus-lock/UI&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="im">import</span> <span class="op">{</span>sidecar<span class="op">}</span> <span class="im">from</span> <span class="st">&quot;use-sidecar&quot;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">// prefetch sidecar. data would be loaded, but js would not be executed</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">const</span> FocusLockSidecar <span class="op">=</span> <span class="at">sidecar</span>(  </a>
<a class="sourceLine" id="cb2-6" title="6">  () <span class="kw">=&gt;</span> <span class="im">import</span>(<span class="co">/* webpackPrefetch: true */</span> <span class="st">&quot;react-focus-lock/sidecar&quot;</span>)</a>
<a class="sourceLine" id="cb2-7" title="7">)<span class="op">;</span></a>
<a class="sourceLine" id="cb2-8" title="8"></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="op">&lt;</span>FocusLockUI</a>
<a class="sourceLine" id="cb2-10" title="10">    disabled<span class="op">={</span><span class="kw">this</span>.<span class="va">state</span>.<span class="at">disabled</span><span class="op">}</span></a>
<a class="sourceLine" id="cb2-11" title="11">    sideCar<span class="op">={</span>FocusLockSidecar<span class="op">}</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb2-13" title="13"> <span class="op">{</span>content<span class="op">}</span></a>
<a class="sourceLine" id="cb2-14" title="14">&lt;/FocusLockUI<span class="op">&gt;</span> </a></code></pre></div>
<p>That would split FocusLock into two pieces, reducing app size and improving the first load. The cost of focus-lock is just 1.5kb!</p>
<blockquote>
<p>Saved 3.5kb?! ü§∑‚Äç‚ôÇÔ∏è 3.5kb here and 3.5kb here, and your 20mb bundle is ready.</p>
</blockquote>
<h1 id="autofocus">Autofocus</h1>
<p>Use when you cannot use the native <code>autoFocus</code> prop - because you only want to autofocus once the Trap has been activated</p>
<ul>
<li>prop <code>data-autofocus</code> on the element.</li>
<li>prop <code>data-autofocus-inside</code> on the element to focus on something inside.</li>
<li><code>AutoFocusInside</code> component, as named export of this library.</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb3-1" title="1"> <span class="im">import</span> FocusLock<span class="op">,</span> <span class="op">{</span> AutoFocusInside <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-focus-lock&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb3-2" title="2"> </a>
<a class="sourceLine" id="cb3-3" title="3"> <span class="op">&lt;</span>FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-4" title="4">   <span class="op">&lt;</span>button<span class="op">&gt;</span>Click&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-5" title="5">   <span class="op">&lt;</span>AutoFocusInside<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="op">&lt;</span>button<span class="op">&gt;</span>will be focused&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-7" title="7">   &lt;/AutoFocusInside<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-8" title="8"> &lt;/FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-9" title="9"> <span class="co">// is the same as</span></a>
<a class="sourceLine" id="cb3-10" title="10"> </a>
<a class="sourceLine" id="cb3-11" title="11"> <span class="op">&lt;</span>FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-12" title="12">   <span class="op">&lt;</span>button<span class="op">&gt;</span>Click&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-13" title="13">    <span class="op">&lt;</span>button data<span class="op">-</span>autofocus<span class="op">&gt;</span>will be focused&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb3-14" title="14"> &lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<p>If there is more than one auto-focusable target - the first will be selected. If it is a part of radio group, and <strong>rest of radio group element are also autofocusable</strong>(just put them into AutoFocusInside) - checked one fill be selected.</p>
<p><code>AutoFocusInside</code> will work only on Lock activation, and does nothing, then used outside of the lock. You can use <code>MoveFocusInside</code> to move focus inside with or without lock.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"> <span class="im">import</span> <span class="op">{</span> MoveFocusInside <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-focus-lock&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb4-2" title="2">    </a>
<a class="sourceLine" id="cb4-3" title="3"> <span class="op">&lt;</span>MoveFocusInside<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-4" title="4">  <span class="op">&lt;</span>button<span class="op">&gt;</span>will be focused&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb4-5" title="5"> &lt;/MoveFocusInside<span class="op">&gt;</span></a></code></pre></div>
<h1 id="portals">Portals</h1>
<p>Use focus scattering to handle portals</p>
<ul>
<li>using <code>groups</code>. Just create a few locks (only one could be active) with a same group name</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">const</span> PortaledElement <span class="op">=</span> () <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb5-2" title="2">   <span class="op">&lt;</span>FocusLock group<span class="op">=</span><span class="st">&quot;group42&quot;</span> disabled<span class="op">={</span><span class="kw">true</span><span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb5-3" title="3">     <span class="co">// &quot;discoverable&quot; portaled content</span></a>
<a class="sourceLine" id="cb5-4" title="4">   &lt;/FocusLock<span class="op">&gt;</span>  </a>
<a class="sourceLine" id="cb5-5" title="5">)<span class="op">;</span></a>
<a class="sourceLine" id="cb5-6" title="6"></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="op">&lt;</span>FocusLock group<span class="op">=</span><span class="st">&quot;group42&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb5-8" title="8">  <span class="co">// main content</span></a>
<a class="sourceLine" id="cb5-9" title="9">&lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<ul>
<li>using <code>shards</code>. Just pass all the pieces to the ‚Äúshards‚Äù prop.</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">const</span> PortaledElement <span class="op">=</span> () <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb6-2" title="2">   <span class="op">&lt;</span>div ref<span class="op">={</span>ref<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb6-3" title="3">     <span class="co">// &quot;discoverable&quot; portaled content</span></a>
<a class="sourceLine" id="cb6-4" title="4">   &lt;/div<span class="op">&gt;</span>  </a>
<a class="sourceLine" id="cb6-5" title="5">)<span class="op">;</span></a>
<a class="sourceLine" id="cb6-6" title="6"></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="op">&lt;</span>FocusLock shards<span class="op">={</span>[ref]<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb6-8" title="8">  <span class="co">// main content</span></a>
<a class="sourceLine" id="cb6-9" title="9">&lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<ul>
<li>without anything. FocusLock will not prevent focusing portaled element, but will not include them in to tab order</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">const</span> PortaledElement <span class="op">=</span> () <span class="kw">=&gt;</span> (</a>
<a class="sourceLine" id="cb7-2" title="2">   <span class="op">&lt;</span>div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-3" title="3">     <span class="co">// NON-&quot;discoverable&quot; portaled content</span></a>
<a class="sourceLine" id="cb7-4" title="4">   &lt;/div<span class="op">&gt;</span>  </a>
<a class="sourceLine" id="cb7-5" title="5">)<span class="op">;</span></a>
<a class="sourceLine" id="cb7-6" title="6"></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="op">&lt;</span>FocusLock shards<span class="op">={</span>[ref]<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb7-8" title="8">  <span class="co">// main content</span></a>
<a class="sourceLine" id="cb7-9" title="9">  <span class="op">&lt;</span>PortaledElement /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb7-10" title="10">&lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<h3 id="using-your-own-components">Using your own <code>Components</code></h3>
<p>You may use <code>as</code> prop to change <em>what</em> Focus-Lock will render around <code>children</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="op">&lt;</span>FocusLock <span class="im">as</span><span class="op">=</span><span class="st">&quot;section&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-2" title="2">    <span class="op">&lt;</span>button<span class="op">&gt;</span>Click&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-3" title="3">    <span class="op">&lt;</span>button data<span class="op">-</span>autofocus<span class="op">&gt;</span>will be focused&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-4" title="4"> &lt;/FocusLock<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-5" title="5"> </a>
<a class="sourceLine" id="cb8-6" title="6"> <span class="op">&lt;</span>FocusLock <span class="im">as</span><span class="op">={</span>AnotherComponent<span class="op">}</span> lockProps<span class="op">={{</span><span class="dt">anyAnotherComponentProp</span><span class="op">:</span> <span class="dv">4</span><span class="op">}}&gt;</span></a>
<a class="sourceLine" id="cb8-7" title="7">    <span class="op">&lt;</span>button<span class="op">&gt;</span>Click&lt;/button<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="op">&lt;</span>span<span class="op">&gt;</span>Hello there<span class="op">!</span>&lt;/span<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb8-9" title="9"> &lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<h3 id="guarding">Guarding</h3>
<p>As you may know - FocusLock is adding <code>Focus Guards</code> before and after lock to remove some side effects, like page scrolling. But <code>shards</code> will not have such guards, and it might be not so cool to use them - for example if no <code>tabbable</code> would be defined after shard - you will tab to the browser chrome.</p>
<p>You may wrap shard with <code>InFocusGuard</code> or just drop <code>InFocusGuard</code> here and there - that would solve the problem.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb9-1" title="1"><span class="im">import</span> <span class="op">{</span>InFocusGuard<span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-focus-lock&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3"><span class="co">// wrap with</span></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="op">&lt;</span>InFocusGuard<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-5" title="5">  <span class="op">&lt;</span>button /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-6" title="6">&lt;/InFocusGuard<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-7" title="7"></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co">// place before and after</span></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="op">&lt;</span>InFocusGuard /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="op">&lt;</span>button /<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="op">&lt;</span>InFocusGuard /<span class="op">&gt;</span></a></code></pre></div>
<p>InFocusGuards would be active(tabbable) only when tabble, it protecting, is focused.</p>
<h4 id="removing-tailing-guard">Removing Tailing Guard</h4>
<p>If only your modal is the last tabble element on the body - you might remove the Tailing Guard, to allow user <em>tab</em> into address bar.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="op">&lt;</span>InFocusGuard/<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="op">&lt;</span>button /<span class="op">&gt;</span>  </a>
<a class="sourceLine" id="cb10-3" title="3"><span class="co">// there is no &quot;tailing&quot; guard :)</span></a></code></pre></div>
<h1 id="unmounting-and-focus-management">Unmounting and focus management</h1>
<ul>
<li>In case FocusLock has <code>returnFocus</code> enabled, and it‚Äôs going to be unmounted - focus will be returned after zero-timeout.</li>
<li>In case <code>returnFocus</code> is set to <code>false</code>, and you are going to control focus change on your own - keep in mind &gt;&gt; React will first call Parent.componentWillUnmount, and next Child.componentWillUnmount</li>
</ul>
<p>This means - Trap will be still active by the time you <em>may</em> want move(return) focus on componentWillUnmount. Please deffer this action with a zero-timeout.</p>
<p>Similarly, if you are using the <code>disabled</code> prop to control FocusLock, you will need a zero-timeout to correctly restore focus.</p>
<pre><code>&lt;FocusLock
  disabled={isFocusLockDisabled}
  onDeactivation={() =&gt; {
    // Without the zero-timeout, focus will likely remain on the button/control
    // you used to set isFocusLockDisabled = true
    window.setTimeout(() =&gt; myRef.current.focus(), 0);
  }
&gt;</code></pre>
<h2 id="return-focus-with-no-scroll">Return focus with no scroll</h2>
<blockquote>
<p>read more at the <a href="https://github.com/theKashey/react-focus-lock/issues/83">issue #83</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/focus">mdn article</a>.</p>
</blockquote>
<p>To return focus, but without <em>jumpy</em> page scroll returning a focus you might specify a focus option</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="op">&lt;</span>FocusLock</a>
<a class="sourceLine" id="cb12-2" title="2">  returnFocus<span class="op">={{</span> <span class="dt">preventScroll</span><span class="op">:</span> <span class="kw">false</span> <span class="op">}}</span> <span class="co">// working not in all browsers</span></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="op">&gt;</span>   </a></code></pre></div>
<p>Not supported by Edge and Safari.</p>
<h1 id="not-only-for-react">Not only for React</h1>
<p>Uses <a href="https://github.com/theKashey/focus-lock/">focus-lock</a> under the hood. It does also provide support for Vue.js and Vanilla DOM solutions</p>
<h1 id="warning">Warning!</h1>
<p>Two different <em>focus-lock-managers</em> or even different version of a single one, active simultaneously will FIGHT!</p>
<p><strong>Focus-lock will surrender</strong>, as long any other focus management library will not.</p>
<h2 id="focus-fighting">Focus fighting</h2>
<p>You may wrap some render branch with <code>FreeFocusInside</code>, and react-focus-lock <strong>will ignore</strong> any focus inside marked node, thus landing a peace.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb13-1" title="1"><span class="im">import</span> <span class="op">{</span> FreeFocusInside <span class="op">}</span> <span class="im">from</span> <span class="st">&#39;react-focus-lock&#39;</span><span class="op">;</span></a>
<a class="sourceLine" id="cb13-2" title="2"></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="op">&lt;</span>FreeFocusInside<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb13-4" title="4"> <span class="op">&lt;</span>div id<span class="op">=</span><span class="st">&quot;portal-for-modals&quot;</span><span class="op">&gt;</span></a>
<a class="sourceLine" id="cb13-5" title="5">   <span class="kw">in</span> <span class="kw">this</span> div i am going to portal my modals<span class="op">,</span> dont fight <span class="cf">with</span> them please</a>
<a class="sourceLine" id="cb13-6" title="6"> &lt;/div<span class="op">&gt;</span></a>
<a class="sourceLine" id="cb13-7" title="7">&lt;/FreeFocusInside<span class="op">&gt;</span></a></code></pre></div>
<p>Even the better is to <code>whiteList</code> FocusLock areas - for example ‚Äúyou should handle only React Stuff in React Root‚Äù</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="op">&lt;</span>FocusLock whiteList<span class="op">={</span>node <span class="kw">=&gt;</span> <span class="va">document</span>.<span class="at">getElementById</span>(<span class="st">&#39;root&#39;</span>).<span class="at">contains</span>(node)<span class="op">}&gt;</span></a>
<a class="sourceLine" id="cb14-2" title="2"> ...</a>
<a class="sourceLine" id="cb14-3" title="3">&lt;/FocusLock<span class="op">&gt;</span></a></code></pre></div>
<p>PS: <strong>please use webpack or yarn resolution for force one version of react-focus-lock used</strong></p>
<blockquote>
<p>webpack.conf</p>
</blockquote>
<div class="sourceCode" id="cb15"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb15-1" title="1"> resolve<span class="op">:</span> <span class="op">{</span>    </a>
<a class="sourceLine" id="cb15-2" title="2">    <span class="dt">alias</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb15-3" title="3">      <span class="st">&#39;react-focus-lock&#39;</span><span class="op">:</span> <span class="va">path</span>.<span class="at">resolve</span>(<span class="va">path</span>.<span class="at">join</span>(__dirname<span class="op">,</span> <span class="st">&#39;./node_modules/react-focus-lock&#39;</span>))</a>
<a class="sourceLine" id="cb15-4" title="4"> ...</a></code></pre></div>
<h1 id="more">More</h1>
<p>To create a ‚Äúright‚Äù modal dialog you have to: - manage a focus. Use this library - block document scroll. Use <a href="https://github.com/theKashey/react-scroll-locky">react-scroll-locky</a>. - hide everything else from screen readers. Use <a href="https://github.com/theKashey/aria-hidden">aria-hidden</a></p>
<p>You may use <a href="https://github.com/theKashey/react-focus-on">react-focus-on</a> to archive everything above, assembled in the right order.</p>
<h1 id="licence">Licence</h1>
<p>MIT</p>
</body>
</html>
