<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>api-importer</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<p>By using custom importers, Sass stylesheets can be implemented in any possible way, such as by being loaded via a remote server. Please note: this feature is experimental and is implemented differently than importers in Ruby Sass. Imports must be relative to the parent import context and therefore we need to pass this information to the importer callback. This is currently done by passing the complete import string/path of the previous import context.</p>
<h2 id="return-imports">Return Imports</h2>
<p>You actually have to return a list of imports, since some importers may want to import multiple files from one import statement (ie. a glob/star importer). The memory you pass with source and srcmap is taken over by LibSass and freed automatically when the import is done. You are also allowed to return <code>0</code> instead of a list, which will tell LibSass to handle the import by itself (as if no custom importer was in use).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb1-1" title="1">Sass_Import_Entry* rv = sass_make_import_list(<span class="dv">1</span>);</a>
<a class="sourceLine" id="cb1-2" title="2">rv[<span class="dv">0</span>] = sass_make_import(rel, abs, source, srcmap);</a></code></pre></div>
<p>Every import will then be included in LibSass. You are allowed to only return a file path without any loaded source. This way you can ie. implement rewrite rules for import paths and leave the loading part for LibSass.</p>
<p>Please note that LibSass doesnâ€™t use the srcmap parameter yet. It has been added to not deprecate the C-API once support has been implemented. It will be used to re-map the actual sourcemap with the provided ones.</p>
<h3 id="basic-usage">Basic Usage</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb2-1" title="1"><span class="pp">#include </span><span class="im">&quot;sass/functions.h&quot;</span></a></code></pre></div>
<h2 id="sass-importer-api">Sass Importer API</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><a class="sourceLine" id="cb3-1" title="1"><span class="co">// Forward declaration</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">struct</span> Sass_Import;</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">// Forward declaration</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="kw">struct</span> Sass_C_Import_Descriptor;</a>
<a class="sourceLine" id="cb3-6" title="6"></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">// Typedef defining the custom importer callback</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="kw">typedef</span> <span class="kw">struct</span> Sass_C_Import_Descriptor (*Sass_C_Import_Callback);</a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">// Typedef defining the importer c function prototype</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">typedef</span> Sass_Import_Entry* (*Sass_C_Import_Fn) (<span class="dt">const</span> <span class="dt">char</span>* url, <span class="dt">const</span> <span class="dt">char</span>* prev, <span class="dt">void</span>* cookie);</a>
<a class="sourceLine" id="cb3-11" title="11"></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">// Creators for custom importer callback (with some additional pointer)</span></a>
<a class="sourceLine" id="cb3-13" title="13"><span class="co">// The pointer is mostly used to store the callback into the actual function</span></a>
<a class="sourceLine" id="cb3-14" title="14">Sass_C_Import_Callback sass_make_importer (Sass_C_Import_Fn, <span class="dt">void</span>* cookie);</a>
<a class="sourceLine" id="cb3-15" title="15"></a>
<a class="sourceLine" id="cb3-16" title="16"><span class="co">// Getters for import function descriptors</span></a>
<a class="sourceLine" id="cb3-17" title="17">Sass_C_Import_Fn sass_import_get_function (Sass_C_Import_Callback fn);</a>
<a class="sourceLine" id="cb3-18" title="18"><span class="dt">void</span>* sass_import_get_cookie (Sass_C_Import_Callback fn);</a>
<a class="sourceLine" id="cb3-19" title="19"></a>
<a class="sourceLine" id="cb3-20" title="20"><span class="co">// Deallocator for associated memory</span></a>
<a class="sourceLine" id="cb3-21" title="21"><span class="dt">void</span> sass_delete_importer (Sass_C_Import_Callback fn);</a>
<a class="sourceLine" id="cb3-22" title="22"></a>
<a class="sourceLine" id="cb3-23" title="23"><span class="co">// Creator for sass custom importer return argument list</span></a>
<a class="sourceLine" id="cb3-24" title="24">Sass_Import_Entry* sass_make_import_list (<span class="dt">size_t</span> length);</a>
<a class="sourceLine" id="cb3-25" title="25"><span class="co">// Creator for a single import entry returned by the custom importer inside the list</span></a>
<a class="sourceLine" id="cb3-26" title="26">Sass_Import_Entry sass_make_import_entry (<span class="dt">const</span> <span class="dt">char</span>* path, <span class="dt">char</span>* source, <span class="dt">char</span>* srcmap);</a>
<a class="sourceLine" id="cb3-27" title="27">Sass_Import_Entry sass_make_import (<span class="dt">const</span> <span class="dt">char</span>* rel, <span class="dt">const</span> <span class="dt">char</span>* abs, <span class="dt">char</span>* source, <span class="dt">char</span>* srcmap);</a>
<a class="sourceLine" id="cb3-28" title="28"></a>
<a class="sourceLine" id="cb3-29" title="29"><span class="co">// set error message to abort import and to print out a message (path from existing object is used in output)</span></a>
<a class="sourceLine" id="cb3-30" title="30">Sass_Import_Entry sass_import_set_error(Sass_Import_Entry import, <span class="dt">const</span> <span class="dt">char</span>* message, <span class="dt">size_t</span> line, <span class="dt">size_t</span> col);</a>
<a class="sourceLine" id="cb3-31" title="31"></a>
<a class="sourceLine" id="cb3-32" title="32"><span class="co">// Setters to insert an entry into the import list (you may also use [] access directly)</span></a>
<a class="sourceLine" id="cb3-33" title="33"><span class="co">// Since we are dealing with pointers they should have a guaranteed and fixed size</span></a>
<a class="sourceLine" id="cb3-34" title="34"><span class="dt">void</span> sass_import_set_list_entry (Sass_Import_Entry* list, <span class="dt">size_t</span> idx, Sass_Import_Entry entry);</a>
<a class="sourceLine" id="cb3-35" title="35">Sass_Import_Entry sass_import_get_list_entry (Sass_Import_Entry* list, <span class="dt">size_t</span> idx);</a>
<a class="sourceLine" id="cb3-36" title="36"></a>
<a class="sourceLine" id="cb3-37" title="37"><span class="co">// Getters for import entry</span></a>
<a class="sourceLine" id="cb3-38" title="38"><span class="dt">const</span> <span class="dt">char</span>* sass_import_get_imp_path (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-39" title="39"><span class="dt">const</span> <span class="dt">char</span>* sass_import_get_abs_path (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-40" title="40"><span class="dt">const</span> <span class="dt">char</span>* sass_import_get_source (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-41" title="41"><span class="dt">const</span> <span class="dt">char</span>* sass_import_get_srcmap (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-42" title="42"><span class="co">// Explicit functions to take ownership of these items</span></a>
<a class="sourceLine" id="cb3-43" title="43"><span class="co">// The property on our struct will be reset to NULL</span></a>
<a class="sourceLine" id="cb3-44" title="44"><span class="dt">char</span>* sass_import_take_source (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-45" title="45"><span class="dt">char</span>* sass_import_take_srcmap (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-46" title="46"></a>
<a class="sourceLine" id="cb3-47" title="47"><span class="co">// Getters for import error entries</span></a>
<a class="sourceLine" id="cb3-48" title="48"><span class="dt">size_t</span> sass_import_get_error_line (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-49" title="49"><span class="dt">size_t</span> sass_import_get_error_column (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-50" title="50"><span class="dt">const</span> <span class="dt">char</span>* sass_import_get_error_message (Sass_Import_Entry);</a>
<a class="sourceLine" id="cb3-51" title="51"></a>
<a class="sourceLine" id="cb3-52" title="52"><span class="co">// Deallocator for associated memory (incl. entries)</span></a>
<a class="sourceLine" id="cb3-53" title="53"><span class="dt">void</span> sass_delete_import_list (Sass_Import_Entry*);</a>
<a class="sourceLine" id="cb3-54" title="54"><span class="co">// Just in case we have some stray import structs</span></a>
<a class="sourceLine" id="cb3-55" title="55"><span class="dt">void</span> sass_delete_import (Sass_Import_Entry);</a></code></pre></div>
<h3 id="more-links">More links</h3>
<ul>
<li><a href="api-importer-example.md">Sass Importer Example</a></li>
<li><a href="api-importer-internal.md">Sass Importer Internal</a></li>
</ul>
</body>
</html>
