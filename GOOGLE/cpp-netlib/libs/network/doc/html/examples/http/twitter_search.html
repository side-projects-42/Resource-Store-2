<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>twitter_search</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h3 id="navigation">Navigation</h3>
<ul>
<li><a href="../../reference.html" title="Reference Manual">next</a></li>
<li><a href="atom_reader.html" title="Atom feed reader">previous</a> |</li>
<li><a href="../../contents.html">cpp-netlib v0.11.2</a> »</li>
<li><a href="../../examples.html">Examples</a> »</li>
</ul>
<p><span id="id1"></span></p>
<h1 id="twitter-search">Twitter search<a href="#twitter-search" class="headerlink" title="Permalink to this headline">¶</a></h1>
<p>This example uses <a href="https://dev.twitter.com/docs/using-search" class="reference external">Twitter’s search API</a> to list recent tweets given a user query. New features introduced here include the URI builder and <code>uri::encoded</code> function.</p>
<h2 id="the-code">The code<a href="#the-code" class="headerlink" title="Permalink to this headline">¶</a></h2>
<pre><code>#include &lt;boost/network/protocol/http/client.hpp&gt;
#include &quot;rapidjson/rapidjson.h&quot;
#include &quot;rapidjson/document.h&quot;
#include &lt;iostream&gt;

int main(int argc, char *argv[]) {
    using namespace boost::network;
    using namespace rapidjson;

    if (argc != 2) {
        std::cout &lt;&lt; &quot;Usage: &quot; &lt;&lt; argv[0] &lt;&lt; &quot; &lt;query&gt;&quot; &lt;&lt; std::endl;
        return 1;
    }

    try {
        http::client client;

        uri::uri base_uri(&quot;http://search.twitter.com/search.json&quot;);

        std::cout &lt;&lt; &quot;Searching Twitter for query: &quot; &lt;&lt; argv[1] &lt;&lt; std::endl;
        uri::uri search;
        search &lt;&lt; base_uri &lt;&lt; uri::query(&quot;q&quot;, uri::encoded(argv[1]));
        http::client::request request(search);
        http::client::response response = client.get(request);

        Document d;
        if (!d.Parse&lt;0&gt;(response.body().c_str()).HasParseError()) {
            const Value &amp;results = d[&quot;results&quot;];
            for (SizeType i = 0; i &lt; results.Size(); ++i)
            {
                const Value &amp;user = results[i][&quot;from_user_name&quot;];
                const Value &amp;text = results[i][&quot;text&quot;];
                std::cout &lt;&lt; &quot;From: &quot; &lt;&lt; user.GetString() &lt;&lt; std::endl
                          &lt;&lt; &quot;  &quot; &lt;&lt; text.GetString() &lt;&lt; std::endl
                          &lt;&lt; std::endl;
            }
        }
    }
    catch (std::exception &amp;e) {
        std::cerr &lt;&lt; e.what() &lt;&lt; std::endl;
    }

    return 0;
}</code></pre>
<p>Note</p>
<p>To parse the results of these queries, this example uses <a href="https://github.com/miloyip/rapidjson" class="reference external">rapidjson</a>, a header-only library that is released under the <a href="http://www.opensource.org/licenses/mit-license.php" class="reference external">MIT License</a>.</p>
<h2 id="building-and-running-twitter_search">Building and running <code>twitter_search</code><a href="#building-and-running-twitter-search" class="headerlink" title="Permalink to this headline">¶</a></h2>
<pre><code>$ cd ~/cpp-netlib-build
$ make twitter_search</code></pre>
<p>Twitter provides a powerful set of operators to modify the behaviour of search queries. Some examples are provided below:</p>
<pre><code>$ ./example/twitter_search &quot;Lady Gaga&quot;</code></pre>
<p>Returns any results that contain the exact phrase “Lady Gaga”.</p>
<pre><code>$ ./example/twitter_search &quot;#olympics&quot;</code></pre>
<p>Returns any results with the #olympics hash tag.</p>
<pre><code>$ ./example/twitter_search &quot;flight :(&quot;</code></pre>
<p>Returns any results that contain “flight” and have a negative attitude.</p>
<p>More examples can be found on <a href="https://dev.twitter.com/docs/using-search" class="reference external">Twitter’s search API</a> page.</p>
<h2 id="diving-into-the-code">Diving into the code<a href="#diving-into-the-code" class="headerlink" title="Permalink to this headline">¶</a></h2>
<pre><code>uri::uri base_uri(&quot;http://search.twitter.com/search.json&quot;);

std::cout &lt;&lt; &quot;Searching Twitter for query: &quot; &lt;&lt; argv[1] &lt;&lt; std::endl;
uri::uri search;
search &lt;&lt; base_uri &lt;&lt; uri::query(&quot;q&quot;, uri::encoded(argv[1]));</code></pre>
<p>The <code>cpp-netlib</code> URI builder uses a stream-like syntax to allow developers to construct more complex URIs. The example above re-uses the same base URI and allows the command line argument to be used as part of the URI query. The builder also supports percent encoding using the <code>encoded</code> directive.</p>
<h3 id="table-of-contents"><a href="../../contents.html">Table Of Contents</a></h3>
<ul>
<li><a href="#" class="reference internal">Twitter search</a>
<ul>
<li><a href="#the-code" class="reference internal">The code</a></li>
<li><a href="#building-and-running-twitter-search" class="reference internal">Building and running <code class="docutils literal">twitter_search</code></a></li>
<li><a href="#diving-into-the-code" class="reference internal">Diving into the code</a></li>
</ul></li>
</ul>
<h4 id="previous-topic">Previous topic</h4>
<p><a href="atom_reader.html" title="previous chapter">Atom feed reader</a></p>
<h4 id="next-topic">Next topic</h4>
<p><a href="../../reference.html" title="next chapter">Reference Manual</a></p>
<h3 id="quick-search">Quick search</h3>
<p>Enter search terms or a module, class or function name.</p>
<h3 id="navigation-1">Navigation</h3>
<ul>
<li><a href="../../reference.html" title="Reference Manual">next</a></li>
<li><a href="atom_reader.html" title="Atom feed reader">previous</a> |</li>
<li><a href="../../contents.html">cpp-netlib v0.11.2</a> »</li>
<li><a href="../../examples.html">Examples</a> »</li>
</ul>
<p>© Copyright 2008-2014, Glyn Matthews, Dean Michael Berris; 2013 Google, Inc.. Last updated on Mar 29, 2016. Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.</p>
</body>
</html>
