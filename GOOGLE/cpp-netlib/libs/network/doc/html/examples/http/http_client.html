<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>http_client</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h3 id="navigation">Navigation</h3>
<ul>
<li><a href="simple_wget.html" title="Simple wget">next</a></li>
<li><a href="../../examples.html" title="Examples">previous</a> |</li>
<li><a href="../../contents.html">cpp-netlib v0.11.2</a> »</li>
<li><a href="../../examples.html">Examples</a> »</li>
</ul>
<p><span id="id1"></span></p>
<h1 id="http-client">HTTP client<a href="#http-client" class="headerlink" title="Permalink to this headline">¶</a></h1>
<p>The first code example is the simplest thing you can do with the <code>cpp-netlib</code>. The application is a simple HTTP client, which can be found in the subdirectory <code>libs/network/example/http_client.cpp</code>. All this example doing is creating and sending an HTTP request to a server and printing the response body.</p>
<h2 id="the-code">The code<a href="#the-code" class="headerlink" title="Permalink to this headline">¶</a></h2>
<p>Without further ado, the code to do this is as follows:</p>
<pre><code>#include &lt;boost/network/protocol/http/client.hpp&gt;
#include &lt;iostream&gt;

int main(int argc, char *argv[]) {
    using namespace boost::network;

    if (argc != 2) {
        std::cout &lt;&lt; &quot;Usage: &quot; &lt;&lt; argv[0] &lt;&lt; &quot; [url]&quot; &lt;&lt; std::endl;
        return 1;
    }

    http::client client;
    http::client::request request(argv[1]);
    request &lt;&lt; header(&quot;Connection&quot;, &quot;close&quot;);
    http::client::response response = client.get(request);
    std::cout &lt;&lt; body(response) &lt;&lt; std::endl;

    return 0;
}</code></pre>
<h2 id="running-the-example">Running the example<a href="#running-the-example" class="headerlink" title="Permalink to this headline">¶</a></h2>
<p>You can then run this to get the <a href="http://www.boost.org/" class="reference external">Boost</a> website:</p>
<pre><code>$ cd ~/cpp-netlib-build
$ make http_client
$ ./example/http_client http://www.boost.org/</code></pre>
<p>Note</p>
<p>The instructions for all these examples assume that <code>cpp-netlib</code> is build outside the source tree, according to <a href="http://www.cmake.org/Wiki/CMake_FAQ#What_is_an_.22out-of-source.22_build.3F" class="reference external">CMake conventions</a>. For the sake of consistency we assume that this is in the <code>~/cpp-netlib-build</code> directory.</p>
<h2 id="diving-into-the-code">Diving into the code<a href="#diving-into-the-code" class="headerlink" title="Permalink to this headline">¶</a></h2>
<p>Since this is the first example, each line will be presented and explained in detail.</p>
<pre><code>#include &lt;boost/network/protocol/http/client.hpp&gt;</code></pre>
<p>All the code needed for the HTTP client resides in this header.</p>
<pre><code>http::client client;</code></pre>
<p>First we create a <code>client</code> object. The <code>client</code> abstracts all the connection and protocol logic. The default HTTP client is version 1.1, as specified in <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html" class="reference external">RFC 2616</a>.</p>
<pre><code>http::client::request request(argv[1]);</code></pre>
<p>Next, we create a <code>request</code> object, with a URI string passed as a constructor argument.</p>
<pre><code>request &lt;&lt; header(&quot;Connection&quot;, &quot;close&quot;);</code></pre>
<p><code>cpp-netlib</code> makes use of stream syntax and <em>directives</em> to allow developers to build complex message structures with greater flexibility and clarity. Here, we add the HTTP header “Connection: close” to the request in order to signal that the connection will be closed after the request has completed.</p>
<pre><code>http::client::response response = client.get(request);</code></pre>
<p>Once we’ve built the request, we then make an HTTP GET request throught the <code>http::client</code> from which an <code>http::response</code> is returned. <code>http::client</code> supports all common HTTP methods: GET, POST, HEAD, DELETE.</p>
<pre><code>std::cout &lt;&lt; body(response) &lt;&lt; std::endl;</code></pre>
<p>Finally, though we don’t do any error checking, the response body is printed to the console using the <code>body</code> directive.</p>
<p>That’s all there is to the HTTP client. In fact, it’s possible to compress this to a single line:</p>
<pre><code>std::cout &lt;&lt; body(http::client().get(http::request(&quot;http://www.boost.org/&quot;)));</code></pre>
<p>The next example will introduce the <code>uri</code> class.</p>
<h3 id="table-of-contents"><a href="../../contents.html">Table Of Contents</a></h3>
<ul>
<li><a href="#" class="reference internal">HTTP client</a>
<ul>
<li><a href="#the-code" class="reference internal">The code</a></li>
<li><a href="#running-the-example" class="reference internal">Running the example</a></li>
<li><a href="#diving-into-the-code" class="reference internal">Diving into the code</a></li>
</ul></li>
</ul>
<h4 id="previous-topic">Previous topic</h4>
<p><a href="../../examples.html" title="previous chapter">Examples</a></p>
<h4 id="next-topic">Next topic</h4>
<p><a href="simple_wget.html" title="next chapter">Simple wget</a></p>
<h3 id="quick-search">Quick search</h3>
<p>Enter search terms or a module, class or function name.</p>
<h3 id="navigation-1">Navigation</h3>
<ul>
<li><a href="simple_wget.html" title="Simple wget">next</a></li>
<li><a href="../../examples.html" title="Examples">previous</a> |</li>
<li><a href="../../contents.html">cpp-netlib v0.11.2</a> »</li>
<li><a href="../../examples.html">Examples</a> »</li>
</ul>
<p>© Copyright 2008-2014, Glyn Matthews, Dean Michael Berris; 2013 Google, Inc.. Last updated on Mar 29, 2016. Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.6.</p>
</body>
</html>
