<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>index</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="codemirror-diff-mode">CodeMirror: Diff mode</h1>
<p>diff –git a/index.html b/index.html index c1d9156..7764744 100644 — a/index.html +++ b/index.html @@ -95,7 +95,8 @@ StringStream.prototype = {</p>
<p>diff –git a/lib/codemirror.js b/lib/codemirror.js index 04646a9..9a39cc7 100644 — a/lib/codemirror.js +++ b/lib/codemirror.js @@ -399,10 +399,16 @@ var CodeMirror = (function() { } function onMouseDown(e) { - var start = posFromMouse(e), last = start; + var start = posFromMouse(e), last = start, target = e.target(); if (!start) return; setCursor(start.line, start.ch, false); if (e.button() != 1) return; + if (target.parentNode == gutter) { + if (options.onGutterClick) + options.onGutterClick(indexOf(gutter.childNodes, target) + showingFrom); + return; + } + if (!focused) onFocus(); e.stop(); @@ -808,7 +814,7 @@ var CodeMirror = (function() { for (var i = showingFrom; i &lt; showingTo; ++i) { var marker = lines[i].gutterMarker; if (marker) html.push(’</p>
<p>’ + htmlEscape(marker.text) + ’</p>
<p>’); - else html.push("</p>
<p>" + (options.lineNumbers ? i + 1 : “\u00a0”) + "</p>
<p>“); + else html.push(”</p>
<p>" + (options.lineNumbers ? i + options.firstLineNumber : “\u00a0”) + "</p>
<p>“); } gutter.style.display =”none“; // TODO test whether this actually helps gutter.innerHTML = html.join(”“); @@ -1371,10 +1377,8 @@ var CodeMirror = (function() { if (option ==”parser“) setParser(value); else if (option ===”lineNumbers“) setLineNumbers(value); else if (option ===”gutter“) setGutter(value); - else if (option ===”readOnly“) options.readOnly = value; - else if (option ===”indentUnit“) {options.indentUnit = indentUnit = value; setParser(options.parser);} - else if (/^(?:enterMode|tabMode|indentWithTabs|readOnly|autoMatchBrackets|undoDepth)$/.test(option)) options[option] = value; - else throw new Error(”Can’t set option " + option); + else if (option === “indentUnit”) {options.indentUnit = value; setParser(options.parser);} + else options[option] = value; }, cursorCoords: cursorCoords, undo: operation(undo), @@ -1402,7 +1406,8 @@ var CodeMirror = (function() { replaceRange: operation(replaceRange), operation: function(f){return operation(f)();}, - refresh: function(){updateDisplay([{from: 0, to: lines.length}]);} + refresh: function(){updateDisplay([{from: 0, to: lines.length}]);}, + getInputField: function(){return input;} }; return instance; } @@ -1420,6 +1425,7 @@ var CodeMirror = (function() { readOnly: false, onChange: null, onCursorActivity: null, + onGutterClick: null, autoMatchBrackets: false, workTime: 200, workDelay: 300,</p>
<p><strong>MIME types defined:</strong> <code>text/x-diff</code>.</p>
</body>
</html>
