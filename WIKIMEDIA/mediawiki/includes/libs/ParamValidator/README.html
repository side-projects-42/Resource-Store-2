<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="wikimedia-api-parameter-validator">Wikimedia API Parameter Validator</h1>
<p>This library implements a system for processing and validating parameters to an API from data like that in PHPâ€™s <code>$_GET</code>, <code>$_POST</code>, and <code>$_FILES</code> arrays, based on a declarative definition of available parameters.</p>
<h2 id="usage">Usage</h2>
<pre lang="php">
use Wikimedia\ParamValidator\ParamValidator;
use Wikimedia\ParamValidator\TypeDef\IntegerDef;
use Wikimedia\ParamValidator\SimpleCallbacks as ParamValidatorCallbacks;
use Wikimedia\ParamValidator\ValidationException;

// We assume these are available from your environment in some manner.
/** @var Wikimedia\ObjectFactory $objectFactory */
$objectFactory = ...;
/** @var Wikimedia\Message\MessageFormatterFactory $messageFormatterFactory */
$messageFormatterFactory = ...;

$validator = new ParamValidator(
    new ParamValidatorCallbacks( $_POST + $_GET, $_FILES ),
    $objectFactory
);

try {
    $intValue = $validator->getValue( 'intParam', [
            ParamValidator::PARAM_TYPE => 'integer',
            ParamValidator::PARAM_DEFAULT => 0,
            IntegerDef::PARAM_MIN => 0,
            IntegerDef::PARAM_MAX => 5,
    ] );
} catch ( ValidationException $ex ) {
    $error = $messageFormatterFactory->getTextFormatter( 'en' )->format( $ex->getFailureMessage() );
    echo "Validation error: $error\n";
}
</pre>
<h2 id="failure-reporting">Failure reporting</h2>
<p>This library uses Wikimediaobjects to report errors in both human-readable and machine-readable formats. Basic i18n for all errors generated by the library is included.</p>
<p>For possible failure codes and their parameters, see the documentation of the relevant <code>PARAM_*</code> constants and TypeDef classes.</p>
<h2 id="running-tests">Running tests</h2>
<pre><code>composer install --prefer-dist
composer test</code></pre>
</body>
</html>
