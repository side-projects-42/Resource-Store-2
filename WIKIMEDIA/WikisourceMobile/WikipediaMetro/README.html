<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>README</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="wikipedia-app-for-windows-8-windows-rt">Wikipedia app for Windows 8 / Windows RT</h1>
<h2 id="getting-started">Getting started</h2>
<h3 id="windows-8">Windows 8</h3>
<p>You’ll need a computer or a virtual machine running Windows 8 (x86 or x64). The current code compiles against the final release of Windows 8, which is currently available for MSDN and TechNet subscribers or through a preview download for anyone (90 day activation limit).</p>
<p>Once Windows 8 is set up, you’ll need to install Visual Studio Express 2012.</p>
<p>Downloads for all the above are available via:</p>
<p>http://msdn.microsoft.com/en-US/windows/apps/br229516.aspx</p>
<p>Note that Windows 8 runs very nicely under Parallels 8. Under VirtualBox, avoid installing the 3d guest driver as it seems to have problems.</p>
<p>If you have a MacBook Pro with Retina display, Parallels 8 supports native “retina” resolution, which will let you test 180% scale mode natively.</p>
<h3 id="visual-studio">Visual Studio</h3>
<p>Once you have Visual Studio installed, launch it. It will prompt you to register for a Windows developer license, which sounds slightly Orwellian.</p>
<p>But it’s much less scary than dealing with Apple’s iOS developer certificates, so don’t worry!</p>
<p>You’ll need a Windows Live account, which you can register for pretty easily if you don’t already have one. Once registered, you can install and run Metro- style applications on the computer or VM at will.</p>
<h3 id="git">Git</h3>
<p>If you’re comfortable with traditional msysgit on Windows you can install and use that. Downloading it is left as an exercise for the reader.</p>
<p>However you may wish to use GitHub For Windows, which provides a nice GUI, and automatic setup of an ssh key:</p>
<p>http://windows.github.com/</p>
<p>Check out the code either through the command line or GUI interface:</p>
<p>git@github.com:wikimedia/WikipediaMobile.git or https://github.com/wikimedia/WikipediaMobile.git</p>
<h3 id="project-file-layout">Project file layout</h3>
<p>WikipediaMobile/ WikipediaMetro/ WikipediaMetroTest.sln - the solution (über-project) WikipediaMetroTest/ WikipediaMetroTest.jsproj - the actual app project default.html - main HTML5 document about.html - secondary HTML5 document for about screen css/ default.css js/ default.js &lt;- mishmash that needs some refactoring wikiview.js &lt;- helper class for semantic zoom jquery-X.X.X.js images/ …</p>
<p>Additionally, the project includes by reference a number of JavaScript and message properties files from the parent WikipediaMobile project – these live under WikipediaMobile/assets/www/ but can be seen under js/ and messages/ within the project in Visual Studio.</p>
<h3 id="opening-the-project">Opening the project</h3>
<p>Open an Explorer window to your checkout, and navigate to the ‘WikipediaMetro’ subdirectory. Double-click on “WikipediaMetroTest.sln” (if file extensions are hidden as per default, it’s the one that’s not a subdirectory).</p>
<p>This should open the “solution” (collection of one or more projects) and the actual application project in Visual Studio Express 2012.</p>
<h3 id="running-the-app">Running the app</h3>
<p>On Visual Studio’s toolbar there’ll be a green triangle “Play”-style button, with “Local Machine” next to it. Click this to build and run the application on your machine at your regular screen size.</p>
<p>You can alt-tab back to Visual Studio at any time to use the HTML/JavaScript debugger, which should be fairly familiar, including an HTML inspector, JavaScript breakpoints, debug console, etc.</p>
<p>To halt execution, press the stop button on the toolbar.</p>
<h4 id="running-the-app-in-the-simulator">Running the app in the simulator</h4>
<p>To test the app at particular screen resolutions, or to run the app side-by-side with Visual Studio to avoid having to tab back and forth during debugging, you can run the app in a “simulator” mode which runs a secondary desktop session in a window.</p>
<p>To enable this, click the disclosure triangle next to “Local Machine” and select “Simulator” instead.</p>
<p>When you launch the application again, the simulator will launch, and the app will open within it. There are buttons along the right side to control various aspects of the simulator, including setting its screen resolution.</p>
<h2 id="application-manifest">Application manifest</h2>
<p>Like Android applications, Metro-style Windows applications include an XML manifest file: package.appxmanifest.</p>
<p>This includes the package name and version, settings for the start screen tile name and icons, splash screen, what permissions the app requires, and what contracts/capabilities it supports (for instance, can it be searched? can other applications share data to it?)</p>
<p>You don’t have to edit the XML manually as there’s a nice GUI form within Visual Studio. Yay!</p>
<p>When updating the app, be sure to increment the version number.</p>
<h2 id="building-an-installable-.appx-package">Building an installable .appx package</h2>
<p>From Visual Studio’s “Store” menu, select “Create app packages…”</p>
<p>If building for store release, select “Yes” on the screen asking if you want a store package – you will have to sign in with the proper store credentials.</p>
<p>To build for local installation only, select no. You won’t need new credentials.</p>
<p>By default, packages will output into the AppPackages subdirectory of the project.</p>
<p>The build will produce an “.appxupload” archive file – what you will select when uploading packages to the Windows Store – and a subdirectory with its contents, which you can sideload onto any Windows 8 PC with a developer license by running the included PowerShell script.</p>
<p>The application package itself is the .appx file in the subdirectory.</p>
<h2 id="uploading-package-to-the-windows-store">Uploading package to the Windows Store</h2>
<p>Build as above, selecting “yes” for the store. You will be prompted to authenticate; get the credentials from Brion or Tomasz.</p>
<p>Select the app “Wikipedia”, with package name “WikimediaFoundation.Wikipedia”, and hit “Next”.</p>
<p>Ensure that you’ve upped the version number if necessary and hit “Create”.</p>
<p>After the build completes, you’ll be prompted to optionally run some automated acceptance tests on the package – this will take a few minutes. The same tests will be run when you upload the package, but failing now will save you time!</p>
<p>Go to https://appdev.microsoft.com/StorePortals in your browser. You’ll have to log in with the appropriate credentials again – this may involve logging out of your own Windows Live account first.</p>
<p>Select the “Details” button for the Wikipedia application.</p>
<p>Select the “Create new release” button.</p>
<p>You can change various elements of the package, of which most likely are:</p>
<ul>
<li>Packages – where you’ll upload the .appxupload file</li>
<li>Description – update at least the “Description of update” section.</li>
<li>Notes to testers – point out anything special that should be checked</li>
</ul>
<p>Once you’re done, click on “Submit for certification” and… the waiting game begins.</p>
<p>Some automated tests will run, then there will be manual human review of the app which may take a couple days.</p>
<p>You’ll have to check back to see the status; if the release is rejected you may or may not get as many details as you like…</p>
<p>With initial prerelease versions in summer 2012 we had a lot of problems with “section 4.1” (privacy policy), which hopefully are all resolved at this point.</p>
<h3 id="common-technical-problems">Common technical problems</h3>
<p>The store automatic verification wants JavaScript files to start with a UTF-8 BOM character. We’re not in the habit of using these because the PHP interpreter outputs them into HTML output, but on JavaScript and raw HTML files it causes no harm and makes Microsoft happy.</p>
<h3 id="escalating-issues-with-windows-store">Escalating issues with Windows Store</h3>
<p>If you get a rejection that you don’t understand, look up more info or escalate at http://msdn.microsoft.com/en-us/windows/apps/hh690938</p>
<h2 id="windows-8-metro-ui-information">Windows 8 Metro UI information</h2>
<p>The Windows Metro or “Modern UI” as it is now being called is a sort of hybrid UI designed for touch tablets, but also to work reasonably well with keyboard and mouse /touchpad devices.</p>
<h3 id="charms-bar">Charms bar</h3>
<p>To access search, share, or settings features, open the system’s “charms bar” and select the appropriate icon.</p>
<ul>
<li>On touch devices, swipe in from the right side of the screen</li>
<li>With a mouse, hit hotcorners in the upper-right or lower-right</li>
<li>With keyboard, hit Win+C</li>
</ul>
<p>Note that the “Devices” charm is currently not used by the Wikipedia app, but will be what you hit when printing support is added.</p>
<h3 id="hub-view">Hub view</h3>
<p>The application is oriented around a “hub screen”, on which we show information from the “Featured Feeds” in a WinJS grid control to give a native Metro feel to the site home page.</p>
<p>Note that Metro prefers horizontal layouts and scrolling over vertical scrolling, and we do our best to fit with that in the app.</p>
<p>Tapping or clicking on one of the various featured items will open an article. You can also perform an article search through the search charm; typeahead search for titles is provided, and if there’s no exact match you’ll see a grid of search results when hitting enter / selecting the search term.</p>
<p>Additionally, typing will open up the search charm just like on the Windows 8 Start Screen for searching applications.</p>
<h3 id="detail-views">Detail views</h3>
<p>Article and search result views show a back button; this uses a stock icon. Clicking it will go back one step; right-clicking or tap-and-hold will open a context menu with the entire history stack back to the hub page.</p>
<p>Article views appear in columns with horizontal scrolling, which is Metro’s preferred style. Each column is of similar width to a mobile phone screen.</p>
<h3 id="app-bar">App bar</h3>
<p>Additional features are available on the “app bar”.</p>
<ul>
<li>On touch devices, swipe in from the top or bottom of the screen</li>
<li>With a mouse, right-click in any convenient spot on the window</li>
<li>With keyboard, hit Win+Z</li>
</ul>
<p>Features available here are:</p>
<ul>
<li>“Read in…” -&gt; change language</li>
<li>“Pin to start” -&gt; bookmark the article as a secondary tile on the Start Screen</li>
<li>“Open in browser”</li>
<li>“Find in page”</li>
</ul>
<h3 id="semantic-zoom">Semantic Zoom</h3>
<p>Article view is currently continuous and horizontal, with each section starting on a column boundary.</p>
<p>To see a list of sections, you can use the “semantic zoom” pattern to zoom out from the detail view to a grid list of sections and subsections.</p>
<ul>
<li>On touch devices, pinch and spread fingers out (zoom out)</li>
<li>With a mouse, click the “-” box near the scroll bar. There may be another shortcut.</li>
<li>With keyboard… not sure.</li>
</ul>
<p>I’m a bit unsatisfied with this layout and may replace it in the future with a section sidebar that’s more easily discoverable and avoids having to load all sections at once.</p>
<h2 id="technical-information">Technical information</h2>
<p>You’ll find lots of documentation on MSDN, though it can be hard to sort through.</p>
<p>Start at http://msdn.microsoft.com/en-us/library/windows/apps/hh465037.aspx</p>
<h3 id="frameworks">Frameworks</h3>
<p>The app makes use of two main JavaScript frameworks: jQuery, and WinJS. jQuery is of course… jQuery. Y’all know that!</p>
<p>WinJS is a JavaScript widget and utility library that ships with Windows and provides various common Metro-style controls and access patterns.</p>
<p>Documentation for WinJS and the common WinRT APIs exposed to JavaScript apps is available at http://msdn.microsoft.com/en-us/library/windows/apps/br211377.aspx</p>
<h3 id="screen-resolutions-and-density-scale">Screen resolutions and density scale</h3>
<p>See: http://msdn.microsoft.com/en-us/library/windows/apps/hh465362.aspx</p>
<p>Windows 8/Windows RT Metro apps support three display scales:</p>
<ul>
<li>100% - tablet at 1366x768, traditional displays</li>
<li>140% - tablet at 1920x1080</li>
<li>180% - tablet at 2560x1440, MacBook Pro Retina display</li>
</ul>
<p>Note that the different tablet resolutions are <em>slightly different</em> numbers of CSS pixels wide and tall, so layout is not guaranteed to be exactly the same the way it is on the Retina and non-Retina iPad.</p>
<p>The scaling factors may seem odd, but are chosen to let layouts in multiples of 5 pixels scale up evenly. Metro loves 5 and 20-pixel units!</p>
<p>Key resolutions to test include the above tablet resolutions as well as 1024x768, which is the minimum screen size for Metro-style apps.</p>
<p>Larger screens at 100% scaling are also supported, and should be tested although the app is primarily targeted at tablets.</p>
<h4 id="assets-for-multiple-screen-densities">Assets for multiple screen densities</h4>
<p>For images displayed within the application you can use SVG files, which scale naturally.</p>
<p>The application tile icons and splash screen, however, must be provided as JPEG or PNG files, which can only hold one scale per file.</p>
<p>Asset files for multiple scales can be provided by appending “.scale-XXX” to the base of the filename, before the extension. For instance:</p>
<p>splashscreen.scale-100.png splashscreen.scale-140.png splashscreen.scale-180.png</p>
<p>Referring to just “splashscreen.png” from the application manifest or within an img tag or CSS background will automatically load the appropriate version for the display scale being used.</p>
<h3 id="contracts">Contracts</h3>
<p>See: http://msdn.microsoft.com/en-us/library/windows/apps/hh465037.aspx#implement_contracts</p>
<p>Metro “contracts” are similar to Android’s “intents” system, in that applications can register to accept various sorts of activation methods for search, data sharing, printing, providing places to open or save files, etc.</p>
<p>These are mostly activated through the “charms” that appear when swiping from the right side of the screen (or hitting upper-left or lower-left hotcorners with the mouse).</p>
<p>The Wikipedia app currently supports the search and settings contracts, and can send article URLs to other applications supporting the sharing contract.</p>
</body>
</html>
