<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>multi-series-pie</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<h1 id="multi-series-pie">Multi Series Pie</h1>
<p>```js chart-editor // <block:setup:1> const DATA_COUNT = 5; const NUMBER_CFG = { count: DATA_COUNT, min: 0, max: 100 };</p>
<p>const labels = Utils.months({ count: 7 }); const data = { labels: [ “Overall Yay”, “Overall Nay”, “Group A Yay”, “Group A Nay”, “Group B Yay”, “Group B Nay”, “Group C Yay”, “Group C Nay”, ], datasets: [ { backgroundColor: [“#AAA”, “#777”], data: [21, 79], }, { backgroundColor: [“hsl(0, 100%, 60%)”, “hsl(0, 100%, 35%)”], data: [33, 67], }, { backgroundColor: [“hsl(100, 100%, 60%)”, “hsl(100, 100%, 35%)”], data: [20, 80], }, { backgroundColor: [“hsl(180, 100%, 60%)”, “hsl(180, 100%, 35%)”], data: [10, 90], }, ], }; // </block:setup></p>
<p>// <block:config:0> const config = { type: “pie”, data: data, options: { responsive: true, plugins: { legend: { labels: { generateLabels: function (chart) { // Get the default label list const original = Chart.overrides.pie.plugins.legend.labels.generateLabels; const labelsOriginal = original.call(this, chart);</p>
<pre><code>        // Build an array of colors used in the datasets of the chart
        var datasetColors = chart.data.datasets.map(function (e) {
          return e.backgroundColor;
        });
        datasetColors = datasetColors.flat();

        // Modify the color and hide state of each label
        labelsOriginal.forEach((label) =&gt; {
          // There are twice as many labels as there are datasets. This converts the label index into the corresponding dataset index
          label.datasetIndex = (label.index - (label.index % 2)) / 2;

          // The hidden state must match the dataset&#39;s hidden state
          label.hidden = !chart.isDatasetVisible(label.datasetIndex);

          // Change the color to match the dataset
          label.fillStyle = datasetColors[label.index];
        });

        return labelsOriginal;
      },
    },
    onClick: function (mouseEvent, legendItem, legend) {
      // toggle the visibility of the dataset from what it currently is
      legend.chart.getDatasetMeta(legendItem.datasetIndex).hidden =
        legend.chart.isDatasetVisible(legendItem.datasetIndex);
      legend.chart.update();
    },
  },
  tooltip: {
    callbacks: {
      label: function (context) {
        const labelIndex = context.datasetIndex * 2 + context.dataIndex;
        return (
          context.chart.data.labels[labelIndex] +
          &quot;: &quot; +
          context.formattedValue
        );
      },
    },
  },
},</code></pre>
<p>}, }; // </block:config></p>
<p>module.exports = { config: config, }; ```</p>
</body>
</html>
